"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="c1371615-1e86-599b-a2bb-9dfba2ef1499")}catch(e){}}();
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[1085],{219402:(e,t,n)=>{let a;n.r(t),n.d(t,{DesignView:()=>i2});var o=n(411855),l=n(188507),r=n(224231),i=n(805014),s=n(841962),c=n(499875),d=n(76265),m=n(553362),u=n(51454),p=n(181611),_=n(245954),E=n(277154),g=n(512729),y=n(875877),f=n(773991),v=n(916348),h=n(278695),N=n(343414),b=n(596608),T=n(761263),A=n(737976),I=n(619107),S=n(695024),C=n(135891),O=n(946062),P=n(303596),w=n(43262),x=n(759240),k=n(250450),D=n(157544);let M=(0,s.ck)("bfb358109ac5994e69048d8390d3a0c334253aa8");function R({changedNodeId:e,nodeHeight:t,complete:n}){return(0,g.h)(()=>{i.Egt?.replaceSelection([e],!0)}),o.createElement(P.NJ,{className:D.R3,targetKey:e,dismissModal:n,arrowPosition:O.F_.LEFT_TITLE,width:240,backgroundColor:"var(--color-bg)",topOffset:t?-t/2-15:0,leftOffset:12,closeButtonClassName:D.b,hideIfTargetLost:!0,noAnimation:!0,isCanvasNode:!0,shouldNotWrapInParagraphTag:!0,hideIfArrowPositionDoesNotMatch:!0},o.createElement("div",{className:D.Rg},(0,d.t)("dev_handoff.rfd_signals_upsell.title")),o.createElement("div",{className:D.O6},o.createElement("div",{className:D.j},o.createElement(w.GV,{src:M,width:240})),o.createElement("div",{className:D.zu},(0,d.t)("dev_handoff.rfd_signals_upsell.description"))),o.createElement("div",{className:D.JP},o.createElement(p.v,{mode:"dev-handoff"},o.createElement(f.$z,{trackingProperties:{trackingDescriptor:h.c.MARK_READY_FOR_DEV},variant:"primary",onClick:function(){e&&(n(),T.z4.setNodesReady(!0,[e],"dev-node-change-upsell",null))}},(0,d.t)("dev_handoff.rfd_signals_upsell.mark_ready_for_dev")))))}function L(e){E.az.trackDefinedEvent("activation.rfd_signal_upsell.disqualification_reason",{reason:e,upsellSubject:"frame"})}function V(){let[e,t]=o.useState(null),[n,a]=o.useState(null),l=(0,S._X)({subscribeToUpdates_expensive:!0}),r=(0,y.useSetAtom)(k.hj),i=(0,y.useSetAtom)(k.d1),s=(0,y.useAtomValue)(k.Sp),c=(0,y.useSetAtom)(k.Sp),d=o.useRef(null),m=(0,A.Z)("dev-handoff-rfd-signals-frame-upsell"),[u,p]=o.useState(!1),E=o.useCallback(()=>{d.current&&a(d.current.absoluteBounds.height*l.zoomScale)},[l.zoomScale]);o.useEffect(()=>{if(!e)return;let t=`dev-node-change-upsell-${e}`,n=(0,I.EE)(t,[e],e=>{d.current=e.position,E()});return d.current=n.currentNodePosition[e]?.position||null,E(),()=>{(0,I.lB)(t)}},[e,E]);let g=(0,v.cR)(),{show:f,complete:h,uniqueId:T,isShowing:O}=(0,b.e)({overlay:x.kBA,priority:C.N.HIGH_PRIORITY_MODAL,experiment:{check:g,predicate:e=>e,postCheck:()=>!0}});return(o.useEffect(()=>{i({fn:h})},[h,i]),(0,N.E)(T,["frame_node_name_changed_with_rfd_indicator"],e=>{if(!e.properties.nodeId){L("no_node_id");return}let n=(0,_.UN)().get(e.properties.nodeId);if(!n){L("node_not_found");return}if(0===n.childCount){L("no_children");return}if(s){L("already_seen_upsell_this_session");return}t(e.properties.nodeId),r(e.properties.nodeId),a(n.absoluteBoundingBox.h),f({onShow:async()=>{p(!0),await m(await (0,S.QZ)({nodeId:e.properties.nodeId,alwaysPan:!0}),{alwaysNavToSimilarViewport:!0}),p(!1),c(!0)}})}),e&&n&&O&&!u)?o.createElement(R,{changedNodeId:e,nodeHeight:n,complete:h}):null}var U=n(499573),K=n(300381),B=n(826016),F=n(227762),z=n(37135);function $(e){E.az.trackDefinedEvent("activation.share_on_rfd_upsell.disqualification_reason",{reason:e,upsellSubject:"frame"})}let G=(0,s.ck)("bb7ff04eea67d99da7f8ceb51f1b3fe36d19bae0");function W({changedNodeId:e,nodeHeight:t,complete:n,file:a,repo:l}){let r=(0,z.l)({file:a,repo:l});return o.createElement(P.NJ,{className:"share_on_ready_for_dev_overlay--tooltipContainer--eQp9n pointer_modal--walkThroughModal--6eTVS pointer_modal--pointerModal--wrpFz",targetKey:e,dismissModal:n,arrowPosition:O.F_.LEFT_TITLE,width:240,backgroundColor:"var(--color-bg)",topOffset:t?-t/2-15:0,leftOffset:12,closeButtonClassName:"share_on_ready_for_dev_overlay--closeButton--vY8RC",hideIfTargetLost:!0,noAnimation:!0,isCanvasNode:!0,shouldNotWrapInParagraphTag:!0,hideIfArrowPositionDoesNotMatch:!0},o.createElement("div",{className:"share_on_ready_for_dev_overlay--tooltipHeader--kbL2h utilities--bodyMediumStrong--1R5cZ"},(0,d.t)("dev_handoff.share_on_rfd_upsell.title")),o.createElement("div",{className:"share_on_ready_for_dev_overlay--tooltipBody--leTtO utilities--bodyMediumStrong--1R5cZ"},o.createElement("div",{className:"share_on_ready_for_dev_overlay--videoContainer--JIoHd"},o.createElement(w.GV,{src:G,width:240})),o.createElement("div",{className:"share_on_ready_for_dev_overlay--tooltipBodyText--3YX-S"},(0,d.t)("dev_handoff.share_on_rfd_upsell.description"))),o.createElement("div",{className:"share_on_ready_for_dev_overlay--tooltipFooter--o-16t"},o.createElement(p.v,{mode:"dev-handoff"},o.createElement(f.$z,{trackingProperties:{trackingDescriptor:h.c.COPY_DEV_LINK},variant:"primary",onClick:function(){e&&(r({source:B.d.SHARE_ON_READY_FOR_DEV,linkQueryMode:F.iO.DEV_MODE}),n())}},(0,d.t)("dev_handoff.share_on_rfd_upsell.copy_dev_link")))))}function H(){let[e,t]=o.useState(null),[n,a]=o.useState(null),l=(0,S._X)({subscribeToUpdates_expensive:!0}),r=o.useRef(null),i=(0,A.Z)("dev-handoff-share-on-rfd-upsell"),[s,c]=o.useState(!1),d=(0,K.RC)(),m=(0,y.useAtomValue)(k.Sp),u=o.useCallback(()=>{r.current&&a(r.current.absoluteBounds.height*l.zoomScale)},[l.zoomScale]);o.useEffect(()=>{if(!e)return;let t=`dev-share-on-rfd-upsell-${e}`,n=(0,I.EE)(t,[e],e=>{r.current=e.position,u()});return r.current=n.currentNodePosition[e]?.position||null,u(),()=>{(0,I.lB)(t)}},[e,u]);let p=(0,v.HX)(),{show:E,complete:g,uniqueId:f,isShowing:h}=(0,b.e)({overlay:x.b25,priority:C.N.HIGH_PRIORITY_MODAL,experiment:{check:p,predicate:e=>e,postCheck:()=>!0}});return((0,N.E)(f,["marked_ready_for_dev"],e=>{if(m){$("already_seen_upsell_this_session");return}let{nodeIds:n}=e.properties;if(!n||0===n.length){$("no_node_ids");return}if(n.length>1){$("multiple_node_ids");return}let a=n[0];if(!a){$("no_node_id");return}let o=(0,_.UN)().get(a);if(!o){$("node_not_found");return}if("FRAME"!==o.type){$("node_not_a_frame");return}t(a),E({onShow:async()=>{c(!0),await i(await (0,S.QZ)({nodeId:a,alwaysPan:!0}),{alwaysNavToSimilarViewport:!0}),c(!1)}})}),e&&n&&h&&!s&&d?.file)?o.createElement(W,{changedNodeId:e,nodeHeight:n,complete:g,file:d.file,repo:d.repo}):null}var Y=n(895960),X=n(326612),j=n(471923),J=n(266838),q=n(556843),Z=n(796756),Q=n(890882),ee=n(728722),et=n(746643),en=n(265851),ea=n(84062),eo=n(524459),el=n(666249),er=n(936019),ei=n(698679),es=n(243685),ec=n(664462),ed=n(679796),em=n(17607),eu=n(140835),ep=n(253544),e_=n(955597),eE=n(427494),eg=n(176160),ey=n(988523),ef=n(183739),ev=n(289765),eh=n(424867),eN=n(186339),eb=n(604294);let eT=(0,eu.tf)(X.N);function eA(){return(0,ev.Fk)(e=>{let t;let n=e=>{for(let a of e.childrenNodes)(a.isTopLevelFrame()||"CANVAS"===a.type)&&(a.hasReadyStatus?t?t.getStatusInfo().lastUpdateUnixTimestamp<a.getStatusInfo().lastUpdateUnixTimestamp&&(t=a):t=a:("SECTION"===a.type||"CANVAS"===a.type)&&n(a))};return n(e.getRoot()),t?.getStatusInfo()})}function eI(){let e,t;let n=(0,v.o9)(),a=(0,eg.tS)(),l=(0,ea.BI)();if((0,s.kc)().targeted_update_selector_fix){e=(0,ey.wW)(function(){let e=eA();return e?.userId??void 0}()??null);let n=function(){let e=eA();return e?.lastUpdateUnixTimestamp??void 0}();t=!!n&&Q.A.unix(n).isAfter((0,Q.A)().subtract(60,"day"))}else{let n=function(){let e;let t=(0,_.UN)(),n=t=>{if(t)for(let a of t.childrenNodes)(a.isTopLevelFrame()||"CANVAS"===a.type)&&(a.hasReadyStatus?e?e.getStatusInfo().lastUpdateUnixTimestamp<a.getStatusInfo().lastUpdateUnixTimestamp&&(e=a):e=a:("SECTION"===a.type||"CANVAS"===a.type)&&n(a))};return n(t?.getRoot()),e?.getStatusInfo()}();e=(0,ey.wW)(n?.userId??null),t=!!n&&Q.A.unix(n.lastUpdateUnixTimestamp).isAfter((0,Q.A)().subtract(60,"day"))}let r=(0,eN.U)("upsell"),i=ee.Rs(ef.HdA,{key:a??""},{enabled:!!a})?.data?.file?.hasPermission,c=(0,y.useAtomValue)(ep.LZ),m=(0,eE.aV)(),u=(0,el._I)(),p=(0,el.U4)(),E=(0,y.useAtomValue)(e_.NT),g=(0,ec.J)(),f=(0,v.Oc)(),{show:T,complete:A,isShowing:I,uniqueId:S}=(0,b.e)({overlay:x.koo,priority:C.N.OVERRIDING_MODAL},[E]);(0,o.useEffect)(()=>{T({canShow:e=>g&&c&&!u&&"loaded"===l.status&&!l.hasPendingRequest&&t&&p&&!m&&("developer"===e||"software-development"===e||n(e))})},[T,u,p,c,m,E,g,l,t,n]),(0,N.E)(S,"Enter Inspect Mode",()=>{I&&A()});let O=(0,ed.BC)({dismissModal:A,onRequestAccess:()=>{i&&r("handoff")}}),P=o.useCallback(()=>{A(),O.hidden||O.onClick(em.i$.Upsell)},[A,O]),w=o.createElement(eT,{newTab:!0,trusted:!0,trackingProperties:{trackingDescriptor:h.c.READ_THE_GUIDE},href:Y.z},(0,d.tx)("dev_mode.onboarding_callout.read_the_guide")),k=o.createElement(o.Fragment,null,o.createElement("span",{className:eb.XQ},o.createElement(Z.O,null)),o.createElement("span",{className:en.s.textBodyMediumStrong.$},(0,d.tx)("dev_handoff.status.mark_status_sentence_part.ready_for_dev"))),D=f()?o.createElement(ei.vB,null):o.createElement(o.Fragment,null,o.createElement("div",{className:eb.DD},(0,d.tx)("dev_handoff.paywall.blocking_modal.title.dev_onboarding")),o.createElement("ul",null,o.createElement("li",{className:eb.N$},(0,d.tx)("dev_handoff.paywall.blocking_modal.content.copy_code")),o.createElement("li",{className:eb.N$},(0,d.tx)("dev_handoff.paywall.blocking_modal.content.track_design_changes")),o.createElement("li",{className:eb.N$},(0,d.tx)("dev_handoff.paywall.blocking_modal.content.customize_plugins"))),o.createElement("div",{className:eb.jg},i?(0,d.tx)("dev_handoff.paywall.blocking_modal.content.explore_for_free_with_link",{learnMoreLink:w}):(0,d.tx)("dev_handoff.paywall.blocking_modal.content.curious_to_learn_more",{learnMoreLink:w}))),M=(0,er.W)(),R=j.hS({open:!0,onClose:et.lQ,preventUserClose:!0,recordingKey:"dev-mode-paywall-modal"});return o.createElement(eh.M,{testId:"rfd-upsell-upsell",isShowing:I},o.createElement("div",{"data-editor-theme":"dev-handoff"},o.createElement(eo.OM,null),o.createElement(eu.fu,{name:"RFD Upsell Modal",properties:M,enabled:M?.gracePeriod!==void 0},o.createElement(J.bL,{width:392,manager:R},o.createElement(q.Wk,null,o.createElement("div",{className:eb.XV},e.loading?"":(0,d.tx)("dev_handoff.upsell.user_marked_a design",{userName:e.user?.name||e.user?.handle,status:k})),o.createElement("div",{className:en.s.py8.px16.$},o.createElement(es.E,{imgSrc:(0,s.ck)("6d5e9cb0e9ec7fd5dd58425c5527dc8a78143a19"),content:D,modalType:"RFD Upsell Modal",primaryButtonLabel:(0,d.tx)("dev_handoff.paywall.blocking_modal.button.request_access"),primaryButtonType:"request_access",primaryButtonOnClick:O.hidden?void 0:P,secondaryButtonLabel:(0,d.tx)("dev_handoff.paywall.blocking_modal.button.not_now"),secondaryButtonType:"not_now",secondaryButtonOnClick:A})))))))}var eS=n(178035),eC=n(524940),eO=n(541302),eP=n(963993),ew=n(985814),ex=n(798361),ek=n(700311),eD=n(356578),eM=n(797187),eR=n(937166),eL=n(227856),eV=n(137567),eU=n(255598),eK=n(509223),eB=n(668920),eF=n(877693),ez=n(241162),e$=n(343373),eG=n(423900),eW=n(780017),eH=n(886231),eY=n(212507),eX=n(15092),ej=n(303480),eJ=n(178380),eq=n(142420),eZ=n(138225),eQ=n(22562),e0=n(629019),e1=n.n(e0),e2=n(139879),e8=n(826943),e5=n(39890),e4=n(677840),e7=n(749441),e3=n(117736),e6=n(806273),e9=n(662750),te=n(370212),tt=n(846836),tn=n(721719),ta=n(114750),to=n(440027),tl=n(460005);let tr="starting_points_templates_modal--templateOption--qYXkm",ti="starting_points_templates_modal--templateOptionTitle--DmVPR",ts="starting_points_templates_modal--verticalTemplateImage--kAzQz";var tc=(e=>(e.DESKTOP="desktop",e.MOBILE="mobile",e.WEBSITE="website",e))(tc||{});let td={x:0,y:0},tm={website:{x:0,y:1600},mobile:{x:0,y:300},desktop:{x:0,y:300}},tu={website:.1,mobile:.225,desktop:.1},tp=e=>{let t=(0,s.Ay)().starting_points;switch(e){case"basics":return t?.figma_basics_hub_file_id;case"desktop":return t?.desktop_templates_hub_file_id;case"mobile":return t?.mobile_templates_hub_file_id;case"website":return t?.website_templates_hub_file_id}};function t_({onClose:e}){let t=(0,l.wA)(),n=o.useRef(null),[a,r]=o.useState(!1),[c,m]=o.useState(!1),[u,p]=o.useState(!1),[_,f]=o.useState(!1),[v,N]=o.useState(window.innerWidth),b=(0,e6.q)(),T=(0,eg.tS)(),A=(0,l.d4)(e=>e.fileVersion),I=(0,l.d4)(e=>e.mirror.sceneGraph),S=b&&(0,ta.Qf)(I),C=!!S&&0===S.childCount,[O]=(0,e2.IT)((0,e7.tH)({})),{inProductHelpViewType:P}=(0,te.A5)(),w=(0,eM.ut)(i.Ez5?.uiState().inProductHelpSidePanelWidth,0),x="side_panel"===P?w:0,k=!!(0,s.kc)().starting_points_ghost_previews,{insertTemplate:D}=(0,e3.Fz)(),M=(0,to.g)(),R=(0,y.useSetAtom)(tl.Yq),L=(0,y.useSetAtom)(tl.bj),[V,U]=o.useState(!1),K=(0,tt.GQ)(),B=(0,tn.P)();(0,g.h)(()=>{let e=()=>{N(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),o.useEffect(()=>{f(K+50>v/2-257||v-B-x-50<v/2+257),p(K+50>v/2-365||v-B-x-50<v/2+365)},[x,K,B,v]);let F=o.useCallback(()=>{if(!k||"loaded"!==O.status||!O.data)return;let e=[];for(let t of Object.values(tc)){let n=tp(t);if(!n)return;let a=O.data[n];if(!a)return;let o={type:e9.n.HubFile,template:a};e.push(o)}Promise.all(e.map(e=>y.atomStore.get((0,tl.Re)({fileKey:T,fileVersion:A,template:e})))).then(()=>{U(!0)}).catch(e=>{console.error("Failed to load template buffers",e),U(!0)})},[T,A,O,k]);if(o.useEffect(()=>{"loaded"!==O.status||V||F()},[O,V,F]),o.useEffect(()=>{b&&S&&!C&&!c&&e()},[b,S,C,c,e]),!(0,s.kc)().starting_points_modal)return null;let z=async n=>{if("loaded"!==O.status)return;r(!0);let a=tp(n);if(!a)return;let o=O.data[a];o&&(k&&"basics"!==n?await (0,e3.Zg)({insert:()=>L({selectTemplateAfterCommit:!1,moveViewportAfterCommit:!1,priority:"user-visible",editScopeType:i.zkO.USER}),template:{template:o,type:e9.n.HubFile},fileKey:T,dispatch:t,triggeredFrom:"starting-points",userTriggered:!1}):await D({template:{template:o,type:e9.n.HubFile},userTriggered:!1,editScopeType:i.zkO.ONBOARDING,triggeredFrom:"starting-points",templateInsertionDirection:i.hKj.RIGHT}),"basics"===n?(0,e4.YQ)({id:"starting_points_basics_template_inserted"}):(0,e4.YQ)({id:"starting_points_template_inserted"}),e(),r(!1))},$=o.createElement(eu.$z,{onClick:()=>z("basics"),trackingProperties:{trackingDescriptor:h.c.LEARN_THE_BASICS}},(0,d.tx)("starting_points.learn_the_basics")),G=e=>{if((0,E.sx)("Starting Points Template Option Hover",{template:e}),!k)return;let n=tp(e);if(!n||!O.data)return;let a=O.data[n];if(!a)return;let o={type:e9.n.HubFile,template:a},l=tu[e];window.innerWidth>1700&&(l*=1.5),(0,e3.Zg)({insert:()=>M(o,{moveViewportAfterPreview:!0,priority:"user-visible",previewManager:{nodeType:i.Z6A.CANVAS},position:td,viewportOptions:{position:tm[e],scale:l,duration:0}}),template:o,fileKey:T,dispatch:t,triggeredFrom:"starting-points",userTriggered:!1,isPreview:!0})},W=()=>{k&&R()};return o.createElement(eu.fu,{name:"Starting Points Modal"},o.createElement("div",{className:"starting_points_templates_modal--startingPointsTemplatesModalPositioner--R8g3u",style:{marginRight:`${x}px`}},o.createElement(e5.x,{isLoading:a,className:"starting_points_templates_modal--loadingSpinner--UOrjg"},()=>o.createElement("div",{className:e1()({"starting_points_templates_modal--startingPointsTemplatesModal--dUQte":!0,"starting_points_templates_modal--isHidden--jVN1L":_,"starting_points_templates_modal--isCondensedView--3tVz6":u}),onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),ref:n},o.createElement("div",{className:"starting_points_templates_modal--modalInstructions--ZtdTL"},o.createElement("div",{className:"starting_points_templates_modal--modalTitle--HT3eZ"},(0,d.t)("starting_points.what_do_you_want_to_make_today")),o.createElement("div",{className:"starting_points_templates_modal--modalLearnMore--g-GWo"},(0,d.tx)("starting_points.or_learn_the_basics",{learnTheBasicsLink:$}))),o.createElement("div",{className:"starting_points_templates_modal--optionContainer--mYEsG"},o.createElement(eu.$z,{className:tr,onClick:()=>z("website"),onMouseEnter:()=>G("website"),onMouseLeave:W,trackingProperties:{trackingDescriptor:h.c.WEBSITE_TEMPLATES}},o.createElement("div",{className:ti},(0,d.t)("starting_points.website")),o.createElement(e8.oW,{className:ts,src:(0,s.ck)("9b8475fdab7c1ed3cd1c0d16b957d65a80840b74"),alt:"Website template"})),o.createElement(eu.$z,{className:tr,onClick:()=>z("mobile"),onMouseEnter:()=>G("mobile"),onMouseLeave:W,trackingProperties:{trackingDescriptor:h.c.MOBILE_APP_TEMPLATES}},o.createElement("div",{className:ti},(0,d.t)("starting_points.mobile_app")),o.createElement(e8.oW,{className:ts,src:(0,s.ck)("b262e57bed515b9f0da45ae54fa43824d9704c14"),alt:"Mobile app template"})),o.createElement(eu.$z,{className:tr,onClick:()=>z("desktop"),onMouseEnter:()=>G("desktop"),onMouseLeave:W,trackingProperties:{trackingDescriptor:h.c.DESKTOP_APP_TEMPLATES}},o.createElement("div",{className:ti},(0,d.t)("starting_points.desktop_app")),o.createElement(e8.oW,{className:"starting_points_templates_modal--desktopTemplateImage--3kplg",src:(0,s.ck)("cb2f715253dacb4e7d3fb211ff2792fc28a38832"),alt:"Desktop app template"}))),o.createElement("div",{className:"starting_points_templates_modal--modalLearnMoreFooter--pSvfX"},(0,d.tx)("starting_points.or_learn_the_basics",{learnTheBasicsLink:$})),o.createElement("div",{className:"starting_points_templates_modal--closeButton--io-14"},o.createElement(eZ.K,{onClick:e,"aria-label":(0,d.t)("general.close"),htmlAttributes:{"data-testid":"close-button"}},o.createElement(eQ.A,null)))))))}let tE=(0,eW.r1)("dismissed_starting_points_templates_modal");function tg(){let e=(0,l.wA)(),t=!!(0,s.kc)().starting_points_modal,n=(0,v.GM)(),a=(0,eG.QL)(eq.E_.key)===eq.E_.value,r=(0,eE.aV)(),i=(0,l.d4)(e=>e.mirror.appModel.currentPage),c=(0,ev.Fk)((e,t)=>(0,eY.zC)(e,t),i),d=(0,eG.QL)(eJ.pt.KEY)===eJ.pt.VALUE,m=(0,eg.q5)(),u=(0,eX.TA)(),p=m?.creatorId===u,_=(0,y.useAtomValue)(e_.Fy),E=(0,y.useAtomValue)(eH.UQ),g=!(0,ej.f)("not_gen_0"),f=(0,e$.GS)(),h=(0,y.useAtomValue)(tE),N=(0,s.Ay)().starting_points,{show:T,isShowing:A,complete:I}=(0,b.e)({overlay:x.EYw,priority:C.N.OVERRIDING_MODAL+1,experiment:{check:n,predicate:e=>e,postCheck:(e,t)=>!t}},[_,h]);return(o.useEffect(()=>{t&&p&&!d&&!r&&c&&!A&&(a?T():g&&E&&f&&N&&T({canShow:e=>!e}))},[t,p,r,c,A,a,g,E,f,d,N,T]),A)?o.createElement(t_,{onClose:()=>{h.data||e(ez.b({dismissed_starting_points_templates_modal:!0})),I()}}):null}var ty=n(86994),tf=n(225371),tv=n(201545),th=n(287327),tN=n(901842),tb=n(404852),tT=n(979733),tA=n(512870),tI=n(639344),tS=n(424281);let tC=(0,tS.Op)({initial:"ready_to_show",states:[{id:"ready_to_show",transitions:[(0,tS.nr)("curator_content_shown","ui3_onboarding_was_shown_in_current_session",{condition:({event:e})=>e.properties.shown===x.S$7.id})]},{id:"ui3_onboarding_was_shown_in_current_session",terminal:!0}]}),tO=(0,tS.rn)("track_ui3_onboarding_shown",tC);var tP=n(62387);function tw(){let{isShowing:e,complete:t,show:n,uniqueId:a}=(0,b.e)({overlay:x.l_p,priority:C.N.SECONDARY_MODAL}),r=(0,l.wA)(),s=(0,eE.aV)(),c=(0,eg.q5)(),m=(0,eX.iZ)(),u=(0,ty.te)(),p=!!(0,ej.f)(tA.bo),_="ui3_onboarding_was_shown_in_current_session"===(0,tv.zl)(tO).currentState,E="no_figma_basics_onboarding_was_shown_in_current_session"===(0,tv.zl)(tI.j).currentState,g=(0,y.useAtomValue)(tT.Cl),f=(0,th.jO)(),v=c?.canEdit,T=(0,l.d4)(e=>e.leftPanel.activeTab===i.xae.LAYERS);if((0,N.E)(a,["Reset Visual Assets Tooltips",tA.io],()=>{m&&c&&r(ez.b(tP.g))}),(0,o.useEffect)(()=>{!u()||!v||g||p||_||E||!f||s||!T||e||n()},[n,u,v,p,f,s,_,E,e,g,T]),(0,o.useEffect)(()=>{!T&&e&&t()},[T,e,t]),!e)return null;let A=o.createElement("strong",{style:{display:"contents"}},(0,d.tx)("design_systems.assets_panel.assets"));return o.createElement(tN.X,{isShowing:e,title:(0,d.tx)("rcs.visual_assets.elevate_your_designs"),description:(0,d.tx)("rcs.visual_assets.grab_visual_assets",{strongAssets:A}),primaryCta:{label:(0,d.tx)("rcs.presets_baseline.try_it"),type:"button",onClick:()=>{r(tf.FP({tab:i.xae.ASSETS})),t()},ctaTrackingDescriptor:h.c.PRESETS_TRY_IT},trackingContextName:"Visual Assets Intro Tooltip",userFlagOnShow:tA.bo,position:tb.Q.UI3_EDITOR_TOP_LEFT,onClose:t})}var tx=n(415150),tk=n(781976),tD=n(21644),tM=n(761213);let tR=(0,eW.r1)(tM.WX),tL=(0,eW.r1)(tM.b6),tV=!1;function tU(){let e=(0,l.wA)(),t=(0,y.useAtomValue)(ep.wg),n=(0,eE.aV)(),a=(0,y.useAtomValue)(e_.mp),r=(0,el._I)(),i=(0,e$.GS)(),c=(0,y.useAtomValue)(tL),m=(0,y.useAtomValue)(tR),{uniqueId:u,show:p,complete:E,isShowing:g}=(0,b.e)({overlay:x.kc4,priority:C.N.SECONDARY_MODAL},[m,c,a]),f=(0,eN.U)("modal"),v=o.useCallback(()=>{!n&&!tV&&t&&r&&(0!==(_.UN().getCurrentPage()?.childCount||0)&&p({canShow:(e,t,n)=>!e&&!t&&function(e){let t=Date.now();return e.getTime()<=t-12096e5}(n)}),tV=!0)},[p,r,t,n]);function T(){e(ez.b({[tM.WX]:!0})),E()}o.useEffect(()=>{i||v()},[v,i]),(0,N.E)(u,(0,tD.wX)("design"),()=>{v()}),o.useEffect(()=>{"loaded"===m.status&&m.data&&E()},[m,E]),(0,N.E)(u,"Enter Inspect Mode",()=>{g&&T()});let A=(0,e$.GS)()?eq.ON:eq.JN;return o.createElement(tk.rq,{isShowing:g,trackingContextName:tM.WX,onClose:T,targetKey:A,title:(0,d.tx)("dev_handoff.annotations_introduction_overlay.title"),media:o.createElement(tx.y,{src:(0,s.ck)("5b9addc96424c11577a1ec91e1bbadcd786fe343"),alt:(0,d.t)("dev_handoff.annotations_introduction_overlay.image_alt"),aspectRatio:1280/720}),description:(0,d.tx)("dev_handoff.annotations_introduction_overlay.description"),primaryCta:{label:(0,d.tx)("dev_handoff.annotations_introduction_overlay.primary_cta"),type:"button",onClick:function(){f("handoff")},ctaTrackingDescriptor:h.c.SHOW_ME}})}var tK=n(965467);let tB=(0,eW.r1)(tM.b6),tF=(0,eW.r1)(tM.WX),tz=!1,t$=!1;function tG(){let e=(0,l.wA)(),t=(0,eE.aV)(),n=(0,y.useAtomValue)(e_.mp),a=(0,y.useAtomValue)(tK.N),r=(0,eM.J2)(i.Ez5.annotationObserver().annotationInfoByTlf),c=y.useAtomValue(eg.yV)?.creatorId,m=(0,y.useAtomValue)(tB),u=(0,y.useAtomValue)(tF),{uniqueId:p,show:_,complete:E,isShowing:g}=(0,b.e)({overlay:x.kc4,priority:C.N.SECONDARY_MODAL},[m,u,n,a]),f=(0,eN.U)("modal"),v=r.size>0;function T(){e(ez.b({[tM.b6]:!0})),E()}o.useEffect(()=>{t&&(t$=!0),!t&&!tz&&t$&&v&&(_({canShow:(e,t,n,a)=>!e&&!t&&c!==a&&function(e){let t=Date.now();return e.getTime()<=t-12096e5}(n)}),tz=!0)},[v,t,c,_]),o.useEffect(()=>{"loaded"===m.status&&m.data&&E()},[m,E]),(0,N.E)(p,"Enter Inspect Mode",()=>{g&&T()});let A=(0,e$.GS)()?eq.ON:eq.JN;return o.createElement(tk.rq,{isShowing:g,trackingContextName:tM.b6,onClose:T,targetKey:A,title:(0,d.tx)("dev_handoff.annotations_upsell_overlay.title"),media:o.createElement(tx.y,{src:(0,s.ck)("e84a2faeb510847abd7bfb9c15a74ef974bb4c13"),alt:(0,d.t)("dev_handoff.annotations_introduction_overlay.image_alt"),aspectRatio:1280/720}),description:(0,d.tx)("dev_handoff.annotations_upsell_overlay.description"),primaryCta:{label:(0,d.tx)("dev_handoff.annotations_upsell_overlay.primary_cta"),type:"button",onClick:function(){f("handoff")},ctaTrackingDescriptor:h.c.OPEN_DEV_MODE},secondaryCta:{label:(0,d.tx)("dev_handoff.annotations_upsell_overlay.secondary_cta"),type:"button",onClick:E,ctaTrackingDescriptor:h.c.NOT_NOW}})}var tW=n(463844),tH=n(672904),tY=n(612724),tX=n(153767),tj=n(535461),tJ=n(421613),tq=n(920432),tZ=n(515217),tQ=n(451843),t0=n(553920),t1=n(678599),t2=n(351966),t8=n(549673),t5=n(137565),t4=n(773649),t7=n(858779),t3=n(914530);function t6({asset:e,defaultDropPosition:t,onDismiss:n,onInsert:a}){let[l,r]=o.useState(!1);return l?null:o.createElement("div",{className:"asset_shelf_suggestion--container--18Rt5"},o.createElement("div",{className:"asset_shelf_suggestion--suggestionContainer--rY1cW"},o.createElement(t9,{asset:e,defaultDropPosition:t,onInsert:a},o.createElement("div",{className:"asset_shelf_suggestion--suggestion--WCutP"},o.createElement(t3.M,{className:"asset_shelf_suggestion--image--R4c1I",item:e,shouldGenerateLocalThumbnail:!0,draggable:!1})))),o.createElement(t2.E,{className:"asset_shelf_suggestion--closeIcon--1S4i2",onClick:()=>{r(!0),n()}},o.createElement(t8.p,null)))}function t9(e){let{asset:t,defaultDropPosition:n,onInsert:a}=e,{onInsertableResourcePointerDown:l,dragState:r,insertAction:i}=(0,t7.j)({resource:t,isList:!0,sourceForTracking:"SuggestionsShelf",clickToInsert_DEPRECATED:!1,draggingThumbMaxDimensions:void 0,insertionCallback:a}),s=new tY.Mi(.5,.5);return o.createElement(o.Fragment,null,o.createElement(t5.GG,{onPointerDown:e=>{l(e)},onClick:e=>{i({e:new PointerEvent(e.type,{...e,view:window}),isClick:!0,pointerPercentageOffset:s,dropPosition:n})}},e.children),o.createElement(t4.q,{dragState:r,isList:!0}))}let ne="suggestions_shelf--emptyStateText--T0I8P";function nt({setIsOpen:e}){let{suggestions:t,isLoading:n,analyticsData:a,suggestionsNodeGuid:l,debugString:r}=(0,tZ.$i)(),i=(0,_.UN)(),c=l?i.get(l):void 0,m=o.useMemo(()=>{let e=c?c.absoluteBoundingBox.x+c.absoluteBoundingBox.w/2:0,t=c?c.absoluteBoundingBox.y+c.absoluteBoundingBox.h/2:0;return new tY.Mi(e,t)},[c]),u=o.createElement(tH.k,{className:"suggestions_shelf--upChevron--oUF5v suggestions_shelf--downChevron--ZbvaY"}),p=o.useMemo(()=>t.slice(0,5).map((e,t)=>o.createElement(t6,{key:`suggestion:${t}`,asset:e,fileName:"mock",thumbLayout:t0.rp.SMALL,thumbHeight:35,thumbWidth:40,sectionPosition:t,displayType:"list",sourceForTracking:"suggestionsShelf",viewMode:t1.Bk.Grid,defaultDropPosition:m,onDismiss:()=>{(0,tq.gb)(a,tq.GG.RESULT_DISMISSED)},onInsert:()=>{(0,tq.gb)(a,tq.GG.RESULT_INSERTED)}})),[t,m,a]);return o.createElement("div",{className:e1()("suggestions_shelf--shelf--401Ia",{"suggestions_shelf--shelfNoDebug--mFs5X":!(0,s.kc)().anticipation_trigger_debug,"suggestions_shelf--shelfDebug--QvXPF":(0,s.kc)().anticipation_trigger_debug})},n&&o.createElement(tW.k,null),!n&&!l&&o.createElement("div",{className:ne},(0,d.t)("auto_suggest.suggestion_shelf_empty_state")),(0,s.kc)().anticipation_trigger_debug&&!n&&l&&o.createElement("div",null,r),!n&&l&&(t.length>0?o.createElement("div",{className:"suggestions_shelf--suggestions--aZ-e9"},p):o.createElement("div",{className:ne},(0,d.t)("auto_suggest.suggestion_shelf_no_suggestions"))),o.createElement("button",{className:"suggestions_shelf--upChevronContainer---RjEh",onClick:()=>{(0,tq.gb)(a,tq.GG.PANEL_CLOSED),e(!1)}},u))}function nn(){let e=(0,eM.ut)(i.Ez5?.editorPreferences().showAssetAutoSuggest,!0),t=o.useCallback(e=>{i.Ez5?.editorPreferences().showAssetAutoSuggest.set(e)},[]),[n,a]=(0,tJ.d)(),l=o.createElement(tH.k,{className:"suggestions_shelf--downChevron--ZbvaY"}),r=o.createElement("button",{className:"suggestions_shelf--downChevronContainer--9AOKn",onClick:()=>{(0,tq.gb)(tq.YQ,tq.GG.PANEL_OPENED),t(!e)}},l);return o.createElement(tX.dP,null,o.createElement("div",{className:e1()("suggestions_shelf--wrapper--seged",tj.Dm)},o.createElement("div",{className:e?"suggestions_shelf--shelfContainerOpen--qh1UB suggestions_shelf--shelfContainer--EXG5K":"suggestions_shelf--shelfContainerClosed--jUxyH suggestions_shelf--shelfContainer--EXG5K",style:{marginLeft:n,marginRight:a}},!e&&r,e&&o.createElement(nt,{setIsOpen:t}))))}function na(){return!(0,tQ.r8)()||(0,s.kc)().anticipation_asset_panel?null:o.createElement(nn,null)}var no=n(792749),nl=n(48451),nr=n(772402),ni=n(744850),ns=n(889012),nc=n.n(ns),nd=n(395096),nm=n(991458),nu=n(865474),np=n(524696),n_=n(871432),nE=n(832571),ng=n(796155);let ny="16px";function nf(){let e=(0,y.useSetAtom)(ng.uw),t=(0,y.useSetAtom)(ng.aW);return(0,o.useMemo)(()=>nc()(()=>{e(null),t(!1)},100),[e,t])}function nv(){let e=(0,y.useAtomValue)(ng.uw),t=(0,y.useAtomValue)(ng.aW),n=(0,y.useAtomValue)(ng.ej),a=(0,y.useAtomValue)(nE.g4),l=(0,y.useAtomValue)((0,nE.q4)(a??""))??[],[r,i]=(0,y.useAtom)((0,nE.Sy)(a??"")),s=(0,o.useCallback)(e=>{i(e)},[i]),c=nf(),m=e?.current?.getBoundingClientRect()??{bottom:0,left:0},u=(0,o.useMemo)(()=>({top:(m?.bottom??0)-(n?.y??0),left:(m?.left??0)-(n?.x??0)}),[n?.x,n?.y,m?.bottom,m?.left]);return t?o.createElement("div",{className:e1()("design_linter_modal--dropdownShadow--EsOwB",en.s.grid.gridTemplateColumns2.borderBox.absolute.top0.b1.bSolid.colorBorder.colorBg.radiusLarge.$),style:{...u}},o.createElement("div",{className:en.s.flex.justifyBetween.gridColumnStart1.gridColumnEnd3.itemsCenter.bb1.bSolid.colorBorder.mb16.$},o.createElement("h1",{className:en.s.textBodyMediumStrong.colorText.truncate.selectNone.ml16.mb16.mt16.$},(0,d.tx)("design_linter.rules.component_match.dropdown_title")),o.createElement(nh,{onClick:c})),l.map((e,t)=>{let n=en.s.flex.justifyCenter.itemsCenter.colorBgSecondary.selectNone.bRadius5.$,a=en.s.b2.colorBorderSelected.$,l=!r&&0===t||r===t;return o.createElement("div",{key:e.id,className:en.s.textBodyMedium.colorText.truncate.selectNone.ml16.mb16.$},o.createElement(t2.E,{className:e1()("design_linter_modal--thumbnailContainer--7Hd2W",n,l?a:null),onClick:()=>{s(t),c()}},o.createElement(e8.oW,{src:e.thumbnail_url,alt:e.name})),o.createElement("h3",{className:en.s.truncate.mt2.$},e.name))})):null}function nh(e){return o.createElement("div",{className:en.s.gridColumnStart3.mr16.$},o.createElement(eZ.K,{onClick:e.onClick,"aria-label":(0,d.t)("general.close")},o.createElement(n_.L,null)))}var nN=n(906068),nb=n(254760),nT=n(515662);function nA(){let e=(0,y.useAtomValue)(nu.m7);return(0,o.useMemo)(()=>Array.from(e.values()).reduce((e,t)=>e+t.size,0),[e])}var nI=n(520244),nS=n(717180),nC=n(230659);function nO(){let[e,t]=(0,o.useState)(0),[n,a]=(0,o.useState)(!1),l=(0,y.useAtomValue)(nu.Cv),r=(0,y.useAtomValue)(nu.fY),i=(0,y.useAtomValue)(nu.Iy),{status:s}=(0,y.useAtomValue)(nu.v4),c=nA(),d=function(){let e=(0,y.useAtomValue)(nu.m7);return(0,o.useMemo)(()=>{let t={};for(let n of e.values())for(let e of n.values()){let{ruleId:n}=e;t[n]=t[n]||[],t[n].push(e)}return Object.entries(t).map(([e,t])=>({rule:e,count:t.length}))},[e])}(),m=(0,nC.r)(),u=function(){let[e,t]=(0,o.useState)(0),n=(0,y.useAtomValue)(nu.Iy),a=(0,y.useAtomValue)(nu.m7);return(0,o.useEffect)(()=>{let e=new Set;for(let t of n.values())for(let n of t.violatingNodeIdToRootNodeId.keys())e.add(n);let o=new Set;for(let t of a.values())for(let n of t.values())e.has(n.guid)||o.add(n.guid);t(o.size)},[a,n]),e}();return(0,o.useEffect)(()=>{if(!n)return;let e=0;if(r){let t=(0,_.UN)();r.forEach(n=>{let a=t.get(n);a&&(0,nS.hV)(a,()=>{e++})})}t(e)},[r,n]),o.createElement("div",{className:en.s.colorBg.m16.flex.flexColumn.b2.bRadius4.colorBorder.p4.wAuto.$},o.createElement("div",{className:en.s.p4.$},o.createElement(t2.E,{className:en.s.colorBg.$,onClick:()=>a(!n)},o.createElement("span",null,n?"\u25BC":"\u25B6"),o.createElement("span",{className:en.s.ml2.textHeadingMedium.$},"Linter debug view")),n&&o.createElement(o.Fragment,null,o.createElement("div",{className:en.s.grid.gridTemplateColumns2.gap2.pb4.$},o.createElement("div",{className:en.s.textHeadingSmall.mr1.$},"Linter status:"),o.createElement("div",{className:en.s.textBodyMedium.$},l),o.createElement("div",{className:en.s.textHeadingSmall.mr1.$},"Variable context status:"),o.createElement("div",{className:en.s.textBodyMedium.$},s),o.createElement("div",{className:en.s.textHeadingSmall.mr1.$},"Linting target:"),o.createElement("div",{className:en.s.textBodyMedium.$},`${r.join(",")}`),o.createElement("div",{className:en.s.textHeadingSmall.mr1.$},"Linted nodes:"),o.createElement("div",{className:en.s.textBodyMedium.$},e),o.createElement("div",{className:en.s.textHeadingSmall.mr1.$},"Violations:"),o.createElement("div",{className:en.s.textBodyMedium.$},c),o.createElement("div",{className:en.s.textHeadingSmall.mr1.$},"Visual groups:"),o.createElement("div",{className:en.s.textBodyMedium.$},i.size),o.createElement("div",{className:en.s.textHeadingSmall.mr1.$},"Ungrouped violations:"),o.createElement("div",{className:en.s.textBodyMedium.$},u)),o.createElement("div",{className:en.s.textHeadingSmall.pt8.pb4.$},"Violations per rule"),o.createElement("ol",null,d.map(({rule:e,count:t})=>o.createElement("span",{key:e,className:en.s.textBodyMedium.block.$},`${e}: ${t}`))),o.createElement("div",{className:en.s.flex.flexColumn.gap4.pt4.w150.$},o.createElement(nI.$n,{onClick:()=>{m?.debugCopyGroupStateToClipboard()}},"Copy group state"),o.createElement(nI.$n,{onClick:()=>{m?.debugCopyViolationsStateToClipboard()}},"Copy violations state"),o.createElement(nI.$n,{onClick:()=>{m?.debugCopySimilarityGroupsToClipboard()}},"Copy similarity state")))))}var nP=n(44524),nw=n(960579),nx=n(473982);let nk=(0,y.atom)(null,async(e,t)=>{let n=e(ng.O$),a=e(ng.DJ),o=e(ng.MF),l=Object.values(a).flatMap(e=>Object.keys(e)).filter(e=>!n[e]),r=(0,nC.r)();r&&await Promise.allSettled(l.map(async a=>{let l=o[a];if(!l)return{contextKey:a,fix:null};t(ng.O$,{...n,[a]:{fix:null,status:"loading"}});try{let n=await r.requestFix(l);t(ng.O$,{...e(ng.O$),[a]:{fix:n,status:"loaded"}})}catch{t(ng.O$,{...e(ng.O$),[a]:{fix:null,status:"error"}})}}))}),nD=(0,nx.Wh)(()=>(0,y.atom)(e=>{let t=e(ng.O$);return Object.values(e(ng.DJ)).flatMap(e=>Object.keys(e)).every(e=>{let n=t[e];return n?.status==="loaded"&&null!==n.fix})})),nM=(0,y.atom)(null,e=>new Promise(async t=>{let n=(0,nC.r)();if(!n){t();return}let a=e(ng.O$),{allViolationsByContext:o,allContextKeys:l}=e(ng.Jm);for(let e of l){let t=a[e]?.fix;if(!t||!t.valid||!t.fixContext)continue;let l=o[e];l?.length&&await n.applyFixContextToViolations(l,t.fixContext)}t()}));var nR=n(32257),nL=n(493685),nV=n(255191),nU=n(875585),nK=n(255703),nB=n(487205);class nF extends nB.JB{constructor(){super(!1),this.name="AbortError"}}var nz=n(256601);async function n$(e,t,n,a){if(a.aborted)throw new nF;let o=new _.qo(i.juq.LINTER).get(e);if(!o)throw Error("Suggested linter scene node not found");let l=nW(t,o);y.atomStore.set(nu.TM,l),await nC.r()?.applyFixesToThumbnailNode(n,l,a);let[r,s]=nG(e);if(a.aborted)throw new nF;return{width:r.width,height:r.height,image:s}}function nG(e){if(!i.Vzr)throw Error("Thumbnail binding not available");let[t,n]=i.Vzr.generateThumbnailForNode(e,0,0,n1,{inLinterScene:!0,type:"UNCOMPRESSED",scale:n1});return[t,n]}function nW(e,t){let n=new Map,a=[],o=[];return(0,nz.e)(e,e=>{a.push(e.guid)}),(0,nz.e)(t,e=>{o.push(e.guid)}),a.forEach((e,t)=>{n.set(e,o[t]??"-1:-1")}),n}var nH=n(32079),nY=n(696306);let nX=(0,o.createContext)(null);function nj({children:e,value:t}){return o.createElement(nX.Provider,{value:t},e)}function nJ(e){let t=(0,o.useContext)(nX);return t?o.createElement(nq,{...e,...t}):null}let nq=o.memo(function(e){let{bounds:t,transform:n}=e;return o.createElement(o.Fragment,null,t.map((e,t)=>o.createElement("div",{key:t},o.createElement(nZ,{bounds:e,transform:n}))))});function nZ({bounds:e,transform:t}){let n=nQ(t,e),a=n.x-2,l=n.y-2;return o.createElement("div",{className:en.s.absolute.colorBorderSelected.bSolid.$,style:{transform:`translate(${a}px, ${l}px)`,borderWidth:2,width:n.width,height:n.height}})}let nQ=(e,t)=>{let n=e.transformRect(new nH.r(new nY.M(t.x,t.y),new nY.M(t.width,t.height)));return{x:n.left(),y:n.top(),width:n.width(),height:n.height()}},n0=[2,3,6,13,25,50,75,100,200,300,1e3],n1=2;var n2=(e=>(e.CURRENT="current",e.SUGGESTED="suggested",e))(n2||{});let n8=o.memo(function(){let{rootNodeId:e,violatingNodeIdSet:t}=function(){let e=(0,y.useAtomValue)(ng.E$),t=(0,y.useAtomValue)(ng.Bp)??"",n=(0,o.useMemo)(()=>e&&t?e.rootNodeIdToViolatingNodeIdSet.get(t)??new Set:new Set,[t,e]);return{rootNodeId:t,violatingNodeIdSet:n,hasValidGroup:!!e}}(),[n,a]=function(e,t){let[n,a]=(0,o.useState)((0,nL.Ok)()),[l,r]=(0,o.useState)((0,nL.Ok)()),s=(0,o.useRef)(null);return(0,o.useEffect)(()=>{let n=async e=>{let n=new AbortController;s.current=n;try{r((0,nL.ux)());let a=i.mHF?.copyNodeToLinterScene(e);if(!a)throw Error("Suggested linter scene guid not found");let o=(0,_.UN)().get(e);if(!o)throw Error("Original node not found");let l=await n$(a,o,t,n.signal);r(l.image.length>0?(0,nL.NY)(l):(0,nL.uW)())}catch(e){e instanceof nF||(console.error("Error computing suggested image:",e),r((0,nL.uW)()))}};if(e)return(e=>{let t=new AbortController;s.current=t;try{a((0,nL.ux)());let n=i.mHF?.copyNodeToLinterScene(e);if(!n)throw Error("Current linter scene guid not found");let o=(0,_.UN)().get(e);if(!o)throw Error("Original node not found");let l=function(e,t,n){if(n.aborted)throw new nF;let a=new _.qo(i.juq.LINTER).get(e);if(!a)throw Error("Current linter scene node not found");let o=nW(t,a);y.atomStore.set(nu.DN,o);let[l,r]=nG(e);if(n.aborted)throw new nF;return{width:l.width,height:l.height,image:r}}(n,o,t.signal);a(l.image.length>0?(0,nL.NY)(l):(0,nL.uW)())}catch(e){e instanceof nF||(console.error("Error computing current image:",e),a((0,nL.uW)()))}})(e),n(e),()=>{s.current?.abort()}},[e,t]),[n,l]}(e,t);return o.createElement(n5,{nodeId:e,currentImage:n,suggestedImage:a})});function n5({nodeId:e,currentImage:t,suggestedImage:n}){let[a,l]=function(e){let t=(0,y.useAtomValue)(nu.xS);if(!e)return[[],[]];let n=(0,_.UN)(),a=t.filter(t=>t.guid===e||(0,nS.rV)(n,e,t.guid)).map(e=>n.get(e.guid)).filter(e=>null!==e),o=y.atomStore.get(nu.DN),l=y.atomStore.get(nu.TM),r=new _.qo(i.juq.LINTER),s=[];for(let e of a){let t=o.get(e.guid);if(!t)continue;let n=r.get(t);n&&s.push(n)}let c=[];for(let e of a){let t=l.get(e.guid);if(!t)continue;let n=r.get(t);n&&c.push(n)}return[s,c]}(e),[r,s]=function(e,t,n){if(!e)return[null,null];let a=new _.qo(i.juq.LINTER),o=y.atomStore.get(nu.DN),l=y.atomStore.get(nu.TM),r=o?.get(e)??"-1:-1",s=a.get(r);if(!s)return[null,null];let c=n4(s,!0);if(!c)return[null,null];let d=[];for(let e of t){let t=n4(e,!1);if(!t)continue;let n=n7(t,c);d.push(n)}let m={bounds:d},u=l?.get(e)??"-1:-1",p=a.get(u);if(!p)return[m,null];let E=n4(p,!0);if(!E)return[m,null];let g=[];for(let e of n){let t=n4(e,!1);if(!t)continue;let n=n7(t,E);g.push(n)}return[m,{bounds:g}]}(e,a,l);return o.createElement(nR.o,{eventListeners:["onPointerDown"]},o.createElement("div",{className:en.s.bb1.bSolid.colorBorder.$},o.createElement(nV.qW,{zoomPercentageOptions:n0,zoomOnMousePointer:!1,resetStateOnChangeValue:e,compareThumbnailSource:nK.FO.LINTER},o.createElement(nj,{value:r},o.createElement(n3,{asyncLoadedImage:t,scale:n1,thumbnailType:"current",title:(0,d.t)("design_linter.preview.current"),Overlay:nJ})),o.createElement(nj,{value:s},o.createElement(n3,{asyncLoadedImage:n,scale:n1,thumbnailType:"suggested",title:(0,d.t)("design_linter.preview.suggested"),Overlay:nJ})))))}function n4(e,t){let n=t?e.absoluteRenderBounds:e.absoluteBoundingBox;return n?{x:n.x,y:n.y,width:n.w,height:n.h}:null}function n7(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function n3({asyncLoadedImage:e,scale:t,thumbnailType:n,title:a,Overlay:l}){let r;let{image:i,isLoading:s}=o.useMemo(()=>(0,nL.xj)(e)?{isLoading:!1,image:{data:e.value.image,width:e.value.width,height:e.value.height,scale:t}}:(0,nL.Mx)(e)||(0,nL.yx)(e)?{isLoading:!0,image:null}:{isLoading:!1,image:null},[e,t]);return r=i?o.createElement(nU.ec,{image:i,paddingPixels:30,Overlay:l}):s?o.createElement("div",{className:en.s.flex.hFull.itemsCenter.justifyCenter.$},o.createElement(e5.x,{isLoading:!0},()=>(0,d.tx)("design_linter.preview.thumbnail_unavailable"))):o.createElement("div",{className:en.s.flex.hFull.itemsCenter.justifyCenter.$},(0,d.tx)("design_linter.preview.thumbnail_unavailable")),o.createElement(n6,{title:a,thumbnailType:n},r)}function n6({title:e,thumbnailType:t,children:n}){return o.createElement("div",{className:e1()(en.s.absolute.wHalf.inlineFlex.flexColumn.hFull.overflowHidden.flexGrow1.colorBgSecondary.$,{[en.s.left0.$]:"current"===t,[en.s.right0.bl1.bSolid.colorBorder.$]:"suggested"===t})},o.createElement("div",{className:e1()(en.s.absolute.bottom0.zIndex1.selectNone.py8.leftHalf.$,"design_linter_modal--transformXHalf--lq58c")},o.createElement("span",{className:en.s.textBodySmall.colorTextSecondary.alignCenter.$},e)),n)}var n9=n(62830),ae=n(416506),at=n(563508),an=n(190952),aa=n(510548),ao=n(154977),al=n(766794),ar=n(1518),ai=n(863599),as=n(688656),ac=n(456809),ad=n(172322);let am="design_linter_violation_group_row--chit--s-oKx paint_panels--chit--twQEy",au="design_linter_violation_group_row--currentColorHexBorderRadius--USgKl",ap="design_linter_violation_group_row--chitWidth--aX7PB";function a_(e,t){return(((0,y.useAtomValue)(ng.DJ)??{})[t]??{})[e]??[]}function aE(e){return(0,y.useAtomValue)(ng.O$)[e]??{fix:void 0,status:"loading"}}function ag({contextKey:e,ruleId:t}){let{firstViolation:n,violationsCount:a,selectAllViolationsById:l}=function(e,t){let n=a_(e,t),a=(0,o.useCallback)(()=>{i.Egt?.replaceSelection(n.map(e=>e.guid),!0)},[n]);return(0,o.useMemo)(()=>({firstViolation:(0,n9.rO)(n),violationsCount:n.length,selectAllViolationsById:a}),[a,n])}(e,t),{fix:r,status:s}=aE(e),{applyFixToRow:c,status:m}=function(e){let t=aE(e),n=a_(e,t.fix?.ruleId??""),[a,l]=(0,o.useState)("idle");return{applyFixToRow:(0,o.useCallback)(async()=>{if(!t?.fix?.fixContext||!t.fix.valid||"running"===a)return;let e=(0,nC.r)();if(!e)throw Error("Design linter not available");l("running");try{await e.applyFixContextToViolations(n,t.fix.fixContext),l("applied")}catch{(0,n9.Lt)((0,d.t)("design_linter.penalty_box.fix_failed_bell"),nw.zX.EXCLAMATION,"error"),l("error")}},[t,a,n]),status:a}}(e),u=a_(e,t),[p,_]=(0,o.useState)(!1),E=function(e,t){let[n,a]=(0,y.useAtom)(nu.K9);return()=>{let o=new Map(n),l=o.get(e)??new Set;t.forEach(e=>l.add(e)),o.set(e,l),a(o),nC.r()?.markViolationsAsIgnoredForRule(e,t)}}(t,u.map(e=>e.guid));return n&&"applied"!==m?o.createElement("div",{className:e1()(en.s.flex.mx16.p8.$,{[en.s.colorBgHover.bRadius5.$]:p}),onMouseEnter:()=>{_(!0),y.atomStore.set(nu.xS,u)},onMouseLeave:()=>{_(!1),y.atomStore.set(nu.xS,[])}},o.createElement("div",{className:en.s.flex.itemsCenter.gap8.bRadius4.$},o.createElement("span",{className:e1()("design_linter_violation_group_row--tabularNumbers--RZ5HK",en.s.colorTextSecondary.textBodyMediumStrong.selectNone.w32.$)},`(${a})`),o.createElement(ac.Bf,{guid:n.guid}),o.createElement(aT,{violation:n}),o.createElement("div",{className:en.s.flex.itemsCenter.ml14.$},o.createElement(ae.o,{className:"design_linter_violation_group_row--iconTertiary--smOZe"}),o.createElement(ah,{fix:r,fixStatus:s})),p?o.createElement(o.Fragment,null,o.createElement(av,{selectAllViolationsById:l,violationsCount:a}),o.createElement(af,{ignoreViolationRow:E,violationCount:a}),r?.valid&&o.createElement(ay,{applyFixToRow:c,applyStatus:m,fixStatus:s,violationsCount:a})):null)):null}function ay({applyFixToRow:e,applyStatus:t,fixStatus:n,violationsCount:a}){let[l,r]=(0,o.useState)(!1);return"loaded"!==n?null:o.createElement(eZ.K,{htmlAttributes:{onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),"data-tooltip-type":as.Ib.TEXT,"data-tooltip":(0,d.t)("design_linter.penalty_box.accept_suggestion_tooltip",{count:a})},onClick:e,"aria-label":(0,d.t)("design_linter.penalty_box.accept_suggestion_aria")},"running"===t?o.createElement(tW.k,null):o.createElement(at.r,{style:l?{}:{"--color-icon":"var(--color-icon-secondary)"}}))}function af({ignoreViolationRow:e,violationCount:t}){let[n,a]=(0,o.useState)(!1);return o.createElement(eZ.K,{htmlAttributes:{onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),"data-tooltip-type":as.Ib.TEXT,"data-tooltip":(0,d.t)("design_linter.penalty_box.ignore_suggestion_tooltip",{count:t})},onClick:e,"aria-label":(0,d.t)("design_linter.penalty_box.ignore_suggestion_aria")},o.createElement(eQ.A,{style:n?{}:{"--color-icon":"var(--color-icon-secondary)"}}))}function av({selectAllViolationsById:e,violationsCount:t}){let[n,a]=(0,o.useState)(!1);return o.createElement(eZ.K,{htmlAttributes:{onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),"data-tooltip-type":as.Ib.TEXT,"data-tooltip":(0,d.t)("design_linter.penalty_box.select_layers_tooltip",{count:t})},onClick:e,"aria-label":(0,d.t)("design_linter.penalty_box.select_nodes_aria")},o.createElement(an.A,{style:n?{}:{"--color-icon":"var(--color-icon-secondary)"}}))}function ah({fix:e,fixStatus:t}){if("loading"===t)return o.createElement("div",{className:e1()(ap,en.s.flex.itemsCenter.p2.h24.radiusMedium.colorBorder.selectNone.b1.$)},o.createElement("span",{className:en.s.flex.ml2.mr4.$},o.createElement(tW.k,{size:"sm"})),(0,d.t)("design_linter.penalty_box.loading_fix"));let{ruleId:n,fixContext:a,valid:l}=e??{};return e&&l&&a?n===nP.C.REQUIRE_FILL_COLOR_TOKENS||n===nP.C.REQUIRE_STROKE_COLOR_TOKENS?o.createElement(ab,{context:a}):n===nP.C.COMPONENT_MATCH?o.createElement(aN,{context:a}):null:o.createElement("div",{className:e1()(ap,en.s.flex.itemsCenter.p2.h24.radiusMedium.colorBorder.selectNone.b1.$)},o.createElement(aa.Z,null),o.createElement("div",null,(0,d.t)("design_linter.penalty_box.no_fix_available")))}function aN({context:e}){let t=o.useRef(null),[n,a]=(0,y.useAtom)(ng.uw),[l,r]=(0,y.useAtom)(ng.aW),i=e&&"targetNode"in e?e.targetNode.guid:"",s=(0,y.useAtomValue)((0,nE.Sy)(i))??0,c=(0,y.useSetAtom)(nE.g4),d=(0,y.useSetAtom)((0,nE.q4)(i));if(!e||!("targetNode"in e))return null;d(e.components.map(e=>({id:e.id,name:e.name,thumbnail_url:e.thumbnail_url})));let m=e.components[s];return m?o.createElement("div",{ref:t},o.createElement(t2.E,{className:e1()(ap,l?en.s.flex.itemsCenter.b1.bSolid.colorBorderOnselected.colorBg.radiusMedium.p2.$:en.s.flex.itemsCenter.b1.bSolid.colorBorder.colorBg.radiusMedium.p2.$),onClick:()=>{n?.current===t.current?(c(null),a(null),r(!1)):(c(i),a(t),r(!0))}},o.createElement("div",{className:e1()(ap,en.s.flex.itemsCenter.p2.h24.selectNone.$)},o.createElement(ao.y,null),o.createElement("div",{className:en.s.truncate.$},m.name)),o.createElement(al.r,{className:en.s.pl8.bl1.bSolid.colorBorderBg.colorText.flex.itemsCenter.selectNone.h24.w40.$}))):null}function ab({context:e}){if(!("fixes"in e)||!("selection"in e))return null;let{fixes:t,selection:n}=e;if(!t||0===t.length)return null;let a=t[n??0];if(!a)return null;let{variableId:l,resolvedValue:r}=a,i=y.atomStore.get(nu.nE),s=i[l]?.name,c=r.value;return c&&s?o.createElement("div",{className:e1()(ap,en.s.flex.itemsCenter.b1.bSolid.colorBorder.colorBg.radiusMedium.p2.$)},o.createElement("div",{className:am},o.createElement(ad.J,{color:c,opacity:c.a})),o.createElement("span",{className:en.s.textBodyMedium.colorText.truncate.selectNone.$,"data-tooltip":s,"data-tooltip-type":as.Ib.TEXT},s)):null}function aT({violation:e}){let{ruleId:t,detectionContext:n}=e;return t===nP.C.REQUIRE_FILL_COLOR_TOKENS||t===nP.C.REQUIRE_STROKE_COLOR_TOKENS?o.createElement(aI,{context:n}):t===nP.C.COMPONENT_MATCH?o.createElement(aA,{context:n}):null}function aA({context:e}){return e&&"components"in e?o.createElement("div",{className:e1()(ap,en.s.flex.itemsCenter.b1.bSolid.colorBorder.radiusMedium.$)},o.createElement("div",{className:e1()(ap,au,en.s.flex.itemsCenter.h24.p2.justifyBetween.$)},o.createElement("div",{className:en.s.flex.itemsCenter.$},o.createElement("div",{className:en.s.ml4.textBodyMedium.colorText.selectNone.$},e.name)))):null}function aI({context:e}){if(!e||!("color"in e))return null;let t=e.color,n=e.opacity;return o.createElement("div",{className:e1()(ap,en.s.flex.itemsCenter.b1.bSolid.colorBorder.radiusMedium.$)},o.createElement("div",{className:e1()(ap,au,en.s.flex.itemsCenter.h24.p2.justifyBetween.$)},o.createElement("div",{className:en.s.flex.itemsCenter.$},o.createElement("div",{className:e1()(am,en.s.mr4.$)},o.createElement(ad.J,{color:t,opacity:n})),o.createElement("div",{className:en.s.textBodyMedium.colorText.selectNone.$},ar.TI.format(t)))),n?o.createElement("div",{className:e1()(en.s.pl8.bl1.bSolid.colorBorderBg.colorText.flex.itemsCenter.selectNone.h24.w40.radiusMedium.$,"design_linter_violation_group_row--currentColorOpacity--kwVGB")},new ai.t6({min:0,max:100}).format(100*n),o.createElement("span",{className:en.s.colorTextSecondary.pl12.pr6.selectNone.$},"%")):null)}let aS=o.memo(function(){let e=nf(),t=Object.keys((0,y.useAtomValue)(ng.DJ)??[]).sort((e,t)=>e===nP.C.COMPONENT_MATCH?-1:t===nP.C.COMPONENT_MATCH?1:0);return o.createElement(o.Fragment,null,o.createElement("div",{className:en.s.flex.flexColumn.hFull.overflowYScroll.py8.$,onScroll:e},t.map(e=>o.createElement("div",{className:en.s.flex.flexColumn.mx8.$,key:e},o.createElement("div",{className:en.s.textBodyMedium.colorText.mx16.p8.selectNone.$},function(e){let t=(0,nC.r)();return t?t.getNameForRuleId(e):""}(e)),o.createElement(aC,{key:e,ruleId:e}),t.length>1&&e!==t[t.length-1]&&o.createElement("div",{className:e1()("design_linter_modal--borderBackground--MKrtZ",en.s.maxH1.flex.mx16.my8.h1.bRadius2.$)})))),o.createElement("div",{className:en.s.flex.p8.gap8.bt1.colorBorder.bSolid.justifyEnd.$},o.createElement(aO,null),o.createElement(aP,null)))});function aC({ruleId:e}){let t=((0,y.useAtomValue)(ng.DJ)??{})[e]??{};return o.createElement(o.Fragment,null,Object.keys(t).map(t=>o.createElement(ag,{key:t,contextKey:t,ruleId:e})))}function aO(){let[e,t]=(0,y.useAtom)(nu.K9),n=(0,y.useAtomValue)(ng.lj);return o.createElement(nI.$n,{variant:"secondary",disabled:!1,onClick:()=>{let a=new Map(e);n.forEach((e,t)=>{let n=a.get(t)??new Set;e.forEach(e=>n.add(e)),a.set(t,n)}),t(a);let o=Array.from(n.values()).flatMap(e=>Array.from(e)),l=(0,nC.r)();l?.markViolationsAsIgnoredForAllGroups(o)},iconPrefix:void 0},(0,d.tx)("design_linter.penalty_box.ignore_all"))}function aP(){let{onApplyAll:e,status:t}=function(){let[e,t]=(0,o.useState)("idle");return{onApplyAll:(0,o.useCallback)(async()=>{if("loading"!==e){if(t("loading"),!(0,nC.r)()){t("error");return}try{await y.atomStore.set(nM),t("success")}catch(e){(0,n9.Lt)((0,d.t)("design_linter.penalty_box.fix_failed_bell"),nw.zX.EXCLAMATION,"error"),t("error")}}},[e]),status:e}}(),n=(0,y.useAtomValue)(nD),a="loading"===t;return o.createElement(nI.$n,{variant:"primary",disabled:!n||a,onClick:e,iconPrefix:a?o.createElement(tW.k,null):void 0},(0,d.tx)("design_linter.penalty_box.apply_all"))}let aw=(0,o.memo)(function(){let e=(0,y.useAtomValue)(ng.vu).length;return o.createElement("div",{className:en.s.flex.flexColumn.colorBg.px16.py12.bb1.bSolid.colorBorder.$},o.createElement("div",{className:en.s.fpl__textBodyMediumStrongFontFamily.fpl__textBodyMediumStrongFontSize.fpl__textBodyMediumStrongFontWeight.fpl__textBodyMediumStrongLineHeight.selectNone.$},(0,d.tx)("design_linter.visual_group.title",{count:e})))}),ax=(0,o.memo)(function(){return!function(){let e=(0,y.useAtomValue)(ng.NM),t=Object.values((0,y.useAtomValue)(ng.DJ)??{}).reduce((e,t)=>e+Object.values(t).reduce((e,t)=>e+t.length,0),0),n=(0,o.useRef)(null),a=(0,o.useRef)(0);(0,o.useEffect)(()=>{let o=e===n.current,l=t===a.current;o&&l||(n.current=e,a.current=t,y.atomStore.set(nk))},[e,t])}(),o.createElement("div",{className:en.s.flex.flexColumn.colorBg.bl1.bSolid.colorBorder.hFull.wFull.overflowYScroll.$},o.createElement(aw,null),o.createElement(n8,null),(0,s.kc)().aip_flower_garden_debug&&o.createElement(nO,null),o.createElement(aS,null))});var ak=n(179220),aD=n(11266),aM=n(506989),aR=n(865523);let aL=o.memo(function(){let e=(0,o.useRef)(null),t=(0,y.useAtomValue)(ng.Bd),n=(0,y.useAtomValue)(ng.Gy),[a,l]=(0,y.useAtom)(ng.NM),r=(0,ak.Te)({count:t?.length??0,getScrollElement:()=>e.current,overscan:3,estimateSize:()=>174});!function(){let e=(0,y.useAtomValue)(ng.Bd),t=(0,y.useAtomValue)(nu.Iy),[n,a]=(0,y.useAtom)(ng.NM);(0,o.useEffect)(()=>{if(n&&t.get(n))return;let o=e[0];o&&a(o.id)},[n,a,e,t])}(),function(){let e=(0,y.useAtomValue)(ng.vu);(0,o.useEffect)(()=>{e.length&&i.Egt?.replaceSelection(e,!0)},[e])}();let s=n?n.y-40:400;return o.createElement("div",{ref:e,className:en.s.minW250.overflowYScroll.$,style:{height:s}},o.createElement("div",{className:en.s.wFull.relative.$,style:{height:r.getTotalSize()}},o.createElement("div",{className:en.s.top0.left0.wFull.relative.$,style:{height:`${r.getTotalSize()}px`}},r.getVirtualItems().map(e=>{let n=t[e.index];if(!n)return null;let r=(0,n9.ac)(n);if(!r)return null;let i=n.id===a;return o.createElement("div",{key:r,"data-index":e.index,className:en.s.flex.justifyCenter.my12.absolute.top0.left0.wFull.$,style:{height:`${e.size-24}px`,transform:`translateY(${e.start}px)`}},o.createElement(aV,{setSelectedGroup:l,rootNodeId:r,groupId:n.id,isSelected:i}))}))))});function aV({rootNodeId:e,groupId:t,isSelected:n,setSelectedGroup:a}){let l=(0,aD.ei)(e),r=(0,aR.yh)({nodeId:e,width:150,height:200,shouldSkip:!1,version:l?.lastEditedAt??"-",reason:"design-linter.thumbnail",regenerateAfterImagesLoaded:!0,isDevModeBlendedSection:!1}),i=nf(),s=(0,o.useCallback)(()=>{i(),a(t)},[i,t,a]);return r?o.createElement(t2.E,{className:e1()(en.s.h150.w200.p24.flex.itemsCenter.justifyCenter.overflowHidden.colorBgSecondary.b2.bRadius5.colorBorder.$,{[en.s.colorBorderSelected.$]:n}),onClick:s},o.createElement(e8.oW,{src:r.src,className:e1()("design_linter_modal--objectFitContain--TLOt0",en.s.maxWFull.maxHFull.$),alt:(0,d.t)("design_linter.penalty_box.thumbnail_alt")})):o.createElement(aM.Qp,{className:en.s.h150.w200.b2.bRadius5.colorBorder.$,animationType:aM.JR.LIGHT_SHIMMER})}let aU=o.memo(function(){let e=function(){let e=function(){let[e,t]=(0,o.useState)(!1),n=(0,y.useAtomValue)(nu.Cv);return(0,o.useEffect)(()=>{if(n===nN.t.DETECTION_REQUESTED){t(!1);return}n===nN.t.IDLE&&t(!0)},[n]),e}(),{status:t}=(0,y.useAtomValue)(nu.v4),n=["uninitialized","loading"].includes(t);return!e||n}(),t=function(){let e=(0,y.useAtomValue)(nu.Iy),t=(0,y.useAtomValue)(nu.m7);return 0===e.size&&0===t.size}();return e?o.createElement(aK,null,o.createElement(tW.k,null)):t?o.createElement(aK,null,o.createElement("div",{className:en.s.p12.flex.justifyCenter.$},(0,d.tx)("design_linter.penalty_box.no_violations"))):o.createElement("div",{className:en.s.flex.hFull.$},o.createElement(aL,null),o.createElement(ax,null))});function aK({children:e}){return o.createElement("div",{className:en.s.flex.flexColumn.mt12.itemsCenter.$},e,(0,s.kc)().aip_flower_garden_debug&&o.createElement(nO,null))}let aB=(0,nm.jz)(ny);function aF(){return(0,nu.qZ)()?o.createElement(az,null):null}let az=o.memo(()=>{let e=(0,eM.J2)(i.Ez5.uiState().showDesignLinter),t=(0,y.useAtomValue)(nu.FD);return(!function(){let e=(0,y.useSetAtom)(nu.v4),t=(0,nT.pN)(),n=t.data?.libraryVariables,a=t.data?.libraryVariableSets;(0,o.useEffect)(()=>{if("errors"===t.status){e(e=>({...e,status:"error"}));return}if("loaded"!==t.status)return;let o=new AbortController,l=o.signal;return async function(){if(a&&n){for(let e=0;e<a.length;e+=2){if(l.aborted)return;let t=a.slice(e,e+2).map(e=>(0,nb.RI)(e));await Promise.allSettled(t)}e({libraryVariables:n,libraryVariableSetIdToSet:a.reduce((e,t)=>(t.node_id&&(e[t.node_id]=t),e),{}),status:"loaded"})}}(),()=>{o.abort()}},[t.status,a,n,e])}(),!e||t)?null:o.createElement(a$,null)});function a$(){let e=nr.ox(),t=function(){let e=(0,tt.GQ)(),t=(0,o.useMemo)(()=>new tY.Mi(e+(0,nm.jz)(ny),(0,nm.jz)(ny)),[e]),[{windowInnerHeight:n,windowInnerWidth:a}]=(0,nd.A)((0,np.l)(),300,{equalityFn:nl.c2});return{initialPosition:t,maxHeight:n-2*aB,minHeight:250,minWidth:400,initialHeight:540,initialWidth:Math.min(a-2*aB,915)}}(),n=function(){let e=(0,y.useSetAtom)(ng.Gy);return(0,o.useMemo)(()=>nc()(t=>{e(t)},100),[e])}(),a=function(){let e=(0,y.useSetAtom)(ng.ej);return(0,o.useMemo)(()=>nc()(t=>{e(t)},100),[e])}(),l=nf(),r=(0,o.useCallback)(e=>{e.size&&n(e.size),a(e.position)},[a,n]);return(0,g.h)(()=>{n({x:t.initialWidth,y:t.initialHeight}),a({x:t.initialPosition.x,y:t.initialPosition.y})}),o.createElement(ni._L,{defaultWidth:t.initialWidth,defaultHeight:t.initialHeight,defaultPosition:{left:t.initialPosition.x,top:t.initialPosition.y},maxHeight:t.maxHeight,manager:e,onClose:({source:e})=>{"outside"!==e&&(l(),i.Ez5?.uiState().showDesignLinter.set(!1),i.mHF?.clearLinterScene())},onTransform:r},o.createElement(q.vo,null,o.createElement(q.Y9,null,o.createElement(aG,null)),o.createElement(q.nB,{padding:0,scrolling:"none"},o.createElement(aU,null))),o.createElement(nv,null))}function aG(){let e=nA();return o.createElement("div",{className:en.s.p8.pl16.cursorDefault.selectNone.pr0.wFull.pl8.$},o.createElement("div",{className:en.s.flex.flexRow.justifyBetween.itemsCenter.$},o.createElement("div",{className:en.s.flex.textBodyMediumStrong.$},o.createElement("span",{className:en.s.mr2.$},(0,d.tx)("design_linter.penalty_box.title")),o.createElement("span",null,e?`(${e})`:""))))}var aW=n(509066),aH=n(625313),aY=n(512056),aX=n(796817),aj=n(565849),aJ=n(848540),aq=n(663823),aZ=n(216681);function aQ({children:e}){return o.createElement(aZ.G.Provider,{value:{loggerEventName:"design_navigate"}},o.createElement(aJ.s.Provider,{value:{allowLibraryPublish:!0}},o.createElement(aq.K.Provider,{value:{showVisualLayerIcons:!1}},e)))}var a0=n(812932),a1=n(451808),a2=n(535729),a8=n(945647),a5=n(340778),a4=n(33262),a7=n(238249),a3=n(605758),a6=n(517393),a9=n(263159);let oe=(0,o.memo)(function(e){return(0,a9.jsxs)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:[(0,a9.jsx)("mask",{id:"fpl-icon-24-mail-a",fill:"#fff",children:(0,a9.jsx)("path",{fillRule:"evenodd",d:"M5.88 7h12.24a.88.88 0 0 1 .88.88v.82l-7 3.733L5 8.7v-.82A.88.88 0 0 1 5.88 7M4 8.99v7.13A1.88 1.88 0 0 0 5.88 18h12.24A1.88 1.88 0 0 0 20 16.12V7.88A1.88 1.88 0 0 0 18.12 6H5.88A1.88 1.88 0 0 0 4 7.88zm15 .843v6.287a.88.88 0 0 1-.88.88H5.88a.88.88 0 0 1-.88-.88V9.833l6.765 3.608.235.126.235-.126z",clipRule:"evenodd"})}),(0,a9.jsx)("path",{fill:"var(--color-icon)",d:"m19 8.7.47.882L20 9.3v-.6zm-7 3.733-.47.883.47.25.47-.25zM5 8.7H4v.6l.53.282zm-1 .31h1v-.02zm0-.02 1 .02v-.02zm16 .02-1-.02v.02zm0-.02h-1v.02zm-1 .843h1V8.167l-1.47.784zm-14 0 .47-.882L4 8.167v1.666zm6.765 3.608-.47.882zm.235.126-.47.882.47.251.47-.251zm.235-.126.471.882zM18.12 6H5.88v2h12.24zM20 7.88A1.88 1.88 0 0 0 18.12 6v2a.12.12 0 0 1-.12-.12zm0 .82v-.82h-2v.82zm-7.53 4.616 7-3.734-.94-1.764-7 3.733zM4.53 9.582l7 3.734.94-1.765-7-3.733zM4 7.88v.82h2v-.82zM5.88 6A1.88 1.88 0 0 0 4 7.88h2a.12.12 0 0 1-.12.12zM5 8.99v.02l-2-.04v.06zm-2 .02v7.11h2V9.01zm0 7.11A2.88 2.88 0 0 0 5.88 19v-2a.88.88 0 0 1-.88-.88zM5.88 19h12.24v-2H5.88zm12.24 0A2.88 2.88 0 0 0 21 16.12h-2a.88.88 0 0 1-.88.88zM21 16.12V9.01h-2v7.11zm-2-7.11v-.02l2 .04v-.06zm2-.02V7.88h-2v1.11zm0-1.11A2.88 2.88 0 0 0 18.12 5v2a.88.88 0 0 1 .88.88zM18.12 5H5.88v2h12.24zM5.88 5A2.88 2.88 0 0 0 3 7.88h2A.88.88 0 0 1 5.88 7zM3 7.88v1.11h2V7.88zm17 8.24V9.833h-2v6.287zM18.12 18A1.88 1.88 0 0 0 20 16.12h-2a.12.12 0 0 1 .12-.12zM5.88 18h12.24v-2H5.88zM4 16.12A1.88 1.88 0 0 0 5.88 18v-2a.12.12 0 0 1 .12.12zm0-6.287v6.287h2V9.833zm8.235 2.726L5.471 8.95l-.941 1.765 6.764 3.608zm.236.125-.236-.125-.94 1.765.235.125zm-.706-.125-.236.125.942 1.765.235-.126zm6.764-3.608-6.764 3.608.941 1.765 6.765-3.608z",mask:"url(#fpl-icon-24-mail-a)"})]})});var ot=n(882262),on=n(163773),oa=n(697737),oo=n(233950),ol=n(832995),or=n(607529),oi=n(60696);function os(){let e=(0,b.e)({overlay:x.Dqt,priority:C.N.DEFAULT_MODAL});(0,N.E)(e.uniqueId,"commentThreadMobileAnnouncementClicked",()=>{(0,E.sx)("sidebar_announcement_mobile_app_download_prompt_modal_shown"),e.show({})});let t=(0,o.useCallback)(async()=>{(0,E.sx)("sidebar_announcement_mobile_app_download_prompt_email_me_cta_clicked"),await oa.Ay.post("/api/send_mobile_download_email"),e.complete()},[e]);return o.createElement(ol.h,{isShowing:e.isShowing,modalType:or.q3.FEATURE_UPDATE,closeButtonStyle:or.M_.ON_DARK,element:()=>o.createElement(oc,{onEmailClick:t}),trackingContextName:"mobile_comment_announcement",onClickPrimaryCta:e.complete,onClose:e.complete,onManualDismiss:e.complete})}function oc(e){return o.createElement("div",{className:"modal_comment_sidebar_announcement--container--5oh-p"},o.createElement("div",{className:"modal_comment_sidebar_announcement--imageContainer--Vuo-V"},o.createElement("img",{alt:"Background",src:(0,s.ck)("e19f2f58bc09414847ad59ff9228e07032e8842c"),className:"modal_comment_sidebar_announcement--image--lyA61"}),o.createElement("div",{className:"modal_comment_sidebar_announcement--spacer--m02YT"}),o.createElement(oi.T,null)),o.createElement("div",{className:"modal_comment_sidebar_announcement--textContainer--btaTy"},o.createElement("div",{className:"modal_comment_sidebar_announcement--title--eiyLq"},o.createElement(oo.E,{fontSize:24,fontWeight:"semi-bold"},(0,d.t)("rcs.mobile_comment_announcement.title"))),o.createElement("div",{className:"modal_comment_sidebar_announcement--description--Y8AJE"},o.createElement(oo.E,{fontSize:14},(0,d.t)("rcs.mobile_comment_announcement.description")))),o.createElement("div",{className:"modal_comment_sidebar_announcement--buttonsContainer--UTcgc"},o.createElement(nI.$n,{variant:"secondary",onClick:e.onEmailClick,iconPrefix:o.createElement(oe,null)},(0,d.t)("rcs.mobile_comment_announcement.email_download_link")),o.createElement(nI.$n,{variant:"primary",onClick:()=>{(0,E.sx)("sidebar_announcement_mobile_app_download_prompt_learn_more_cta_clicked"),on.Ay.unsafeRedirect("https://help.figma.com/hc/articles/1500007537281-Guide-to-the-Figma-mobile-app#download","_blank")},iconPrefix:o.createElement(ot.b,null)},(0,d.t)("rcs.rcs_shared.learn_more"))))}var od=n(779312),om=n(640978),ou=n(851169),op=n(245459),o_=n(156310),oE=n(563192),og=n(550479),oy=n(663844),of=n(132939),ov=n(366172),oh=n(714266),oN=n(923219),ob=n(952122),oT=n(505534),oA=n(141604),oI=n(807221),oS=n(789022),oC=n(719176),oO=n(584068),oP=n(648800),ow=n(76237),ox=n(693565),ok=n(174103),oD=n(503965);let oM=(0,ok.ex)("prototype_action_info",function(){return o.createElement("div",{className:en.s.flex.itemsCenter.justifyCenter.$},o.createElement(ox.B,{className:"prototype_action_info_tooltip--prototypeDestinationInfoIcon--GeQWS",svg:oD.A}),o.createElement("span",{className:en.s.flexGrow1.m6.$,style:{maxWidth:144}},(0,d.tx)("proto.prototype_panel.use_the_circular_node_to_connect_the_selected_object_to_another_frame_tooltip")))},()=>({unconstrainWidth:!0})),oR=(0,o.memo)(function(e){return(0,a9.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,a9.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M11.5 6a.5.5 0 0 1 .5.5V11a1 1 0 0 0 1 1h4.5a.5.5 0 0 1 0 1H13a2 2 0 0 1-2-2V6.5a.5.5 0 0 1 .5-.5",clipRule:"evenodd"})})});var oL=n(24414),oV=n(373247),oU=n(125682),oK=n(880261),oB=n(238311),oF=n(399991),oz=n(604072),o$=n(904510),oG=n(453783),oW=n(806565);let oH=oG.c$,oY=oG.l6;function oX({action:e}){return o.createElement("div",{className:"prototype_action_dropdown--prototypeActionIcon--qChhY"},o.createElement(of.U,{svg:(0,oz.Yb)(e)},(0,oz.av)(e)))}function oj(e){let t=`prototype-action-select-${e.recordingKey}`,n=e.dropdownShown&&e.dropdownShown.type===t,a=(0,oN.E7)(e.action),r=(0,oz.Yb)(a),i=(0,oz.av)(a),s=(0,e$.GS)(),c=(0,l.d4)(o$.ZM),d=new oV.js(s,c),m=new oV.Z6(s,c),u=n?d:m,p=!(0,l.d4)(e=>e.mirror.selectionProperties.isValidPrototypingSourceSelected??!0),_=o.useCallback(e=>e-24,[]),E=o.useCallback(e=>e+24,[]),[g,y]=o.useState(void 0),f=o.createElement(oK.Q,{setMaxWidth:y,options:oJ(e),formatOption:e=>e&&e.props.value?u.format(e.props.value):"",getIcon:()=>o.createElement(oX,{action:"NAVIGATE_TO"})}),v=e1()({[e.className??""]:!0,"prototype_action_dropdown--select--b3Ssx":!s}),h=o.createElement(of.U,{svg:r},i);return o.createElement(o.Fragment,null,o.createElement(oY,{disabled:p,id:t,dataTestId:"action-select",className:v,chevronClassName:"prototype_action_dropdown--prototypeActionChevron--ZL1Q4",inputClassName:"prototype_action_dropdown--prototypeActionInputWithSvg--Atfua",property:e.action,formatter:u,onChange:e.onChange,dispatch:e.dispatch,dropdownShown:e.dropdownShown,icon:h,iconClassName:"prototype_action_dropdown--selectActionSvg--XfhUx",recordingKey:oE.Pt(e,"select"),hideDropdownWhenContainerMoves:!(0,oF.nl)(),dropdownAlignment:_,dropdownWidth:s?g:E},oJ(e)),s&&f)}function oJ(e){let t=(0,oW.cJ)(),n=(0,e$.GS)(),a=o.createElement(oH,{key:"NONE",value:"NONE",icon:o.createElement(oX,{action:"NONE"}),recordingKey:oE.Pt(e,"clear-option"),disabled:!1}),l=o.createElement(oH,{key:"NAVIGATE_TO",value:"NAVIGATE_TO",icon:o.createElement(oX,{action:"NAVIGATE_TO"}),recordingKey:oE.Pt(e,"navigate-to-option"),disabled:!1}),r=o.createElement(oH,{key:"SWAP_STATE_TO",value:"SWAP_STATE_TO",icon:o.createElement(oX,{action:"SWAP_STATE_TO"}),recordingKey:oE.Pt(e,"swap-state-to-option"),disabled:!i.glU.isSelectionContainedInStateOrStateInstance()}),c=o.createElement(oH,{key:"GO_BACK",value:"GO_BACK",icon:o.createElement(oX,{action:"GO_BACK"}),recordingKey:oE.Pt(e,"back-option"),disabled:!1}),d=o.createElement(oH,{key:"SCROLL_TO",value:"SCROLL_TO",icon:o.createElement(oX,{action:"SCROLL_TO"}),recordingKey:oE.Pt(e,"scroll-to-option"),disabled:!1}),m=o.createElement(oH,{key:"OPEN_URL",value:"OPEN_URL",icon:o.createElement(oX,{action:"OPEN_URL"}),recordingKey:oE.Pt(e,"url-option"),disabled:!1}),u=o.createElement(oH,{key:"OPEN_OVERLAY",value:"OPEN_OVERLAY",icon:o.createElement(oX,{action:"OPEN_OVERLAY"}),recordingKey:oE.Pt(e,"open-overlay-option"),disabled:!1}),p=o.createElement(oH,{key:"SWAP_WITH",value:"SWAP_WITH",icon:o.createElement(oX,{action:"SWAP_WITH"}),recordingKey:oE.Pt(e,"swap-with-option"),disabled:!1}),_=o.createElement(oH,{key:"CLOSE_OVERLAY",value:"CLOSE_OVERLAY",icon:o.createElement(oX,{action:"CLOSE_OVERLAY"}),recordingKey:oE.Pt(e,"close-option"),disabled:!1}),E=o.createElement(oH,{key:"SET_VARIABLE",value:"SET_VARIABLE",icon:o.createElement(oX,{action:"SET_VARIABLE"}),recordingKey:oE.Pt(e,"set-variable"),disabled:!1}),g=(0,s.kc)().prototype_set_mode_action&&o.createElement(oH,{key:"SET_VARIABLE_MODE",value:"SET_VARIABLE_MODE",icon:o.createElement(oX,{action:"SET_VARIABLE_MODE"}),recordingKey:oE.Pt(e,"set-variable-mode"),disabled:!1}),y=!e.isNestedInConditional&&o.createElement(oH,{key:"CONDITIONAL",value:"CONDITIONAL",icon:o.createElement(oX,{action:"CONDITIONAL"}),recordingKey:oE.Pt(e,"conditional"),disabled:!1}),f=o.createElement(oG.sK,{key:"first-divider"}),v=o.createElement(oG.sK,{key:"second-divider"}),h=o.createElement(oG.sK,{key:"third-divider"}),{getConfig:N}=(0,oB.I7)("exp_prototyping_reorder_actions"),b=!!N().getValue("new_ordering",!1),T=(0,s.kc)().sts_interaction_interop&&t?[r,c,d,f,E,y]:n?b?[a,f,l,r,c,d,m,v,E,g,y,h,u,p,_]:[a,f,l,r,c,d,m,v,u,p,_,h,E,g,y]:[a,f,l,r,c,v,E,g,y,d,m,h,u,p,_];if(e.showVideoActions&&!t){let t=[o.createElement(oG.sK,{key:"fourth-divider"}),o.createElement(oH,{key:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS",value:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS",icon:o.createElement(oX,{action:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS"}),recordingKey:oE.Pt(e,"update-media-play-pause-options"),disabled:!1}),o.createElement(oH,{key:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS",value:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS",icon:o.createElement(oX,{action:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS"}),recordingKey:oE.Pt(e,"update-media-mute-unmute-options"),disabled:!1}),o.createElement(oH,{key:"UPDATE_MEDIA_SKIP_TO",value:"UPDATE_MEDIA_SKIP_TO",icon:o.createElement(oX,{action:"UPDATE_MEDIA_SKIP_TO"}),recordingKey:oE.Pt(e,"update-media-skip_to"),disabled:!1}),o.createElement(oH,{key:"UPDATE_MEDIA_SKIP_BY_OPTIONS",value:"UPDATE_MEDIA_SKIP_BY_OPTIONS",icon:o.createElement(oX,{action:"UPDATE_MEDIA_SKIP_BY_OPTIONS"}),recordingKey:oE.Pt(e,"update-media-skip-by-options"),disabled:!1})];T=T.concat(t)}return T.filter(Boolean)}var oq=n(846288),oZ=n(777840),oQ=n(2907),o0=n(898626),o1=n(113843),o2=n(430772),o8=n(199476);let o5="prototype_action_verbose_title--actionNameInsertion--aF4kI",o4="prototype_action_verbose_title--actionName--qWJL3",o7="prototype_action_verbose_title--actionNameUI3--JAYsG",o3=()=>{let e=(0,l.d4)(e=>e.mirror.sceneGraph);return o.useMemo(()=>new oV.cP(e),[e])};function o6({action:e,isNestedInConditional:t,isNarrowPanel:n,onClick:a}){let l=(0,oC.YT)()===oC.Oz.TWO_COL,r=o.useContext(o0.c),s=l&&r===o0.P.LEFT,c=t||n,m=(0,nT.u)((0,oN.hS)(e.targetVariable)&&e.targetVariable&&"id"in e.targetVariable?e.targetVariable?.id:void 0),u=(0,oN.hS)(e.targetVariable)&&e.targetVariable&&"nodeFieldAlias"in e.targetVariable?(0,oQ.aA)(e.targetVariable.nodeFieldAlias.stablePathToNode,e.targetVariable.nodeFieldAlias.indexOrKey):void 0,p=m?.name??u?.name,_=o3(),E=new oV.Z6((0,e$.GS)()),g=(0,oV._X)(e),y=(0,oN.E7)(g),f=o.createElement(of.U,{svg:(0,oz.Yb)(y)},(0,oz.av)(y)),v=e=>{if(!e.connectionType||(0,oN.gl)(e.connectionType))return null;let t=e1()({[o4]:!0,[o7]:l}),n=e1()({"prototype_action_verbose_title--actionDestination--JZ-gU":!0,"prototype_action_verbose_title--actionDestinationUI3--ZGxbq":l});switch(e.connectionType){case"NONE":case"SET_VARIABLE_MODE":case"OBJECT_ANIMATION":return null;case"INTERNAL_NODE":case"BACK":case"CLOSE":case"UPDATE_MEDIA_RUNTIME":{let a=e.transitionNodeID;if((0,oN.gl)(a))return o.createElement("div",{className:t},(0,d.t)("proto.variant_actions.mixed"));if(void 0===a)return null;let l=op.dI(a),r=_.format(l);return o.createElement("div",{className:n},r)}case"URL":{let a=e.connectionURL;if(!a)return null;if((0,oN.gl)(a))return o.createElement("div",{className:t},(0,d.t)("proto.variant_actions.mixed"));return o.createElement("div",{className:n},a)}case"SET_VARIABLE":if(!e.targetVariableData||(0,oN.gl)(e.targetVariableData))return null;return o.createElement("div",{className:"prototype_action_verbose_title--setVariablePreviewContainer--6omxy"},o.createElement(oI.y3,{targetVariableData:e.targetVariableData,onClick:et.lQ,showVariableThumbnails:!1,isNarrowPanel:c,isInConditional:!0}));case"CONDITIONAL":{if((0,oN.gl)(e)||(0,oN.gl)(e.conditionalActions)||!e.conditionalActions)return null;let t=e.conditionalActions.length>0?e.conditionalActions[0].condition:void 0;return o.createElement(oI.y3,{targetVariableData:t,onClick:et.lQ,isInConditional:!0,showVariableThumbnails:!1})}default:(0,oq.xb)(e.connectionType)}},h=e1()({[en.s.block.bgTransparent.$]:!0,"prototype_action_verbose_title--buttonResetTextAlign--gy69p":!0,[o8.Li]:c&&!l,[o8.O8]:!c&&!l,[o8.kE]:l}),N=e1()({"prototype_action_verbose_title--iconContainer--jqarD":!0,"prototype_action_verbose_title--iconContainerUI3--yBP0-":l});return o.createElement(t2.E,{className:h,onClick:a},o.createElement(oZ.Y1,{horizontalAlignItems:"space-between",width:"fill-parent"},o.createElement("div",{className:N},f),(e=>{let t=y?E.format(y):"Undefined",n=e1()({[o4]:!0,[o7]:l});if((0,oN.gl)(e.connectionType)&&(t=(0,d.t)("fullscreen.mixed")),!e.connectionType||(0,oN.gl)(e.connectionType)||"NONE"===e.connectionType||"BACK"===e.connectionType||"CLOSE"===e.connectionType)return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t));var a=v(e);switch(e.connectionType){case"INTERNAL_NODE":if("SWAP_STATE"===e.navigationType)return o.createElement(o.Fragment,null,o.createElement("div",{className:n},(0,d.t)("proto.action_change_to")),a);if(a){if("OVERLAY"===e.navigationType)return o.createElement(o.Fragment,null,o.createElement("div",{className:o5},(0,d.tx)("proto.action_overlay_title",{overlayFrameName:o.createElement("span",null,a)})));if("SWAP"===e.navigationType)return o.createElement(o.Fragment,null,o.createElement("div",{className:n},(0,d.t)("proto.action_swap_overlay_title")),a)}return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t),a);case"UPDATE_MEDIA_RUNTIME":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t),a);case"URL":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},a?(0,d.t)("proto.action_url_title"):(0,d.t)("proto.action_open_link")),a);case"SET_VARIABLE":{let r=e.targetVariableData&&(0,oN.hS)(e.targetVariableData)&&e.targetVariableData.resolvedType===i.rXF.COLOR,c=e1()({"prototype_action_verbose_title--actionNameInsertionColor--isir- prototype_action_verbose_title--actionNameInsertion--aF4kI":!0,"prototype_action_verbose_title--actionNameInsertionColorUI3--Apj0i":l});if(p&&a)return o.createElement(o.Fragment,null,o.createElement("div",{className:r?c:o5},(0,d.tx)("proto.action_set_variable_title",{variableName:o.createElement("span",{className:"prototype_action_verbose_title--variableNameContainer--XeJX2"},o.createElement(o2.wG,{text:p,isDeleted:!!m&&(0,o1.eF)(m),disableHover:s})),variableValue:o.createElement("span",{className:"prototype_action_verbose_title--variableDestinationContainer--RXbKo prototype_action_verbose_title--variableNameContainer--XeJX2"},a)})));return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t))}case"SET_VARIABLE_MODE":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},(0,d.t)("proto.action_set_variable_mode")));case"CONDITIONAL":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},l?(0,d.t)("proto.if"):(0,d.t)("proto.action_conditional_title")),a);case"OBJECT_ANIMATION":return o.createElement(o.Fragment,null);default:(0,oq.xb)(e.connectionType)}})(e)))}var o9=n(903570),le=n(879058),lt=n(789529),ln=n.n(lt),la=n(636149),lo=n.n(la),ll=n(675551),lr=n.n(ll),li=n(184058),ls=n.n(li),lc=n(653798),ld=n(575232),lm=n(839439),lu=n(642870),lp=n(434167);let l_="prototype_set_variable_mode_controls--dropdownRow--vl5z4",lE="missing",lg=oG.l6,ly=oG.c$,lf=oG.l6,lv=oG.c$,lh={};function lN(){let e=(0,nT.h6)()||lh,t=(0,lu.iR)(),n=o.useMemo(()=>{let n=lr()(t,(e,t)=>({collectionID:e.node_id,collectionName:e.name,modeOptions:e.modes?.map(t=>({modeId:{guid:t.id,collectionKey:e.key},name:t.name,isCompatible:!0}))||[],explicitMode:null,inheritMode:null,libraryKey:e.library_key}));return ln()({},e,n)},[t,e]),a=o.useMemo(()=>Object.entries(n).map(([e,t])=>({setKey:e,modeData:t,isLocal:void 0===t.libraryKey})),[n]),r=o.useMemo(()=>Object.values(a).filter(e=>e.modeData?.modeOptions&&e.modeData?.modeOptions.length>1),[a]),s=o.useMemo(()=>ls()(r.map(e=>e.modeData.libraryKey??lp.CC)),[r]),c=(0,ld.U)(s),[m,u]=o.useMemo(()=>{let{_local:e,_unknownFile:t,...n}=lo()(r,e=>e.isLocal?"_local":e.modeData.libraryKey&&c.data?.[e.modeData.libraryKey]===void 0?"_unknownFile":e.modeData.libraryKey),a=Object.entries(n).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>[{libraryKey:e,fileName:c.data?.[e]??""},...t]).flat(1);return t&&(a.push({libraryKey:lp.CC,fileName:(0,d.t)("variables.mode_properties_panel.used_variables.subheading")}),a.push(...t)),[e??[],a]},[c,r]),p=(0,lu.d2)(),_=o.useCallback(e=>{let t=p[(0,le.yG)(e)],n=r.find(t=>t.setKey===e);if(n)return(e=>{if(e)return void 0===t&&(t=e.modeData.modeOptions[0].modeId.guid),e.modeData.modeOptions.find(e=>e.modeId.guid!==t&&(t=e.modeId.guid,!0))?.modeId.guid})(n)},[p,r]),E=r.length>0?r[0]:void 0,g=E?.setKey,y=E?.modeData.collectionID,f=o.useMemo(()=>g&&_(g),[g,_]),v=(0,l.wA)();return{localVariableSets:m,allVariableSets:r,firstVariableSet:E,firstVariableSetID:y,firstVariableSetMode:f,getDefaultNewModeForVariableCollectionKey:_,reportAnalyticsEventWhenSelected:e=>{let t=i.mSn.getVariableSetInfoForSetModeAnalytics(e);v((0,ob.Zh)({name:"prototype.set_mode_select_variable_set",params:{...t}}))},subscribedVariableSetsWithSections:u}}function lb({targetVariableSetID:e,targetVariableModeID:t,deprecatedTargetVariableSetKey:n,updateSelectionProperties:a,recordingKey:l,actionIndexPath:r}){let{getDefaultNewModeForVariableCollectionKey:i,allVariableSets:s,reportAnalyticsEventWhenSelected:c}=lN(),{shouldShowAdvancedPrototypingPaywall:m,showAdvancedPrototypingVariablesModal:u}=(0,oC.zt)(),p=(0,e$.GS)();o.useEffect(()=>{if(!n||(0,oN.gl)(n))return;let e=s.find(e=>e.setKey===n);e?((0,lc.Lo)("SetVariableModeControls","updating variable set key to non-deprecated id value"),a({targetVariableSetKey:void 0,targetVariableSetID:e?.modeData.collectionID})):((0,lc.Lo)("SetVariableModeControls","attempted to update variable set key to non-deprecated id value, but could not find it in the list of variable sets, will just clear out the bad data."),a({targetVariableSetKey:void 0}))},[n,s,a]);let[_,E]=o.useMemo(()=>{let t=(0,oN.gl)(e)||void 0===e?e:function(e,t){let n=e.find(e=>e.modeData.collectionID===t);if(n)return n;let a=o9.gr.toRefIfSubscribed(t);if(a)return e.find(e=>e.setKey===a.key)}(s,e)||lE,n=(()=>{if(!(0,oN.gl)(t)&&void 0!==t&&t!==lE)return t})();return[t,n]},[e,s]),g=o.createElement(lI,{selectedVariableSet:_,onChange:e=>{m?u():(c(e.modeData.collectionID),a({targetVariableSetID:e.modeData.collectionID,targetVariableModeID:i(e.setKey)}))},actionIndexPath:r}),y=p?o.createElement(lm.cS,{input:g,label:(0,d.tx)("proto.set_variable_mode.collection_label")}):o.createElement(ow.fI,{recordingKey:oE.Pt(l,"selectTargetVariableSet")},g),f=o.createElement(lO,{selectedVariableSetKey:E&&E.setKey,selectedVariableModeID:t,onChange:e=>{m?u():a({targetVariableModeID:e})},actionIndexPath:r}),v=p?o.createElement(lm.cS,{input:f,label:(0,d.tx)("proto.set_variable_mode.mode_label")}):o.createElement(ow.fI,{recordingKey:oE.Pt(l,"selectTargetVariableMode")},f);return o.createElement("div",{className:p?void 0:en.s.relative.$},y,E&&v)}let lT={format:e=>void 0===e?(0,d.t)("proto.prototype_panel.edit_set_mode.none"):e===lE?(0,d.t)("proto.prototype_panel.edit_set_mode.missing_collection"):e.modeData.collectionName,isEqual:(e,t)=>void 0!==e&&void 0!==t&&e!==lE&&t!==lE&&(e.setKey===t.setKey||e.modeData.collectionID===t.modeData.collectionID)};function lA(e,t){return"libraryKey"in e?[t&&o.createElement(oG.sK,{key:e.libraryKey+"divider"}),o.createElement(ly,{isHeader:!0,key:e.libraryKey+"header",formattedValue:e.fileName})]:o.createElement(ly,{key:e.setKey,value:e})}function lI({selectedVariableSet:e,onChange:t,actionIndexPath:n}){let a=(0,l.wA)(),r=(0,oU.Um)(),i="set-variable-mode--select-variable-set-"+n,{localVariableSets:c,allVariableSets:m,subscribedVariableSetsWithSections:u}=lN();return o.createElement(lg,{id:i,className:l_,property:e,formatter:lT,dispatch:a,dropdownShown:r?.type===i?r:null,onChange:e=>{(0,oN.gl)(e)||void 0===e||e===lE||t(e)}},m.length>0?[c.length>0&&o.createElement(ly,{key:oE.Pt(i,"local_variables"),isHeader:!0,formattedValue:(0,s.kc)().ds_variable_props_unified_ui?(0,d.t)("variables.mode_properties_panel.assets_created_in_file.subheading"):(0,d.t)("variables.mode_properties_panel.local_variables.subheading")}),...c.map(e=>lA(e,!1)),...u.map((e,t)=>lA(e,c.length>0||t>0))]:[])}let lS={format:e=>void 0===e?(0,d.t)("proto.prototype_panel.edit_set_mode.none"):e===lE?(0,d.t)("proto.prototype_panel.edit_set_mode.missing_mode"):e?.name??""};function lC(e){return o.createElement(lv,{key:e.modeId.guid,value:e})}function lO({selectedVariableSetKey:e,selectedVariableModeID:t,onChange:n,actionIndexPath:a}){let r=(0,l.wA)(),i=(0,oU.Um)(),s="set-variable-mode--select-variable-mode-"+a,{allVariableSets:c}=lN(),d=o.useMemo(()=>c.find(t=>t.setKey===e)?.modeData.modeOptions,[e,c]),m=o.useMemo(()=>(0,oN.gl)(t)||void 0===t?t:d?.find(e=>e.modeId.guid===t)||lE,[t,d]);return o.createElement(lf,{id:s,className:l_,property:m,formatter:lS,dispatch:r,dropdownShown:i?.type===s?i:null,onChange:e=>{!e||(0,oN.gl)(e)||e===lE||n(e.modeId.guid)}},d&&d?.map(lC))}var lP=n(442133),lw=n(108982),lx=n(73041),lk=n(105498),lD=n(103785),lM=n(462575),lR=n(499325),lL=n(756044),lV=n(143364),lU=n(868911),lK=n(413327),lB=n(859877),lF=n(546758),lz=n(488527),l$=n(910392),lG=n(687285),lW=n(442458);let lH=ar.TI;function lY({children:e}){return(0,e$.GS)()?o.createElement(lm.TN,null,e):o.createElement(ow.fI,{className:"overlay_panel--fplCheckboxRow--EYTAZ checkbox--_checkboxRow--oEhow"},e)}function lX({interactionType:e,recordingKey:t,actionIndexPath:n,nodeId:a}){let[r,s]=o.useState(!1),[c,m]=o.useState(new tY.Mi),u=(0,l.wA)(),p=(0,e$.GS)(),_="{ "+n.join(", ")+" }",{destinationOverlayBackgroundColor:E,destinationOverlayBackgroundType:g,destinationOverlayPositionType:y,destinationOverlayBackgroundInteraction:f}=(0,lw.R)(e=>({destinationOverlayBackgroundColor:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[_]?.destinationOverlayBackgroundColor,destinationOverlayBackgroundType:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[_]?.destinationOverlayBackgroundType,destinationOverlayPositionType:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[_]?.destinationOverlayPositionType,destinationOverlayBackgroundInteraction:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[_]?.destinationOverlayBackgroundInteraction})),v=o.useRef(null),h=o.useRef(null),N=o.useCallback(()=>{s(!1)},[s]),b=o.useCallback(()=>{if(r)N();else{s(!0);let e=p?h.current:v.current;m((0,lV.cn)(e))}},[r,N,p]),T=o.useCallback(e=>{let t=e?"SOLID_COLOR":"NONE";ou.l7.user("overlay-background-type-edit-scope",()=>{i.X3B.setOverlayBackgroundType(op.dI(a),t)}),u((0,ob._P)({name:"Overlay background visible changed",params:{backgroundType:t}}))},[u,a]),A=o.useCallback(e=>{let t=e?"CLOSE_ON_CLICK_OUTSIDE":"NONE";ou.l7.user("overlay-background-interaction-edit-scope",()=>{i.X3B.setOverlayBackgroundInteraction(op.dI(a),t)}),u((0,ob._P)({name:"Overlay background interaction changed",params:{backgroundInteraction:t}}))},[u,a]),I=o.useCallback(()=>(0,oN._W)(E,{r:0,g:0,b:0,a:.25}),[E]),S=o.useCallback((e,t)=>{t!==lL.zk.NO&&ou.l7.user("overlay-background-color-edit-scope",()=>{i.X3B.setOverlayBackgroundColor(op.dI(a),e)})},[a]),C=o.useCallback((e,t)=>{S(e,lL.zk.YES)},[S]),O=o.useCallback((e,t)=>{let n=I();S({r:n.r,g:n.g,b:n.b,a:e},t)},[I,S]),P=o.useCallback(e=>{ou.l7.user("overlay-position-type-edit-scope",()=>{i.X3B.setOverlayPositionType(op.dI(a),e)}),u((0,ob._P)({name:"Overlay position changed",params:{position:e}}))},[u,a]),w=I(),x=I().a,k=(0,oN.E7)(y),D="CLOSE_ON_CLICK_OUTSIDE"===(0,oN.E7)(f),M="SOLID_COLOR"===(0,oN.E7)(g),R=o.createElement("div",{className:"overlay_panel--colorValueContainer--gJtb9 paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t"},o.createElement(ad.J,{onClick:M?b:()=>{},color:w,opacity:x,recordingKey:oE.Pt(t,"chit"),className:"overlay_panel--chit--Zn66r paint_panels--chit--twQEy"}),o.createElement(lB.AN,{className:p?"overlay_panel--colorInputUI3--ozOrK paint_panels--colorInput--nSz13":"overlay_panel--colorInput--6yyym paint_panels--colorInput--nSz13",noLeftBorder:!0,formatter:lH,property:w,disabled:!M,onChange:C,recordingKey:oE.Pt(t,"colorInput"),noBorderOnFocus:!0}),o.createElement(lU.Pd,{className:"overlay_panel--opacity--vrrjV paint_panels--opacityInputContainer--oqlsk",value:x,onValueChange:O,dispatch:u,disabled:!M,noBorderOnFocus:!0,recordingKey:oE.Pt(t,"opacity")}));return o.createElement(ow.Zk,{className:p?"overlay_panel--overlayPanelUI3--GLqgD":"overlay_panel--overlayPanel--l-Hts"},!p&&o.createElement(ow.fI,null,o.createElement(ow.xw,{faded:!0,className:"overlay_panel--overlayPanelTitle--e9pjs"},(0,d.tx)("proto.overlay_settings"))),o.createElement(l1,{overlayPositionType:k,onOverlayPositionTypeChange:P,recordingKey:t}),!("ON_HOVER"===e||"ON_PRESS"===e)&&o.createElement(lY,null,o.createElement(lM.S,{label:o.createElement(lR.J,null,(0,d.tx)("proto.close_when_clicking_outside")),recordingKey:oE.Pt(t,"closeOnClickOutside"),onChange:A,checked:D})),o.createElement(lY,null,o.createElement(lM.S,{label:o.createElement(lR.J,null,p?(0,d.tx)("proto.overlay_panel.background"):(0,d.tx)("proto.add_background")),recordingKey:oE.Pt(t,"addBackgroundBehindOverlay"),onChange:T,checked:M})),M&&(p?o.createElement(lm.cS,{ref:h,label:(0,d.tx)("proto.overlay_panel.background"),input:R}):o.createElement(ow.fI,{ref:v}," ",R," ")),r&&o.createElement(lK.h3,{disabledVariableIds:new Set,initialPosition:c,color:w,boundVariable:null,onChange:S,onClose:N,recordingKey:oE.Pt(t,"colorPicker")}))}let lj=oG.l6,lJ=oG.c$;class lq extends o.PureComponent{constructor(){super(...arguments),this.titleFormatter=new oV.Cr,this.renderOverlayPositionOption=(e,t)=>o.createElement(lJ,{key:t,value:e,recordingKey:oE.Pt(this.props,e)})}render(){let e=["CENTER","TOP_LEFT","TOP_CENTER","TOP_RIGHT","BOTTOM_LEFT","BOTTOM_CENTER","BOTTOM_RIGHT"].map(this.renderOverlayPositionOption);return o.createElement(lj,{id:this.props.recordingKey??"overlay-position_select",className:this.props.className,chevronClassName:"overlay_panel--chevron--7RTA-",inputClassName:"overlay_panel--input--tGHHB",dropdownWidth:lz.DxS,property:this.props.property,formatter:this.titleFormatter,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,recordingKey:oE.Pt(this.props,"select")},e,o.createElement(oG.sK,null),this.renderOverlayPositionOption("MANUAL",10))}}lq.displayName="OverlayPositionDropdown";class lZ extends lF.I{}class lQ extends lF.Y{}class l0 extends o.PureComponent{render(){return o.createElement(lZ,{className:this.props.className,property:this.props.property,onChange:this.props.onChange,recordingKey:this.props.recordingKey},o.createElement(lQ,{value:"CENTER",tooltip:(0,d.t)("proto.tooltip_overlay_position_center"),svg:lG.A,recordingKey:oE.Pt(this.props,"center")}),o.createElement(lQ,{value:"TOP_LEFT",tooltip:(0,d.t)("proto.tooltip_overlay_position_top_left"),svg:lW.A,recordingKey:oE.Pt(this.props,"top-left")}),o.createElement(lQ,{value:"BOTTOM_CENTER",tooltip:(0,d.t)("proto.tooltip_overlay_position_bottom_center"),svg:l$.A,recordingKey:oE.Pt(this.props,"bottom-center")}))}}function l1({overlayPositionType:e,onOverlayPositionTypeChange:t,recordingKey:n}){let a=(0,e$.GS)(),r=(0,l.wA)(),i=(0,oU.Um)(),s=o.createElement(lq,{className:"overlay_panel--overlayPositionDropdown--ZxxSI",property:e,dispatch:r,dropdownShown:i,onChange:t,recordingKey:oE.Pt(n,"overlayPositionDropdown")}),c=o.createElement(l0,{property:e,onChange:t,recordingKey:oE.Pt(n,"overlayPositionControl"),className:"overlay_panel--overlayPositionControl--SWngJ"});return a?o.createElement(lm.cS,{label:(0,d.tx)("proto.overlay_panel.position"),input:s}):o.createElement(ow.fI,null,s,c)}var l2=n(783307),l8=n(354082),l5=n(662068),l4=n(50474),l7=n(689954),l3=n(501191);let l6=e=>`interaction-panel-create-action-${e}`;function l9(e){let t=l6(e.recordingKey);var{showing:n,toggle:a,hide:r}=(0,oU.BK)(t);let i=(0,o.useRef)(null),{recordingKey:s,addButtonPressed:c,presetInteractions:m}=e,{shouldShowAdvancedPrototypingPaywall:u,showAdvancedPrototypinglMultipleActionsModal:p}=(0,oC.zt)(),_=(0,o.useCallback)(()=>{!e.skipPaywall&&u?p():a()},[e.skipPaywall,u,p,a]),E=(0,oC.YT)()===oC.Oz.TWO_COL,g=(0,oC.hP)(),y=(0,e$.GS)(),v=(0,oW.cJ)(),h=(0,oC.He)({showVideoActions:g,isNestedInConditional:e.isNestedInConditional,isSites:v,isUI3:y,showPresetActions:!!e.presetInteractions}),N=(0,l.wA)(),b=(0,o.useCallback)(e=>{c((0,oC.Bs)(e)),r()},[c,r]),T=e1()({[o8.x1]:e.renderButton,[o8.xm]:!e.renderButton&&!E,[o8.U3]:!e.renderButton&&E}),A=[];h.forEach(e=>{(0,oC.vc)(e)?A.push(l4.w):e===oC.Xk&&m?.length?A.push(...m,l4.w):A.push(function({actionType:e,clickCb:t,recordingKey:n,isUI3:a}){let l=(0,oz.Yb)(e),r=(0,oz.av)(e),i=new oV.Z6(a),s=e?i.format(e):"Undefined";return{className:o8.BP,callback:()=>t(e),icon:o.createElement(of.U,{className:o8.QE,svg:l},r),displayText:s,recordingKey:oE.Pt(n,"createActionOption",e)}}({clickCb:b,recordingKey:s,actionType:e,isUI3:y}))});let I=e.isNestedInConditional?(0,d.t)("proto.prototype_panel.add_nested_action"):(0,d.t)("proto.prototype_panel.add");return o.createElement(o.Fragment,null,o.createElement(f.e6,{ref:i,recordingKey:oE.Pt(s,"createActionDropdown"),className:T,onClick:_,"aria-label":(0,d.t)("proto.prototype_panel.create_action_button"),htmlAttributes:{"data-tooltip":I,"data-tooltip-type":"text"}},e.renderButton?o.createElement(of.U,{svg:l3.A},o.createElement(l5.e,null)):(0,d.tx)("fullscreen.properties_panel.click_plus_to_add_new_action")),n&&i.current&&o.createElement(l7.j,{minWidth:130,lean:"center",parentRect:i.current.getBoundingClientRect(),hidePointWhenContentOffScreen:!0,showPoint:!0,items:A,dispatch:N,onSelectItem:e=>e.callback?.(),recordingKey:"actionDropdown"}))}let re="prototype_conditional_controls--conditionalRowUI3--rQlu6",rt="prototype_conditional_controls--conditionIcon--Npk57";var rn=n(381809),ra=n(527967),ro=n(5068);function rl({onDeleteAction:e,updateMultipleDestinationNodes:t,updateSelectionProperties:n,updateCondition:a,updateActions:l,onAddAction:r,autoOpenVariablePicker:s,isSelected:c,handleMouseDownUI3:m,...u}){let p=u.conditionalActions,_=p?.actions?p?.actions:[],E=p?.condition?p?.condition:void 0,g=(0,oC.YT)()===oC.Oz.TWO_COL,y=g?re:"prototype_conditional_controls--conditionalRowIf--25FqB prototype_conditional_controls--conditionalRow--u0PaS",f=o.createElement(oI.KN,{resolvedType:i.rXF.BOOLEAN,targetVariableData:E,updateSelectionProperties:n,recordingKey:u.recordingKey,updateConditionInConditionalAction:a,showVariableThumbnails:!0,isNarrowPanel:!0}),v=o.createElement("div",{className:"prototype_conditional_controls--addButton--vlYLn"},o.createElement(l9,{addButtonPressed:r,recordingKey:oE.Pt(u.recordingKey,"addActionToIfButton"),renderButton:!0,isNestedInConditional:!0})),h=o.createElement(o.Fragment,null,g?o.createElement("span",{className:"prototype_conditional_controls--conditionIconUI3--zcwx0"},(0,d.tx)("proto.else")):o.createElement(ox.B,{className:rt,svg:rn.A}),!g&&_.length>0&&o.createElement("div",{className:"prototype_conditional_controls--addButtonForElse--ogBWu prototype_conditional_controls--addButton--vlYLn"},o.createElement(l9,{addButtonPressed:r,recordingKey:oE.Pt(u.recordingKey,"addActionToElseButton"),renderButton:!g,isNestedInConditional:!0}))),N=g?o.createElement(t2.E,{className:"prototype_conditional_controls--elseBlockRowUI3--VXjmO",onClick:m},h):o.createElement(ow.fI,{className:g?re:"prototype_conditional_controls--conditionalRow--u0PaS"},h);return o.createElement(o.Fragment,null,u.ifStatement&&o.createElement("div",{className:y},!g&&o.createElement(oP.Y,{direction:"horizontal",spacing:4},o.createElement("span",{className:g?"prototype_conditional_controls--conditionalRowConditionUI3--M2mOx":"prototype_conditional_controls--conditionalRowCondition--kn-f7"},o.createElement(oP.Y,{direction:"horizontal",spacing:0},o.createElement(ox.B,{className:rt,svg:ra.A}),o.createElement(oP.Y,{direction:"horizontal",spacing:0},(0,oN.hS)(E)&&f),o.createElement(ox.B,{className:"prototype_conditional_controls--icon--JV1i0",svg:ro.default}))),!g&&_.length>0&&v)),!u.ifStatement&&N,_&&_.map((a,l)=>o.createElement(r6,{key:l,updateMultipleDestinationNodes:t.appendActionIndex(l),action:a,recordingKey:oE.Pt(u.recordingKey,"conditional-action-row",l),updateSelectionProperties:n.appendActionIndex(l),onDeleteAction:()=>e(l),interactionType:u.interactionType,actionIndexPath:[u.actionIndexPath[0],u.actionIndexPath[1],l],numActions:_.length,isNestedInConditional:!0,stateManagementVersion:u.stateManagementVersion,selectedInteractions:u.selectedInteractions,onDrop:u.onDrop,onSelect:u.onSelect,onExpand:u.onExpand,onAddAction:r,selectedActionIndex:u.selectedActionIndex,expandedRows:u.expandedRows,autoOpenVariablePicker:s})),0===_.length&&o.createElement(r6,{key:0,updateMultipleDestinationNodes:t.appendActionIndex(0),action:u.emptyAction,recordingKey:oE.Pt(u.recordingKey,"conditional-action-row",0),updateSelectionProperties:n.appendActionIndex(0),onDeleteAction:()=>e(0),interactionType:u.interactionType,actionIndexPath:[u.actionIndexPath[0],u.actionIndexPath[1],0],numActions:_.length,isNestedInConditional:!0,stateManagementVersion:u.stateManagementVersion,selectedInteractions:u.selectedInteractions,onDrop:u.onDrop,onSelect:u.onSelect,onExpand:u.onExpand,onAddAction:r,selectedActionIndex:u.selectedActionIndex,expandedRows:u.expandedRows,autoOpenVariablePicker:s}))}function rr(e,t,n){return function(a){var o=[...t];o.length>e?o[e].condition=a:o.push({condition:0===e?a:void 0,actions:[]},{condition:1===e?a:void 0,actions:[]}),n({conditionalActions:o})}}function ri({onDrop:e,onSelect:t,onExpand:n,action:a,updateMultipleDestinationNodes:r,updateSelectionProperties:i,interactionType:s,recordingKey:c,stateManagementVersion:m,selectedInteractions:u,actionIndexPath:p,selectedActionIndex:_,expandedRows:E,autoOpenVariablePicker:g,onNewActionAdded:y,handleMouseDownUI3:f}){let v=(0,l.wA)(),h=(0,eE.p8)("currentPage"),N=(0,oC.YT)()===oC.Oz.TWO_COL,b=N?_.equals(p):void 0,{shouldShowAdvancedPrototypingPaywall:T,showAdvancedPrototypingConditionalActionsModal:A}=(0,oC.zt)(),I=(0,oN.hS)(a.conditionalActions)&&a.conditionalActions?a.conditionalActions:[],S=e=>function(t){var n=[...I];n.length>e?n[e].actions=[...t]:n.push({actions:t}),i({conditionalActions:n})},C=e=>function(t){var n=[...I],a=0;if(n.length>e){var o=n[e].actions;o?o.push(t):o=[t],a=o.length}else n.push({actions:0===e?[t]:[]},{actions:1===e?[t]:[]}),a=1;"SET_VARIABLE"===t.connectionType&&(g.current=!0),i({conditionalActions:n}),y&&y(new l8.Op([p[0],e,a-1])),v((0,ob._P)({name:"Prototype add action",params:{action:t.connectionType?t.connectionType:"NONE",source:"panel",page_id:h,actionInConditionalAction:!0}}))},O=e=>function(t){if(T)A();else{var n=[...I];let a=I[e],o=[];if(a&&a.actions)for(let e=0;e<a.actions.length;e++){let n=a.actions[e];e!==t?o.push(n):v((0,ob._P)({name:"Prototype delete action",params:{action:n.connectionType?n.connectionType:"NONE",source:"panel",page_id:h,actionInConditionalAction:!0}}))}n[e].actions=o,i({conditionalActions:n})}},P=I.length>0?I[0]:void 0,w=I.length>1?I[1]:void 0;return o.createElement("div",{style:N?{position:"relative"}:void 0},(0,oN.gl)(a.conditionalActions)&&o.createElement(oZ.Y1,null,o.createElement(t2.E,{className:"prototype_conditional_controls--mixedConditionalText--6O32b",onClick:()=>{var e=[];e.push({},{}),i({conditionalActions:e})}},(0,d.t)("fullscreen.properties_panel.click_to_replace_mixed_content"))),(0,oN.hS)(a.conditionalActions)&&o.createElement(o.Fragment,null,o.createElement(rl,{key:0,conditionalActions:P,recordingKey:oE.Pt(c,"conditional-block",0),updateCondition:rr(0,I,i),updateActions:S(0),onAddAction:C(0),updateMultipleDestinationNodes:r.appendActionIndex(0),onDeleteAction:O(0),interactionType:s,updateSelectionProperties:i.appendActionIndex(0),ifStatement:!0,stateManagementVersion:m,selectedInteractions:u,actionIndexPath:[p[0],0],onDrop:e,onSelect:t,onExpand:n,selectedActionIndex:_,autoOpenVariablePicker:g,expandedRows:E,emptyAction:{ifStatement:!0,action:a},isSelected:b,handleMouseDownUI3:f}),o.createElement(rl,{key:1,conditionalActions:w,recordingKey:oE.Pt(c,"conditional-block",1),updateCondition:rr(1,I,i),updateActions:S(1),onAddAction:C(1),updateMultipleDestinationNodes:r.appendActionIndex(1),onDeleteAction:O(1),interactionType:s,updateSelectionProperties:i.appendActionIndex(1),ifStatement:!1,stateManagementVersion:m,selectedInteractions:u,actionIndexPath:[p[0],1],onDrop:e,onSelect:t,onExpand:n,selectedActionIndex:_,autoOpenVariablePicker:g,expandedRows:E,emptyAction:{ifStatement:!1,action:a},isSelected:b,handleMouseDownUI3:f})))}function rs({updateSelectionProperties:e,conditionalActions:t,autoOpenExpressionBuilder:n,setAutoOpenExpressionBuilder:a,...l}){let r=t.length>0?t[0]:void 0,s=r?.condition?r?.condition:void 0,c=e1()({"prototype_conditional_controls--standaloneIfConditional--GLFDU":!0,"prototype_conditional_controls--placeholderText--esG0u":!s});return o.createElement(o.Fragment,null,o.createElement(lm.cS,{input:null,label:(0,d.tx)("proto.condition")}),o.createElement(lP.Ad,{appendedClassName:"prototype_conditional_controls--conditionalActionRightPadding--xpK6Z",label:null,input:(0,oN.hS)(s)?o.createElement("div",{className:c},o.createElement(oI.KN,{resolvedType:i.rXF.BOOLEAN,targetVariableData:s,updateSelectionProperties:e.appendActionIndex(0),recordingKey:l.recordingKey,updateConditionInConditionalAction:rr(0,t,e),autoOpenExpressionBuilder:n,setAutoOpenExpressionBuilder:a,showVariableThumbnails:!0,isNarrowPanel:!0})):null}))}var rc=n(404227),rd=n(210317),rm=n(505764),ru=n(806772);let rp=oG.c$,r_=oG.l6;function rE(e){let t=o.useMemo(()=>new oV.cP(e.scene),[e.scene]),[n,a]=o.useState([]),[l,r]=o.useState([]),s=(0,oW.cJ)(),c=e.nodeId===oN.oV?oN.oV:op.dI(e.nodeId),d=n;(0,oN.hS)(c)&&c!==op.AD&&-1===d.indexOf(c)&&(d=d.concat([c]));let m=`prototype-destination-select-${e.recordingKey}`,u="SCROLL_TO"!==e.action?d.filter(e=>t.hasNameForNode(e)).map((t,n)=>o.createElement(rp,{key:`enabled-${t}`,value:t,recordingKey:oE.Pt(e,`viable-option-${n}`),disabled:!1})):((n,a)=>{let l=lo()(n.filter(e=>t.hasNameForNode(e)),t=>t===a&&(0,oN.hS)(a)?nS.Ql(e.scene,t)?.guid:e.scene.get(t)?.parentGuid),r=Object.keys(l);(0,nS.X4)(r,t.format.bind(t));let{tlfId:i,index:s}=(0,nS.H_)(e.scene,r);return i&&s&&(r.splice(s,1),r=[i,...r]),r.reduce((t,n,a)=>(0!==a&&t.push(o.createElement(oG.sK,{key:a})),t.push(o.createElement(rp,{key:`disabled-${n}`,value:n+" ",recordingKey:oE.Pt(e,`disabled-option-${n}`),disabled:!0})),l[n].forEach((n,a)=>{t.push(o.createElement(rp,{key:`enabled-${n+a}`,value:n,recordingKey:oE.Pt(e,`viable-option-${a}`),disabled:!1}))}),t),[])})(d,c),p=l.filter(e=>t.hasNameForNode(e)).map((t,n)=>o.createElement(rp,{key:`disabled-${t}`,value:t,recordingKey:oE.Pt(e,`disabled-option-${n}`),disabled:!0})),_=e.isUI3?o.Fragment:ow.fI;return o.createElement(_,null,o.createElement(r_,{id:m,dataTestId:"destination-select",className:e.className,chevronClassName:"prototype_destination_dropdown--chevron--pmWtI",inputClassName:"prototype_destination_dropdown--input--rzglN",dropdownWidth:lz.DxS,property:c,formatter:t,onChange:e.onChange,dispatch:e.dispatch,dropdownShown:e.dropdownShown,recordingKey:oE.Pt(e,"select"),willShowDropdown:()=>{let t=i.baT.ALL;"SCROLL_TO"===e.action?t=i.baT.SCROLL_TO:"SWAP_STATE_TO"===e.action?t=i.baT.STATES:"NAVIGATE_TO"===e.action&&s&&(t=i.baT.RESPONSIVE_SETS);let{viableIds:n,disabledIds:o}=i.X3B.getTransitionDestinationsOnActiveCanvas(t);return a(n),r(o),Promise.resolve()},onOptionFocus:e=>{eP.Uc(e??"")},hideDropdownWhenContainerMoves:!(0,oF.nl)()},u||null,0!==l.length&&0!==d.length&&o.createElement(oG.sK,null),p))}let rg=o.memo(function(e){let t=(0,eg.tS)(),n=(0,eg._G)(),a=(0,l.d4)(ry),r=(0,l.d4)(rc.Sh),s=(0,l.d4)(rc.dK),c=(0,rd.D)(r,s),d=(0,l.d4)(rf),m=o.useMemo(()=>(0,ru.cP)(d,t,n,e.actionIndexPath),[d,t,n,e.actionIndexPath]),u=o.useMemo(()=>(0,ru.cP)(a,t,n),[a,t,n]),p=m||u;if(!p||p.mode!==i.iCO.STATE_OR_STATE_INSTANCE_SUBLAYER)return null;let{allStates:_,stateGroupModel:E,selectedStates:g,selectedStatesPropertyValues:y}=p,f=E.propertySortOrder||[],v=E.propertyValues;return v?o.createElement(rm.lS,{sortedProperties:f,stateGroupPropertyValues:v,selectedStatesPropertyValues:y,selectedStates:g,allStates:_,onSelectProperty:t=>{let n={};for(let e of Object.keys(t)){let a=t[e].symbol.node_id;for(let t of(n[e]=a,c[e]||[]))n[t]=a;for(let e of r)n[e]||(n[e]=a)}e.onChange(n)},recordingKey:e.recordingKey,hideErrorsPanel:!0,shouldIndent:!0,extended:!0}):null});function ry(e){return e.mirror.selectionProperties.stateGroupSelectionInfo}function rf(e){return e.mirror.selectionProperties.prototypeDestinationStateGroupSelectionInfo}var rv=n(516729),rh=n(902441),rN=n(56394),rb=n(675097),rT=n(444769),rA=n(991944);let rI="prototype_set_variable_controls--dropdownAndIconContainer--6m3Tw",rS="prototype_set_variable_controls--icon---HzDt",rC="prototype_set_variable_controls--placeholderText--PBIqf";function rO({targetVariableData:e,targetVariable:t,updateSelectionProperties:n,autoOpenVariablePicker:a,...r}){let c=o.useRef(null),m=(0,l.wA)(),u=(0,e$.GS)(),p=(0,l.d4)(e=>e.variablePickerShown),_=(0,nT.tZ)((0,oN.hS)(t)&&"id"in t?t.id:void 0),E=(0,nT.u)((0,oN.hS)(t)&&"id"in t?t.id:void 0),[y,f]=o.useState("");(0,g.h)(()=>{a&&!0===a.current&&(h(),a.current=!1)});let v=(0,nT.BQ)((0,oN.hS)(t)&&"id"in t?t.id:void 0)??(0,oQ.m9)((0,oN.hS)(t)&&"nodeFieldAlias"in t?t.nodeFieldAlias:void 0);o.useEffect(()=>{void 0!==e&&v&&"MIXED"!==v&&(0,oN.hS)(e)&&e.resolvedType!==v.resolvedType&&!((0,oQ.tz)(e.resolvedType)&&(0,oQ.tz)(v.resolvedType))&&n({targetVariableData:void 0})},[v,n,e]);let h=()=>{let e=c.current.getBoundingClientRect();m((0,rv.C)({type:"variable-picker-set-variable-action",isShown:!0,resolvedType:i.rXF.STRING,initialPosition:new tY.Mi(e.left-20,e.top),key:r.recordingKey,onVariableSelected:A}))},N=o.useCallback(()=>{m((0,rv.B)())},[m]),[b,T]=o.useState(!1),A=o.useCallback(t=>{if(void 0!==t&&t.node_id){let a={targetVariable:{id:t.node_id}},o=i.CWU.getVariableResolvedValue(t.node_id,new Map);!e&&t.resolvedType===i.rXF.COLOR&&o&&(a.targetVariableData=o??void 0),n(a),m((0,ob.Zh)({name:"prototype.variable_selected",params:{collectionId:t.variableSetId,variableId:t.node_id,variableType:t.resolvedType}})),T(!0)}},[m,e,n]),I=o.useCallback(e=>{e.value.stablePath.map(e=>op.sH(e))&&(n({targetVariable:{nodeFieldAlias:{stablePathToNode:e.value.stablePath,nodeField:"COMPONENT_PROP_ASSIGNMENTS",indexOrKey:e.value.explicitDefId}}}),T(!0))},[n]),S=o.useMemo(()=>({type:"LOCAL_VARIABLES",layout:"list"}),[]),C=o.useRef(null);o.useEffect(()=>{let e=i.Ez5.prototypingEditorState().colorPickerEyedropperVarData;return(0,eM.lu)(e,{onChangeImmediate(){let t=e.getCopy();t&&n({targetVariableData:t})}})},[n]);let O="nodeFieldAlias"in t?(0,oQ.aA)(t.nodeFieldAlias.stablePathToNode,t.nodeFieldAlias.indexOrKey):void 0,P=O?(0,oQ.Xx)(O.varValue.resolvedType):null,w=null;if((0,oN.gl)(t))w=null;else if(v?.resolvedType===i.rXF.COLOR)w=(0,oN.gl)(e)?o.createElement("div",{className:"prototype_set_variable_controls--targetVariableDataMixedContainer--H6uGu"},(0,d.t)("fullscreen.mixed")):o.createElement(o.Fragment,null,o.createElement(rT.gJ,{variableValue:e??v,onChange:e=>{n({targetVariableData:e})},recordingKey:oE.Pt(r.recordingKey,"variableValueInput"),setVariableAction:!0,innerContainerClassName:"prototype_set_variable_controls--variableColorInputContainer--NaOmp"}));else{let t=r.isNestedInConditional?"prototype_set_variable_controls--absoluteIconInConditional--BbEmW":"prototype_set_variable_controls--absoluteIcon--1XpBF",a=i.rXF.BOOLEAN;E?a=E.resolvedType:O&&(a=O.varValue.resolvedType===i.rXF.TEXT_DATA?i.rXF.STRING:O.varValue.resolvedType),w=o.createElement("div",{className:u?void 0:en.s.ml12.$},o.createElement("div",{className:rI},o.createElement(oI.KN,{resolvedType:a,targetVariableData:e,autoOpenExpressionBuilder:b,setAutoOpenExpressionBuilder:T,updateSelectionProperties:n,recordingKey:r.recordingKey,isNarrowPanel:r.isNarrowPanel,showVariableThumbnails:!0}),!u&&o.createElement(ox.B,{className:e1()(rS,t),svg:ro.default})))}let x=e1()({"prototype_set_variable_controls--targetVariableDropdown--IZwoF":!u&&!r.isNarrowPanel,"prototype_set_variable_controls--targetVariableDropdownNarrow--WWi-t prototype_set_variable_controls--targetVariableDropdown--IZwoF":!u&&r.isNarrowPanel,"prototype_set_variable_controls--targetVariableDropdownUI3--Pz71q":u,[rC]:u&&!(_||O)}),k=(0,l.d4)(o$.ZM),D=(0,s.kc)().ds_variable_props_unified_ui&&k?(0,d.t)("proto.select_variable_unified"):u?(0,d.t)("proto.select_variable.short"):(0,d.t)("proto.select_variable"),M=o.createElement(t5.D8,{recordingKey:oE.Pt(r.recordingKey,"selectTargetVariable"),onClick:h},o.createElement("div",{className:u?void 0:(0,oN.hS)(t)?"prototype_set_variable_controls--targetVariableLabel--AFCqK":"prototype_set_variable_controls--targetVariableLabelInactive--zHWCC prototype_set_variable_controls--targetVariableLabel--AFCqK",ref:c},o.createElement(oP.Y,null,o.createElement("div",{className:x},o.createElement("div",{className:rI},(0,oN.gl)(t)?o.createElement("div",{className:e1()(en.s.pt2.$,en.s.pb2.$)},(0,d.t)("fullscreen.mixed")):_?o.createElement(o2.wG,{text:_,thumbnailValue:v,isDeleted:!!E&&(0,o1.eF)(E)}):O?o.createElement(o2.wG,{text:O.name,thumbnailValue:P,isDeleted:!1,colorTheme:o2.J2.COMPONENT}):o.createElement("div",{className:e1()(en.s.pt2.$,en.s.pb2.$,u?"prototype_set_variable_controls--placeholderTextColorUI3--Pc-4N":void 0)},D),!u&&o.createElement(ox.B,{className:rS,svg:ro.default})))))),R=u?o.createElement(lm.cS,{input:M,label:(0,s.kc)().ds_variable_props_unified_ui?(0,d.tx)("proto.target"):(0,d.tx)("proto.variable")}):M,L=e1()({"prototype_set_variable_controls--setVariableToContainerNarrow--HHbHQ prototype_set_variable_controls--setVariableToContainer--kxsCZ":!u&&r.isNarrowPanel,"prototype_set_variable_controls--setVariableToContainer--kxsCZ":!u&&!r.isNarrowPanel,"prototype_set_variable_controls--setVariableToContainerUI3--pGbDe":u,[rC]:u&&!e&&v?.resolvedType!==i.rXF.COLOR}),V=o.createElement("div",{className:L,"data-testid":"set-variable-container"},w),U=u?null!==w?o.createElement(lm.cS,{label:(0,d.tx)("proto.variable.value"),input:V}):null:V;return o.createElement("div",{className:u?void 0:en.s.relative.$},R,p.isShown&&"variable-picker-set-variable-action"===p.type&&p.key===r.recordingKey?o.createElement(o.Fragment,null,o.createElement(rA.vx,{title:"",headerSize:"hidden",initialPosition:p.initialPosition,onClose:N,dragHeaderOnly:!1,initialWidth:216,canRenderBelowViewport:!0},o.createElement(rb.YK,{selectedItem:E,disabledVariableIds:new Set,currentView:S,pickerType:"set-variable",onVariableSelected:A,onClose:N,recordingKey:oE.Pt(r.recordingKey,"variablePickerForSelection"),searchQuery:y,onSearchInputChange:f,onComponentPropSelected:(0,s.kc)().ds_variable_props_proto?I:void 0,searchInputRef:C,renderSetControls:()=>o.createElement(rN.Z,{currentView:S,subscribedLibraries:[],setControlRightButtons:o.createElement(rh.f,{resolvedTypes:[i.rXF.BOOLEAN,i.rXF.STRING,i.rXF.FLOAT,i.rXF.COLOR]}),recordingKey:oE.Pt(r.recordingKey,"variablePickerForSelection")})})),o.createElement(rb.$3,{onClose:N})):null,U)}var rP=n(777885),rw=n(538887),rx=n(453956),rk=n(726084),rD=n(597071);let rM=(0,ok.ex)("prototype_state_management_info",function(){let e=o.createElement(X.N,{newTab:!0,href:"https://help.figma.com/hc/articles/14397859494295",htmlAttributes:{rel:"noopener noreferrer",onMouseDown:e=>{e.stopPropagation(),e.preventDefault()}}},(0,d.tx)("proto.state_management.info_tooltip_learn_more")),t=o.createElement("span",null,o.createElement("strong",null,(0,d.tx)("proto.animation_panel.preserve_scroll_position")));return o.createElement("div",{className:"prototype_state_management_info_tooltip--stateManagementMoreInfo---gER1 tooltip--text--Ll1mS"},(0,d.tx)("proto.state_management.info_tooltip",{PreserveScrollPositionBold:t,LearnMoreLink:e}))}),rR="prototype_state_management_panel--checkboxRow--2u02e checkbox--_checkboxRow--oEhow",rL="prototype_state_management_panel--expandCaret--uuDge";var rV=n(949207),rU=n(432023);function rK({transition:e,navigationType:t,recordingKey:n,showPreserveScrollPosition:a,showResetVideoState:r,showResetInteractiveComponentState:i,updateSelectionProperties:s,stateManagementVersion:c,selectedInteractions:m}){let u=(0,l.wA)(),p=(0,e$.GS)(),[_,E]=o.useState(!p),g=(0,lx.Em)(),y=o.useContext(o0.c);if((0,oC.YT)()===oC.Oz.TWO_COL&&y===o0.P.LEFT)return null;let f=(0,oC.LH)(c),v=o.createElement(lM.S,{onChange:t=>{u((0,ob._P)({name:"Preserve Scroll Changed",params:{newValue:t}})),s({...function(e){if((0,oN.hS)(e.preserveScroll))return{transitionPreserveScroll:e.preserveScroll}}({...e,preserveScroll:t})})},checked:!0===e.preserveScroll,mixed:(0,oN.gl)(e.preserveScroll),recordingKey:oE.Pt(n,"preserve-scroll-check"),label:o.createElement(lR.J,null,(0,d.tx)("proto.animation_panel.preserve_scroll_position"))}),h=p?o.createElement(lm.TN,null,v):o.createElement(ow.fI,{className:rR},v),N=o.createElement(lM.S,{onChange:t=>{u((0,ob._P)({name:"Reset Scroll Position Changed",params:{newValue:t,noodleUpgradedThisSession:rD.zZ.haveAnyInteractionsBeenUpgraded(m)}})),s({...function(e){if((0,oN.hS)(e.resetScrollPosition))return{transitionResetScrollPosition:e.resetScrollPosition}}({...e,resetScrollPosition:t})})},checked:!0===e.resetScrollPosition,mixed:(0,oN.gl)(e.resetScrollPosition),recordingKey:oE.Pt(n,"reset-scroll-position-check"),label:o.createElement(lR.J,null,(0,d.tx)("proto.animation_panel.reset_scroll_position"))}),b=o.createElement("div",{"data-tooltip-type":as.Ib.SPECIAL,"data-tooltip":rM,"data-tooltip-interactive":!0,"data-tooltip-show-immediately":!0,"data-tooltip-max-width":240,className:p?"prototype_state_management_panel--stateManagementPanelTooltipUI3--x5MQ3":void 0},o.createElement(rk.In,{icon:"info-16"})),T=p?o.createElement(lm.TN,null,N," ",g&&b):o.createElement(ow.fI,{className:rR},N),A=o.createElement(lM.S,{onChange:t=>{u((0,ob._P)({name:"Reset Component State Changed",params:{newValue:t,noodleUpgradedThisSession:rD.zZ.haveAnyInteractionsBeenUpgraded(m)}})),s({...function(e){if((0,oN.hS)(e.resetInteractiveComponents))return{transitionResetInteractiveComponents:e.resetInteractiveComponents}}({...e,resetInteractiveComponents:t})})},checked:!0===e.resetInteractiveComponents,mixed:(0,oN.gl)(e.resetInteractiveComponents),recordingKey:oE.Pt(n,"reset-component-state-check"),label:o.createElement(lR.J,null,(0,d.tx)("proto.animation_panel.reset_component_state"))}),I=p?o.createElement(lm.TN,null,A):o.createElement(ow.fI,{className:rR},A),S=o.createElement(lM.S,{onChange:t=>{u((0,ob._P)({name:"Reset Video Position Changed",params:{newValue:t}})),s({...function(e){if((0,oN.hS)(e.resetVideoPosition))return{transitionResetVideoPosition:e.resetVideoPosition}}({...e,resetVideoPosition:t})})},checked:!0===e.resetVideoPosition,mixed:(0,oN.gl)(e.resetVideoPosition),recordingKey:oE.Pt(n,"reset-video-position-check"),label:o.createElement(lR.J,null,(0,oC.LH)(c)?(0,d.tx)("proto.state_management.reset_video_state"):(0,d.tx)("proto.animation_panel.reset_video_state"))}),C=p?o.createElement(lm.TN,null,S):o.createElement(ow.fI,{className:rR},S),O=o.createElement(ow.Zk,{className:`prototype_state_management_panel--stateManagementPanel--sYaaj ${(0,oC.kM)(c)&&"prototype_state_management_panel--stateManagementPanelWithVersion--AovOP"}`},!p&&o.createElement(ow.fI,null,o.createElement(ow.xw,{className:"prototype_state_management_panel--panelTitle--Nr4Eh",faded:!0},(0,d.tx)("proto.state_management")),!(0,oC.kM)(c)&&b),(0,oC.uU)(c)&&a&&h,r&&(0,oC.uU)(c)&&C,f&&T,f&&i&&I,f&&r&&C,(0,oN.gl)(c)&&o.createElement(oP.Y,{direction:"horizontal",padding:{horizontal:12,vertical:12}},o.createElement(ow.UZ,null,(0,d.tx)("proto.state_management.mixed_state_update")))),P=o.createElement(of.U,{svg:_?rV.A:rU.A},_?o.createElement(rP.O,{className:rL}):o.createElement(rw.k,{className:rL})),w=o.createElement(t2.E,{key:"expand-caret",recordingKey:oE.Pt(n,"expand-caret"),onClick:()=>{E(!_)},actionOnPointerDown:!0,className:"prototype_state_management_panel--expandRow--RVDCp"},P,o.createElement("span",null,(0,d.tx)("proto.state")));return o.createElement(rx.k,{name:"prototype_state_management_panel"},p&&w,(_||!p)&&O)}let rB=oG.c$,rF=oG.l6,rz=op.AD;class r$ extends oV.cP{format(e){return e===rz||null===e?(0,d.t)("proto.target_video_node_name_formatter.this_video"):super.format(e)}}function rG(e){let{viableSameFrameVideoIds:t,disabledSameFrameVideoIds:n,scene:a,dropdownShown:r,targetVideoNodeID:i,isVideoSelected:s,onChange:c}=e,m=(0,l.wA)(),[u,p]=o.useState(()=>s?new r$(a):new oV.cP(a));t.sort((e,t)=>{let n=u.format(e),a=u.format(t);return n.localeCompare(a)}),s&&t.unshift(rz);let _=t.length>0&&n.length>0,E=`prototype-target-video-select-${e.recordingKey}`,g=(0,e$.GS)(),y=o.createElement(rF,{id:E,dataTestId:"target-video-select",className:"prototype_target_video_dropdown--targetVideoDropdown--6hKF-",chevronClassName:"prototype_target_video_dropdown--chevron--jgz53",inputClassName:"prototype_target_video_dropdown--input--infAK",property:(0,oN.gl)(i)?i:op.dI(i),formatter:u,onChange:c,dispatch:m,dropdownShown:r,recordingKey:oE.Pt(e,"select"),onOptionFocus:e=>{eP.Uc(e??"")},dropdownAlignment:"left"},t.filter(e=>u.hasNameForNode(e)).map((t,n)=>o.createElement(rB,{key:`enabled-${n}`,value:t,recordingKey:oE.Pt(e,`viable-option-${n}`),disabled:!1})),_&&o.createElement(oG.sK,null),n.filter(e=>u.hasNameForNode(e)).map((t,n)=>o.createElement(rB,{key:`disabled-${n}`,value:t,recordingKey:oE.Pt(e,`viable-option-${n}`),disabled:!0})));return g?o.createElement(lm.cS,{input:y,label:(0,d.tx)("proto.video_dropdown.label")}):y}var rW=n(621847);function rH({action:e,recordingKey:t,onURLChange:n,onOpenInNewTabChange:a}){let l=(0,e$.GS)(),r=o.createElement(rW.ks,{className:l?"prototype_open_url_action_options--urlInputUI3--H-JfT":"prototype_open_url_action_options--urlInput--T-tGT",dataTestId:"url-input",placeholder:(0,d.t)("proto.interaction.example_com"),value:(0,oN.gl)(e.connectionURL)?(0,d.t)("fullscreen.mixed"):(0,oN._W)(e.connectionURL,""),onChange:n,recordingKey:oE.Pt(t,"urlTextInput"),autoFocus:!1}),i=o.createElement(lM.S,{label:o.createElement(lR.J,null,(0,d.tx)("proto.action_open_url_in_new_tab")),onChange:a,recordingKey:oE.Pt(t,"open-url-in-new-tab-check"),checked:void 0===e.openUrlInNewTab||!0===e.openUrlInNewTab});return o.createElement(o.Fragment,null,l?o.createElement(lm.cS,{label:(0,d.tx)("proto.open_url.text_input_label"),input:r}):r,l?o.createElement(lm.TN,null,i):o.createElement(ow.fI,{className:"prototype_open_url_action_options--checkboxRow--mu17T checkbox--_checkboxRow--oEhow"},i))}var rY=n(509343),rX=n(588599);function rj({updateSelectionProperties:e,action:t,extraScrollOffset:n,showScrollToOptions:a,recordingKey:r}){let{smallNudgeAmount:i,bigNudgeAmount:s}=(0,rY.sT)(),c=(0,l.wA)(),m=(0,e$.GS)(),u=(t,n)=>(a,o)=>{t&&e({extraScrollOffset:{...t,[n]:a}},{shouldCommit:o})},p=(0,oN._W)(n,{x:0,y:0});if(!a||"SCROLL_TO"!==t)return null;let _=o.createElement(lU.gq,{className:m?void 0:o8.U,inputClassName:m?o8.oM:o8.hF,value:p.y,wheelMultiplier:i,scrubMultiplier:i,smallNudgeAmount:i,bigNudgeAmount:s,onValueChange:u(p,"y"),dispatch:c,"data-tooltip-type":as.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.y_offset"),tooltipForScreenReadersOnly:!1,recordingKey:oE.Pt(r,"extraScrollOffsetY")},m?o.createElement("span",{className:o8.QK},(0,d.tx)("proto.scroll_options.scroll_offset.y")):o.createElement(ox.B,{className:o8.QK,svg:rX.A})),E=o.createElement(lU.gq,{className:m?void 0:o8.sC,inputClassName:m?o8.oM:o8.hF,value:p.x,wheelMultiplier:i,scrubMultiplier:i,smallNudgeAmount:i,bigNudgeAmount:s,onValueChange:u(p,"x"),dispatch:c,"data-tooltip-type":as.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.x_offset"),tooltipForScreenReadersOnly:!1,recordingKey:oE.Pt(r,"extraScrollOffsetX")},m?o.createElement("span",{className:o8.QK},(0,d.tx)("proto.scroll_options.scroll_offset.x")):o.createElement(ox.B,{className:o8.Kh,svg:rX.A}));return m?o.createElement(lm.Cm,{label:(0,d.tx)("proto.scroll_options.offset"),leftInput:E,rightInput:_}):o.createElement(ow.fI,null,_,E)}let rJ=(0,o.memo)(function(e){return(0,a9.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,a9.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M18 12a6 6 0 1 1-12 0 6 6 0 0 1 12 0m1 0a7 7 0 1 1-14 0 7 7 0 0 1 14 0m-6.5-3.5a.5.5 0 0 0-1 0V12a.5.5 0 0 0 .146.354l2 2a.5.5 0 0 0 .708-.708L12.5 11.793z",clipRule:"evenodd"})})}),rq="prototype_video_action_options--chevron--mkNyv",rZ="prototype_video_action_options--input--3-cEi",rQ=new oV.js,r0=new oV.Z6;function r1({action:e,onChange:t,updateSelectionProperties:n,dropdownShown:a,recordingKey:r}){let i=(0,e$.GS)(),s=(0,oV.Od)(e),c=(0,oN.E7)(e.mediaAction),m="UPDATE_MEDIA_RUNTIME"===(0,oN.E7)(e.connectionType),u="SKIP_TO"===c,p="SKIP_FORWARD"===c||"SKIP_BACKWARD"===c,_="PLAY"===c||"PAUSE"===c||"TOGGLE_PLAY_PAUSE"===c,E="MUTE"===c||"UNMUTE"===c||"TOGGLE_MUTE_UNMUTE"===c,g=(0,l.wA)(),y=(0,rY.RU)(),f=o.useCallback(e=>{n({mediaSkipToTime:e}),g((0,ob._P)({name:"Media skip to time changed",params:{value:e}}))},[g,n]),v=`prototype-media-action-select-${r}`,h="prototype_video_action_options--shortDropdown--NOXXv",N=a&&a.type===v?rQ:r0,b=o.createElement(oY,{id:v,dataTestId:"media-play-pause-select",className:h,chevronClassName:rq,inputClassName:rZ,property:s,formatter:N,onChange:t,dispatch:g,dropdownShown:a,recordingKey:oE.Pt(r,"select")},o.createElement(oH,{key:"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE",value:"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE",recordingKey:oE.Pt(r,"toggle-play-pause-option"),disabled:!1}),o.createElement(oH,{key:"UPDATE_MEDIA_PLAY",value:"UPDATE_MEDIA_PLAY",recordingKey:oE.Pt(r,"play-option"),disabled:!1}),o.createElement(oH,{key:"UPDATE_MEDIA_PAUSE",value:"UPDATE_MEDIA_PAUSE",recordingKey:oE.Pt(r,"pause-option"),disabled:!1})),T=o.createElement(oY,{id:v,dataTestId:"media-mute-unmute-select",className:h,chevronClassName:rq,inputClassName:rZ,property:s,formatter:N,onChange:t,dispatch:g,dropdownShown:a,recordingKey:oE.Pt(r,"select")},o.createElement(oH,{key:"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE",value:"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE",recordingKey:oE.Pt(r,"toggle-mute-unmute-option"),disabled:!1}),o.createElement(oH,{key:"UPDATE_MEDIA_MUTE",value:"UPDATE_MEDIA_MUTE",recordingKey:oE.Pt(r,"mute-option"),disabled:!1}),o.createElement(oH,{key:"UPDATE_MEDIA_UNMUTE",value:"UPDATE_MEDIA_UNMUTE",recordingKey:oE.Pt(r,"unmute-option"),disabled:!1})),A=o.createElement(oY,{id:v,dataTestId:"media-skip-by-select",className:h,chevronClassName:rq,inputClassName:rZ,property:s,formatter:N,onChange:t,dispatch:g,dropdownShown:a,recordingKey:oE.Pt(r,"select"),dropdownWidth:160},o.createElement(oH,{key:"UPDATE_MEDIA_SKIP_FORWARD",value:"UPDATE_MEDIA_SKIP_FORWARD",recordingKey:oE.Pt(r,"skip-forward-option"),disabled:!1}),o.createElement(oH,{key:"UPDATE_MEDIA_SKIP_BACKWARD",value:"UPDATE_MEDIA_SKIP_BACKWARD",recordingKey:oE.Pt(r,"skip-backward-option"),disabled:!1})),I=o.createElement(lU.qd,{className:"prototype_video_action_options--timestampContainer---DdaI",inputClassName:"prototype_video_action_options--timestamp--luOrs",dataTestId:"mediaSkipToTime-input",dispatch:g,value:e.mediaSkipToTime||0,onValueChange:f,wheelMultiplier:y/1e3,scrubMultiplier:y/1e3,max:3600,displayFractions:!0,"data-tooltip-type":as.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.timestamp_to_set_to"),tooltipForScreenReadersOnly:!0,recordingKey:oE.Pt(r,"mediaSkipToTimeInput")},i?o.createElement(rJ,null):void 0),S="SKIP_BACKWARD"===c?(0,d.t)("proto.trigger.duration_to_jump_backward"):(0,d.t)("proto.trigger.duration_to_jump_forward"),C=o.createElement(lU.dE,{className:"prototype_video_action_options--timeAmountContainer--5kpHn",dataTestId:"mediaSkipByAmount-input",dispatch:g,value:e.mediaSkipByAmount||5,onValueChange:e=>{n({mediaSkipByAmount:e}),g((0,ob._P)({name:"Media skip by amount changed",params:{value:e}}))},wheelMultiplier:y/1e3,scrubMultiplier:y/1e3,max:3600,"data-tooltip-type":as.Ib.TEXT,"data-tooltip":S,tooltipForScreenReadersOnly:!0,recordingKey:oE.Pt(r,"mediaSkipByAmountInput")});if(!m)return null;if(i){if(_)return o.createElement(lm.cS,{input:b,label:(0,d.tx)("proto.video_options.behavior")});if(E)return o.createElement(lm.cS,{input:T,label:(0,d.tx)("proto.video_options.behavior")});if(p)return o.createElement(o.Fragment,null,o.createElement(lm.cS,{input:A,label:(0,d.tx)("proto.video_options.direction")}),o.createElement(lm.cS,{input:C,label:(0,d.tx)("proto.video_options.offset")}));if(u)return o.createElement(lm.cS,{input:I,label:(0,d.tx)("proto.video_options.timestamp")})}return o.createElement(ow.fI,null,_&&b,E&&T,p&&A,p&&C,u&&I)}var r2=n(310618);function r8({action:e,recordingKey:t,interactionType:n,onActionChange:a,updateMultipleDestinationNodes:r,updateSelectionProperties:s,stateManagementVersion:c,autoOpenVariablePicker:m,autoOpenExpressionBuilder:u,setAutoOpenExpressionBuilder:p,..._}){let E=(0,l.wA)(),g=(0,oU.Um)(),{scene:y}=(0,lw.R)(e=>({scene:e.mirror.sceneGraph})),f=(0,e$.GS)(),v=(0,lx.cJ)(),h=(0,oC.YT)(),N=h===oC.Oz.SINGLE_COL,b=h===oC.Oz.TWO_COL,T=o.useContext(o0.c),A=b&&T===o0.P.RIGHT,I="SET_VARIABLE"===(0,oN.E7)(e.connectionType),S="SET_VARIABLE_MODE"===(0,oN.E7)(e.connectionType),C="CONDITIONAL"===(0,oN.E7)(e.connectionType),O="INTERNAL_NODE"===(0,oN.E7)(e.connectionType),P="INTERNAL_NODE"===(0,oN.E7)(e.connectionType)&&"SWAP_STATE"===(0,oN.E7)(e.navigationType),w="URL"===(0,oN.E7)(e.connectionType),x=O||"BACK"===(0,oN.E7)(e.connectionType)||"CLOSE"===(0,oN.E7)(e.connectionType),k="UPDATE_MEDIA_RUNTIME"===(0,oN.E7)(e.connectionType),D=(0,l.d4)(e=>{let t=e.mirror.selectionProperties.numSelected,n=e.mirror.selectionProperties.numVideosSelected;return 1===t&&!!n}),M=(0,lD.uQ)(),R=[],L=[];if(M){let{viableIds:e,disabledIds:t}=i.X3B.getVideoNodesOnSameTlfAsNode(M);R=e,L=t}let V=op.dI((0,oN.E7)(e.transitionNodeID)),U=null!=V&&V!==op.AD,K=O&&(!(0,oN.hS)(e.transitionNodeID)||U)&&!(v&&!P),B=(0,oN.E7)(e.navigationType),F=O&&"OVERLAY"===(0,oN.E7)(B),z=(0,oC.hU)(e.transitionType,e.easingType,e.easingFunction,e.transitionDuration,e.transitionShouldSmartAnimate,e.transitionPreserveScroll,e.transitionResetVideoPosition,e.openUrlInNewTab,e.transitionResetScrollPosition,e.transitionResetInteractiveComponents),$=x&&!F&&("INSTANT"===z.behavior||"DISSOLVE"===z.behavior),G=O&&"OVERLAY"===(0,oN.E7)(e.navigationType)&&U,W=O&&(F||"SWAP"===(0,oN.E7)(B)),H=!k&&(0,oC.oc)(e),Y=(0,oC.GB)(e),X=(0,oC.uU)(c)?$||H:(0,oC.Fp)(c,e.connectionType,e.navigationType),{selectedInteractions:j}=(0,r2.Ay)(lk.J.NORMAL),J=j.filter(e=>!!e.sourceNodeID&&!!e.id).map(e=>o_.d({nodeID:e.sourceNodeID,interactionID:e.id})),q=o.useCallback(e=>{let t=op.sH(e);t&&s({transitionNodeID:t}),E((0,ob._P)({name:"Prototype navigation destination changed",params:{source:"panel",connectorIds:JSON.stringify(J),destinationTlfId:e}}))},[E,s,J]),Z=o.useCallback(e=>{r(e),E((0,ob._P)({name:"Variant based prototyping UI changed",params:{source:"panel"}})),E((0,ob._P)({name:"Prototype navigation destination changed",params:{source:"panel",connectorIds:JSON.stringify(J)}}))},[r,E,J]),Q=o.useCallback(e=>{s({connectionURL:e.target.value})},[s]),ee=(0,oV.Od)(e),et=e1()({[o8.Ph]:!f,[o8.Ti]:_.isNestedInConditional&&!N&&!A}),ea=O&&!P,eo=o.createElement(rE,{className:o8.iR,dispatch:E,dropdownShown:g,onChange:q,nodeId:e.transitionNodeID||op.Hr,scene:y,recordingKey:oE.Pt(t,"destinationDropdown"),action:ee,isUI3:f}),el=o.createElement(rj,{action:ee,showScrollToOptions:"SCROLL_TO"===ee,extraScrollOffset:e.extraScrollOffset,updateSelectionProperties:s,recordingKey:oE.Pt(t,"scrollOptionsPanel")}),er=o.createElement(lX,{interactionType:n,updateSelectionProperties:s,recordingKey:oE.Pt(t,"overlaySettings"),actionIndexPath:_.actionIndexPath,nodeId:e.transitionNodeID||op.Hr});return o.createElement("div",{className:et},ea&&(f?o.createElement(o.Fragment,null,o.createElement(lm.cS,{label:W?(0,d.tx)("proto.overlay"):(0,d.tx)("proto.destination"),input:eo}),el,G&&er):eo),w&&o.createElement(rH,{action:e,recordingKey:t,onOpenInNewTabChange:e=>{s({openUrlInNewTab:e}),E((0,ob._P)({name:"Open Url In New Tab Changed",params:{value:e}}))},onURLChange:Q}),k&&o.createElement(rG,{dropdownShown:g,scene:y,targetVideoNodeID:e.transitionNodeID||op.Hr,recordingKey:oE.Pt(t,"targetVideoDropdown"),viableSameFrameVideoIds:R,disabledSameFrameVideoIds:L,isVideoSelected:D,onChange:q}),o.createElement(r1,{dropdownShown:g,action:e,onChange:a,updateSelectionProperties:s,recordingKey:t}),!f&&el,I&&o.createElement("div",{className:f?void 0:en.s.ml4.$},o.createElement(rO,{className:o8.PB,dispatch:E,onChange:q,nodeId:e.transitionNodeID||op.Hr,targetVariable:e.targetVariable||{id:""},targetVariableData:e.targetVariableData,updateSelectionProperties:s,recordingKey:oE.Pt(t,"setVariableControls"),action:ee,isNestedInConditional:_.isNestedInConditional,isNarrowPanel:_.isNestedInConditional||_.isNarrowPanel,autoOpenVariablePicker:m})),S&&o.createElement("div",{className:f?void 0:en.s.ml4.$},o.createElement(lb,{dispatch:E,targetVariableSetID:e.targetVariableSetID,targetVariableModeID:e.targetVariableModeID,deprecatedTargetVariableSetKey:e.targetVariableSetKey,updateSelectionProperties:s,recordingKey:oE.Pt(t,"setVariableControls"),actionIndexPath:_.actionIndexPath.join(",")})),C&&(A?o.createElement(rs,{recordingKey:oE.Pt(t,"conditionalActionSection","conditional-block",0),autoOpenExpressionBuilder:u,setAutoOpenExpressionBuilder:p,updateSelectionProperties:s,conditionalActions:(0,oN.hS)(e.conditionalActions)&&e.conditionalActions?e.conditionalActions:[]}):o.createElement(ri,{updateSelectionProperties:s,recordingKey:oE.Pt(t,"conditionalActionSection"),action:e,updateMultipleDestinationNodes:r,interactionType:n,stateManagementVersion:c,selectedInteractions:_.selectedInteractions,actionIndexPath:_.actionIndexPath,onDrop:_.onDrop,onSelect:_.onSelect,onExpand:_.onExpand,onNewActionAdded:_.onNewActionAdded,selectedActionIndex:_.selectedActionIndex,expandedRows:_.expandedRows,autoOpenVariablePicker:m,handleMouseDownUI3:_.handleMouseDownUI3})),P&&o.createElement("div",{className:en.s.ml0.$},o.createElement(rg,{onChange:Z,nodeId:e.transitionNodeID||op.Hr,recordingKey:oE.Pt(t,"consumption"),actionIndexPath:_.actionIndexPath})),K&&o.createElement(o.Fragment,null,f&&o.createElement("div",{className:o8.x}),o.createElement(l2.X7,{transition:z,interactionType:n,navigationType:e.navigationType,recordingKey:oE.Pt(t,"animationPanel"),updateSelectionProperties:s,isNarrowPanel:_.isNestedInConditional||_.isNarrowPanel,stateManagementVersion:c})),G&&!f&&er,X&&o.createElement(o.Fragment,null,f&&o.createElement("div",{className:o8.x}),o.createElement(rK,{connectionType:e.connectionType,transition:z,navigationType:e.navigationType,recordingKey:oE.Pt(t,"stateManagementPanel"),updateSelectionProperties:s,showPreserveScrollPosition:$,showResetVideoState:!!H,showResetInteractiveComponentState:!!Y,stateManagementVersion:c,selectedInteractions:_.selectedInteractions})))}var r5=n(844398),r4=n(323110),r7=n(482725);let r3=Symbol("ACTION_ROW");function r6({updateMultipleDestinationNodes:e,updateSelectionProperties:t,onDeleteAction:n,stateManagementVersion:a,selectedInteractions:r,autoOpenVariablePicker:i,autoOpenExpressionBuilder:s,setAutoOpenExpressionBuilder:c,...m}){let u=(0,l.wA)(),{shouldShowAdvancedPrototypingPaywall:p,showAdvancedPrototypingVariablesModal:_,showAdvancedPrototypingConditionalActionsModal:E}=(0,oC.zt)(),g=(0,oU.Um)(),f=(0,oC.hP)(),{firstVariableSetMode:v,firstVariableSetID:h}=lN(),N=m.action,b=m.isNestedInConditional&&(0,l8.qQ)(m.action),T=!!N.connectionType&&"CONDITIONAL"===N.connectionType,A=(0,e$.GS)(),I=(0,oC.YT)(),S=I===oC.Oz.SINGLE_COL,C=I===oC.Oz.TWO_COL,O=o.useContext(o0.c),P=C&&O===o0.P.RIGHT,w=C&&O===o0.P.LEFT,x=!((0,oN.gl)(m.action)||["CLOSE","NONE"].includes(N.connectionType))&&!A;var k=m.selectedActionIndex.equals(m.actionIndexPath);let D=1===m.selectedActionIndex.path.length&&m.isNestedInConditional&&m.actionIndexPath[0]===m.selectedActionIndex.path[0];var M=void 0===m.expandedRows||void 0!==m.expandedRows.find(e=>e.equals(m.actionIndexPath));A&&(M=!!S||!w||T);let R=o.useCallback(()=>{(x||S)&&m.onExpand(m.actionIndexPath)},[x,S,m]),[L,V]=o.useState(!1);o.useEffect(()=>{if(T){let e=setTimeout(()=>{V(!0)},0);return()=>clearTimeout(e)}V(!0)},[T]);let U=T&&!M,K=T&&M,B=o.useRef(null),[F,z]=(0,y.useAtom)(oC.hV),{position:$,dragItem:G}=(0,oO.h4)(()=>({type:r3,element:B,item:m.action,dropPositionThreshold:K?.2:U?1/3:.5,getDeepestTargetOnly:!0,canDrag:!!w||!M,onDrop(e){m.onDrop(e),z(!0)}})),W=o.useMemo(()=>{let e=B.current;if(!e||!$||P)return;if(G&&"CONDITIONAL"===G.connectionType&&m.isNestedInConditional||(0,l8.qQ)(G)){z(!1);return}let t=b?oO.Nz.BEFORE:$;var n=void 0;let a=e.offsetParent?.firstElementChild?.scrollTop??0;return t===oO.Nz.BEFORE?n=e.offsetTop-a:t===oO.Nz.AFTER&&(n=e.offsetTop+e.offsetHeight-a),z(!0),n},[$,P,G,m.isNestedInConditional,b,z]),H=$&&T&&!M&&$===oO.Nz.INSIDE&&"CONDITIONAL"!==G.connectionType,Y=oE.rf(m.recordingKey,"mousedown",e=>{M||(k=!0,m.onSelect(m.actionIndexPath,!0))}),X=oE.rf(m.recordingKey,"mousedown",e=>{k=!1,m.onSelect(m.actionIndexPath,!1)}),j=oE.rf(m.recordingKey,"click",e=>{m.onSelect(m.actionIndexPath,!0)}),J=oE.rf(m.recordingKey,"mousedown",e=>{(0,l8.qQ)(m.action)||m.onSelect(m.actionIndexPath,!0)}),q=e=>{var n=!0,a=!1;switch(e){case"NONE":t({connectionType:"NONE"});break;case"NAVIGATE_TO":t({connectionType:"INTERNAL_NODE",navigationType:"NAVIGATE"});break;case"OPEN_OVERLAY":t({connectionType:"INTERNAL_NODE",navigationType:"OVERLAY"});break;case"SCROLL_TO":t({connectionType:"INTERNAL_NODE",navigationType:"SCROLL_TO"});break;case"SWAP_WITH":t({connectionType:"INTERNAL_NODE",navigationType:"SWAP"});break;case"SWAP_STATE_TO":t({connectionType:"INTERNAL_NODE",navigationType:"SWAP_STATE"});break;case"GO_BACK":t({connectionType:"BACK"});break;case"CLOSE_OVERLAY":t({connectionType:"CLOSE"});break;case"OPEN_URL":t({connectionType:"URL"});break;case"SET_VARIABLE":p?(n=!1,_()):(t({connectionType:"SET_VARIABLE"}),i.current=!0);break;case"SET_VARIABLE_MODE":p?(n=!1,_()):t({connectionType:"SET_VARIABLE_MODE",targetVariableSetID:h,targetVariableModeID:v});break;case"UPDATE_MEDIA_PLAY":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"PLAY"});break;case"UPDATE_MEDIA_PAUSE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"PAUSE"});break;case"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS":case"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"TOGGLE_PLAY_PAUSE"});break;case"UPDATE_MEDIA_MUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"MUTE"});break;case"UPDATE_MEDIA_UNMUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"UNMUTE"});break;case"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS":case"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"TOGGLE_MUTE_UNMUTE"});break;case"UPDATE_MEDIA_SKIP_BY_OPTIONS":case"UPDATE_MEDIA_SKIP_FORWARD":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_FORWARD"});break;case"UPDATE_MEDIA_SKIP_BACKWARD":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_BACKWARD"});break;case"UPDATE_MEDIA_SKIP_TO":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_TO"});break;case"CONDITIONAL":a=!0,p?(n=!1,E()):(t({connectionType:"CONDITIONAL"}),A&&c&&c(!0))}if(A||M||R(),C&&m.onExpand(m.actionIndexPath,a),n){let t=r.filter(e=>!!e.sourceNodeID&&!!e.id).map(e=>o_.d({nodeID:e.sourceNodeID,interactionID:e.id}));u((0,ob._P)({name:"Prototype action changed",params:{action:e,source:"panel",connectorIds:JSON.stringify(t)}}))}},Z=m.isNestedInConditional?o8.It:o8.ft,Q=e1()({[o8.wu]:!w,[o8.zX]:w&&F}),ee=o.createElement(of.U,{svg:r4.A},o.createElement(oR,{className:o8._2}));if(b&&m.onAddAction)return o.createElement("div",{className:w?o8.LW:void 0},W&&o.createElement("hr",{className:Z,style:{transform:`translateY(${W}px)`}}),w&&m.isNestedInConditional&&ee,o.createElement("div",{className:Q,ref:B},o.createElement(l9,{addButtonPressed:m.onAddAction,recordingKey:oE.Pt(m.recordingKey,"addAction"),isNestedInConditional:!0})));let et=(0,oV._X)(N),en="NONE"!==et,ea=(M||!en)&&!w,eo=m.numActions>1,el=(m.numActions>1||m.isNestedInConditional)&&!w,er=e1()({[o8.$l]:!0,[o8.KY]:w&&!m.isNestedInConditional,[o8.Iw]:w&&!m.isNestedInConditional&&F,[o8.DM]:w&&m.isNestedInConditional,[o8.vs]:w&&m.isNestedInConditional&&F,[o8.M9]:w&&m.isNestedInConditional&&D&&F,[o8.I_]:w&&T&&!k&&F,[o8.Cu]:k&&!A,[o8.PE]:k&&w&&!m.isNestedInConditional,[o8.Ze]:H,[o8.Op]:m.isNestedInConditional&&!A}),ei=e1()({[o8.rn]:!0,[o8.Gu]:w,[o8.Ti]:m.isNestedInConditional&&!A&&!P,[o8.Yo]:m.isNestedInConditional&&A&&!P}),es=o.createElement(ox.B,{key:"expand-caret",className:o8.GE,svg:M?rV.A:rU.A,recordingKey:oE.Pt(m.recordingKey,"expandCaret"),onClick:R}),ec=o.createElement(o6,{action:N,isNestedInConditional:m.isNestedInConditional,isNarrowPanel:m.isNarrowPanel&&eo,onClick:A?j:void 0}),ed=o.createElement(oj,{className:"NONE"===et||A?void 0:r5.fH,dispatch:u,dropdownShown:g,onChange:q,action:et,recordingKey:oE.Pt(m.recordingKey,"actionDropdown"),showVideoActions:f,isNestedInConditional:m.isNestedInConditional}),em=o.createElement(ow.K0,{className:A?o8.gG:o8.hH,onClick:n,"data-tooltip-type":as.Ib.TEXT,"data-tooltip":(0,d.t)("proto.prototype_panel.delete"),"aria-label":(0,d.t)("proto.prototype_panel.delete"),recordingKey:oE.Pt(m.recordingKey,"actionDeleteButton")},o.createElement(of.U,{svg:r7.A},o.createElement(om.O,null))),eu=o.createElement(ow.fI,{className:ei,onDoubleClick:R},x&&es,ea?o.createElement("span",{className:o8.P2},ed):ec,el&&em),ep=ea?ed:ec,e_=o.createElement(oL.S.div,{className:ei,onDoubleClick:R},x&&es,el?o.createElement(lP.DE,{appendedClassName:o8.Jw,label:null,input:ep,icon:em}):o.createElement(lP.Ad,{appendedClassName:o8.Jw,label:null,input:ep})),eE=(0,d.tx)("proto.action"),eg=o.createElement(oL.S.div,{className:ei},S||P?o.createElement(lm.cS,{label:eE,input:ep}):ep),ey=A?eg:e_,ef=e1()({[o8.Oe]:!0,[o8.h2]:k,[o8.Ob]:T});return o.createElement(oL.S.div,{className:er,ref:B,role:"button",tabIndex:0,onMouseDown:A?void 0:Y,onMouseUp:A?void 0:X},void 0!==W&&o.createElement("hr",{className:Z,style:{transform:`translateY(${W}px)`}}),w?o.createElement(oL.S.div,{className:ef,role:"button",tabIndex:0,onMouseDown:A?J:void 0},m.isNestedInConditional&&ee,ey):A?ey:eu,M&&L&&o.createElement(r8,{updateMultipleDestinationNodes:e,action:N,onActionChange:q,recordingKey:m.recordingKey,updateSelectionProperties:t,interactionType:m.interactionType,stateManagementVersion:a,selectedInteractions:r,isNestedInConditional:m.isNestedInConditional,isNarrowPanel:m.isNarrowPanel,actionIndexPath:m.actionIndexPath,onDrop:m.onDrop,onSelect:m.onSelect,onExpand:m.onExpand,onNewActionAdded:m.onNewActionAdded,selectedActionIndex:m.selectedActionIndex,expandedRows:m.expandedRows,autoOpenVariablePicker:i,autoOpenExpressionBuilder:s,setAutoOpenExpressionBuilder:c,handleMouseDownUI3:J}))}var r9=n(522706),ie=n(946829),it=n(991995);function ia({onChange:e,value:t,shouldFocusKeyCaptureField:n,setShouldFocusKeyCaptureField:a}){let l;let r=(0,it._i)(t?.keyCodes),i=t=>e({keyCodes:t,triggerDevice:"KEYBOARD"}),[s,c]=o.useState(!1),m=o.useRef(null);o.useEffect(()=>{(!t||!t.keyCodes||0===t.keyCodes.length)&&n&&m.current&&(a(!1),m.current.focus(),c(!0))},[a,n,t]),o.useEffect(()=>{if(!s)return()=>{};let t=new ie.L,n=t.onPress(t=>{e({keyCodes:[t.buttons[0]],triggerDevice:t.controllerType}),requestAnimationFrame(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()})});return t.start(),()=>{n.release(),t.end()}},[e,s]);let u=null,p=(0,it.E8)(t),_=(0,e$.GS)();return s?l=o.createElement(io,null,_?(0,d.tx)("proto.keyCapture.press_key_lowercase"):(0,d.tx)("proto.keyCapture.press_key")):t?.triggerDevice==="KEYBOARD"&&r?u=(0,it.U8)(r):p?u=p:l=o.createElement(io,null,_?(0,d.tx)("proto.keyCapture.click_to_set_key"):(0,d.tx)("proto.keyCapture.click_to_select")),o.createElement(ow.rp,{ref:m,className:"prototype_key_capture_field--root--bD21s","data-tooltip-type":as.Ib.TEXT,"data-tooltip":u&&u.length>10?u:null,onFocus:()=>c(!0),onBlur:()=>c(!1),onKeyDown:e=>{e.preventDefault(),e.stopPropagation();let t=e.which||e.keyCode;!it.RI.has(t)&&it.pu[t]&&(t===r?.keyCode&&e.repeat?i((0,it.wb)({keyCode:t,metaKey:e.metaKey||r.metaKey,shiftKey:e.shiftKey||r.shiftKey,ctrlKey:e.ctrlKey||r.ctrlKey,altKey:e.altKey||r.altKey})):i((0,it.wb)({...e,keyCode:t})),document.activeElement instanceof HTMLElement&&document.activeElement.blur())},recordingKey:"keycapture"},u??l)}function io({children:e}){return o.createElement("span",{className:"prototype_key_capture_field--placeholder--gWUKF"},e)}var il=n(502524);let ir=oG.l6,ii=oG.c$,is=new oV.VG,ic=new oV.EX,id=new oV.JV,im=new oV.Eq;function iu(e){let t=(0,l.wA)(),n=(0,oU.Um)(),a=(0,e$.GS)(),r=(0,oW.cJ)(),{showVideoV2Triggers:s}=(0,lw.R)(e=>({allStatesInSelection:e.mirror.selectionProperties.stateGroupSelectionInfo?.mode===i.iCO.STATE,allTopLevelFramesInSelection:!!e.mirror.selectionProperties.allTopLevelFramesInSelection,showVideoV2Triggers:(0,oz.dq)(e.mirror.selectionProperties)})),c=(0,y.useAtomValue)(il.NE),d=t=>{let n=o.createElement("div",{className:"transition_interaction_dropdown--prototypeInteractionIcon---njby"},(0,oz.e7)(t));return o.createElement(ii,{key:t,value:t,icon:a?n:void 0,recordingKey:oE.Pt(e,t),disabled:!function(t){if("NONE"===t)return!0;let n=!!e.interactionsOnSelectedNodes&&e.interactionsOnSelectedNodes.every(t=>e.interactionsOnSelectedNodes&&op.aI(t.sourceNodeID,e.interactionsOnSelectedNodes[0].sourceNodeID))&&!(0,oN.hS)(e.property),a=(function(){if(e.interactionsOnSelectedNodes)return new Set(e.interactionsOnSelectedNodes.map(e=>e?.event?.interactionType).filter(e=>void 0!==e))})()?.has(t)&&(0,oN.hS)(e.property)&&e.property!==t;return(!n&&!a||!!["ON_KEY_DOWN","DRAG","ON_VOICE","ON_MEDIA_HIT"].includes(t))&&("AFTER_TIMEOUT"===t?!e.interactionContainsOpenLinkAction:"ON_MEDIA_HIT"===t||"ON_MEDIA_END"===t?s:(!e.interactionContainsOpenLinkAction||"ON_CLICK"===t||"MOUSE_UP"===t)&&(!e.interactionContainsUpdateMediaRuntime||"ON_HOVER"!==t&&"ON_PRESS"!==t&&"DRAG"!==t)&&(!e.interactionOnlyContainsBack||"ON_HOVER"!==t&&"ON_PRESS"!==t))}(t)})},m=(r?[]:["NONE"]).map(d),u=["ON_CLICK",...r?[]:["DRAG"],"ON_HOVER","ON_PRESS","ON_KEY_DOWN"].map(d),p=["MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"].map(d),_=(r?[]:["ON_MEDIA_HIT","ON_MEDIA_END"]).map(d),E=["AFTER_TIMEOUT"].map(d),g=c?"ON_MEDIA_HIT"!==e.property?ic:im:"ON_MEDIA_HIT"!==e.property?is:id,f=o.useCallback(e=>e-24,[]),v=[...m,!r&&o.createElement(oG.sK,{key:"select1"}),...u,o.createElement(oG.sK,{key:"select2"}),...p,!r&&o.createElement(oG.sK,{key:"select3"}),...E,...!r&&s?[o.createElement(oG.sK,{key:"select4"}),..._]:[]],[h,N]=o.useState(void 0),b=o.createElement(oK.Q,{setMaxWidth:N,options:v,formatOption:e=>e&&e.props.value?g.format(e.props.value):"",getIcon:()=>(0,oz.e7)("AFTER_TIMEOUT")}),T=(0,oN.E7)(e.property);return o.createElement(o.Fragment,null,o.createElement(ir,{id:"interaction-type-select",className:e.className,chevronClassName:"transition_interaction_dropdown--chevron--pyzhq",dataTestId:"interaction-select",property:e.property,formatter:g,icon:a&&T?(0,oz.e7)(T):void 0,onChange:e.onChange,dispatch:t,dropdownShown:n,recordingKey:oE.Pt(e,"select"),hideDropdownWhenContainerMoves:!(0,oF.nl)(),dropdownAlignment:f,dropdownWidth:h},v),b)}let ip={keyCodes:[],triggerDevice:"KEYBOARD"};function i_(e,t,n,a){return n?o.createElement(lm.cS,{label:e,input:t,appendedClassName:a?void 0:o8.dU}):o.createElement(ow.fI,null,t)}function iE(e){let{detailPropsMultipleActions:t,interactionsOnSelectedNodesAndComponents:n,updateSelectionProperties:a}=(0,r2.Ay)(e.category),{interactionType:r="NONE",transitionTimeout:i=.8,mediaHitTime:s=0,interactionMaintained:c=!1,interactionDuration:m=.3,keyTrigger:u=ip}=t.interactionEvent,p=(e,t)=>{if(e.connectionType===t)return e;if("CONDITIONAL"===e.connectionType)for(let n of(0,oN.hS)(e.conditionalActions)&&e.conditionalActions?e.conditionalActions:[]){let e=n.actions?n.actions.find(e=>e.connectionType===t):void 0;if(void 0!==e)return e}return null},_=void 0!==t.interactionActions.find(e=>p(e,"URL")),E=void 0!==t.interactionActions.find(e=>p(e,"UPDATE_MEDIA_RUNTIME")),g=1===t.interactionActions.length&&"BACK"===t.interactionActions[0].connectionType,y=void 0!==t.interactionActions.find(e=>p(e,"CONDITIONAL"));return function(e){let t=(0,l.wA)(),n=e.updateSelectionProperties,a=(0,rY.RU)(),[r,i]=o.useState(!1),s=(0,e$.GS)(),c=(0,oC.YT)(),m=c===oC.Oz.SINGLE_COL,u=c===oC.Oz.TWO_COL,p=!0===(0,oN.E7)(e.maintained),_=(0,oN.E7)(e.keyTrigger),E="ON_KEY_DOWN"===(0,oN.E7)(e.interactionType),g="AFTER_TIMEOUT"===(0,oN.E7)(e.interactionType),y="ON_MEDIA_HIT"===(0,oN.E7)(e.interactionType),f=["MOUSE_IN","MOUSE_OUT","MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"].indexOf((0,oN.E7)(e.interactionType)||"")>-1,v=o.createElement(iu,{className:o8.sQ,property:e.interactionType,onChange:a=>{oS.sn.start("interaction_details_changed"),n({interactionType:a}),t((0,ob._P)({name:"Prototype Interaction Type Changed",params:{newType:a,oldType:(0,oN._W)(e.interactionType,"MIXED")}})),"ON_KEY_DOWN"===a&&i(!0)},interactionContainsOpenLinkAction:e.interactionContainsOpenLinkAction,interactionContainsUpdateMediaRuntime:e.interactionContainsUpdateMediaRuntime,interactionOnlyContainsBack:e.interactionOnlyContainsBack,recordingKey:oE.Pt(e,"interactionDropdown"),interactionsOnSelectedNodes:e.interactionsOnSelectedNodes}),h=s?m?o.createElement(lm.cS,{label:(0,d.tx)("proto.trigger"),input:v}):o.createElement("div",{className:o8.BX},v):o.createElement(ow.fI,{className:e1()(o8.SG,o8.QT)},v,o.createElement("div",{className:o8.LY},e.headerButtons)),N=o.createElement(o.Fragment,null,g&&i_((0,d.tx)("proto.delay"),o.createElement(lU.W4,{className:s?o8.Lp:o8.Zp,inputClassName:s?o8.Gl:void 0,dataTestId:"timeout-input",dispatch:t,value:e.timeout,onValueChange:e=>{n({transitionTimeout:e})},wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,max:20,"data-tooltip-type":as.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.after_delay_timeout"),tooltipForScreenReadersOnly:!0,recordingKey:oE.Pt(e,"timeoutInput")},s?o.createElement(r9.A,null):void 0),s,m),E&&i_((0,d.tx)("proto.key"),o.createElement(ia,{onChange:e=>{n({keyTrigger:e})},value:_,shouldFocusKeyCaptureField:r,setShouldFocusKeyCaptureField:i}),s,m),y&&i_((0,d.tx)("proto.time"),o.createElement(lU.qd,{displayFractions:!0,className:o8.Ym,inputClassName:o8.vE,dataTestId:"mediaHitTime-input",dispatch:t,value:e.mediaHitTime,onValueChange:e=>{n({mediaHitTime:e})},wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,max:3600,"data-tooltip-type":as.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.video_hit_time"),tooltipForScreenReadersOnly:!0,recordingKey:oE.Pt(e,"mediaHitTimeInput")},s?o.createElement(rJ,null):void 0),s,m),f&&i_((0,d.tx)("proto.delay"),o.createElement(lU.W4,{className:s?o8.Lp:o8.aq,inputClassName:s?o8.Gl:o8.p0,dataTestId:"duration-input",dispatch:t,value:p?e.interactionDuration:void 0,onValueChange:e=>{n(e&&e>0?{interactionMaintained:!0,interactionDuration:e}:{interactionMaintained:!1})},min:0,allowEmpty:!0,placeholder:(0,d.t)("proto.trigger.add_delay_placeholder"),wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,"data-tooltip-type":as.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.after_delay_timeout"),tooltipForScreenReadersOnly:!0,recordingKey:oE.Pt(e,"delayInput")},s?o.createElement(r9.A,null):void 0),s,m));return s?o.createElement("div",{className:u?o8.eU:void 0},h,N):o.createElement("div",{className:o8.cF},h,N)}({...e,updateSelectionProperties:a,interactionType:r,interactionContainsOpenLinkAction:_,interactionContainsUpdateMediaRuntime:E,interactionOnlyContainsBack:g,interactionContainsConditionalAction:y,timeout:i,maintained:c,interactionDuration:m,mediaHitTime:s,keyTrigger:u,interactionsOnSelectedNodes:n,recordingKey:oE.Pt(e.recordingKey,oC.Qe)})}let ig="prototype_interaction_edit_modal--contentContainer--bo2b4",iy="prototype_interaction_edit_modal--ui3TwoColContentContainer--x9vrG",iv="prototype_interaction_edit_modal--ui3SingleColContentContainer--uF-ir",ih="prototype_interaction_edit_modal--dividerHorizontal--3wvnB",iN="prototype_interaction_edit_modal--ui3InteractionsPanelContentRight--bVfG8";function ib(e){let{selectedInteractions:t,makeUpdateSelectionPropertiesForActionIndex:n,makeUpdateMultipleDestinationNodesForActionIndex:a,differentLengthActions:l,mergedActions:r}=(0,r2.Ay)(e.category),i="NONE"!==(0,oN.E7)(e.interactionType),s=void 0!==r.find(e=>"CONDITIONAL"===e.connectionType),{selectedActionIndex:c,onSelect:m}=e,u=(0,e$.GS)(),p=(0,oC.YT)(),_=p===oC.Oz.SINGLE_COL,E=p===oC.Oz.TWO_COL,{expandedRows:g,setExpandedRows:y,deleteButtonPressed:f,newActionIndexPath:v,resetNewActionIndexPath:h}=e;o.useEffect(()=>{v&&!v?.equals([])&&(u?m(v.path,!0):(y([...g,v]),m([],!1)),h())},[g,y,v,h,m,u]);let N=o.useCallback(e=>{g.find(t=>t.equals(e))?y(g.filter(t=>!t.equals(e))):y([...g,new l8.Op(e)])},[g,y]),b=o.useCallback(n=>{var a=n.dropItem;if((0,oN.gl)(a)||(0,l8.qQ)(n.dragItem))return;let o=e.interactionsOnSelectedNodes;if(!o||!t)return;for(var l=0;l<t?.length;l++){let e=t[l];if(e&&e.actions){let o=e.actions,r=(0,l8.Vp)(o,c,g,a,n.position);if(r.newSelectedActionIndex&&E&&m(r.newSelectedActionIndex.path,!0),r.newActions&&(t[l].actions=r.newActions,u||m([],!1)),r.newExpandedRows){if(E){let e=[];r.newActions?.forEach((t,n)=>{"CONDITIONAL"===t.connectionType&&e.push(new l8.Op([n]))}),y(e)}else y(r.newExpandedRows)}}}let r=o.map(e=>t.find(t=>t.id===e.id)??e);ov.Y5.updateSelectionProperties({prototypeInteractions:r})},[g,y,e.interactionsOnSelectedNodes,c,t,m,u,E]),T=e1()({"prototype_interaction_edit_modal--panelUI3--WK3CN":u,"prototype_interaction_edit_modal--panelUI3TwoColumn--V5gi4":E});return o.createElement(oO.hh,null,o.createElement(ow.Zk,{className:T},e.shouldHideTitle?null:o.createElement(ow.fI,null,o.createElement(ow.U8,{title:(0,d.t)("proto.interaction.interaction"),dataTooltipContentKey:oM,dataTooltipTimeoutDelay:50})),o.createElement("div",null,(i||u)&&o.createElement(o.Fragment,null,_&&o.createElement(o.Fragment,null,o.createElement(iE,{category:e.category,recordingKey:oC.dJ,headerButtons:o.createElement(o.Fragment,null)}),o.createElement("div",{className:"prototype_interaction_edit_modal--dividerHorizontalUI3--HMCeE"})),l&&o.createElement(oP.Y,{direction:"horizontal",padding:{horizontal:16,vertical:12}},o.createElement(ow.UZ,null,(0,d.tx)("fullscreen.properties_panel.click_plus_to_replace_mixed_content"))),!l&&o.createElement(o.Fragment,null,r?.map((l,i)=>o.createElement(r6,{key:i,updateMultipleDestinationNodes:a(i),action:l,recordingKey:oE.Pt(e.recordingKey,oC.eG,i),updateSelectionProperties:n(i),onDeleteAction:()=>f(i),interactionType:e.interactionType,actionIndexPath:[i],numActions:r.length,isNestedInConditional:!1,isNarrowPanel:!s,stateManagementVersion:e.stateManagementVersion,selectedInteractions:t,onDrop:b,onSelect:e.onSelect,onExpand:N,selectedActionIndex:c,autoOpenVariablePicker:e.autoOpenVariablePicker,expandedRows:g,onNewActionAdded:e.onNewActionAdded,autoOpenExpressionBuilder:e.autoOpenExpressionBuilder,setAutoOpenExpressionBuilder:e.setAutoOpenExpressionBuilder})))))))}function iT({transition:e,recordingKey:t,updateSelectionProperties:n,stateManagementVersion:a,selectedInteractions:r}){let i=(0,l.wA)(),s=(0,e$.GS)(),c=(0,oC.YT)()===oC.Oz.SINGLE_COL,u=()=>{for(let t of(E.az.trackDefinedEvent("prototype.state_management_noodle_upgraded",{num_interactions:r.length,preserve_scroll_position_value:!!e.preserveScroll}),r))(0,oC.uU)(t.stateManagementVersion)&&t.id&&t.sourceNodeID&&rD.zZ.recordInteractionUpgraded(t.id,t.sourceNodeID);n({...(0,oN.hS)(e.preserveScroll)&&(0,oN.hS)(a)?{transitionResetScrollPosition:!e.preserveScroll}:{},stateManagementVersion:1}),i(m.F.enqueue({type:"state-management-updated",message:(0,d.t)("proto.state_management.visual_bell_updated_message"),button:{text:(0,d.t)("proto.state_management.visual_bell_update_all"),action:()=>{ov.Y5.triggerActionInUserEditScope("update-interactions-state-management-on-page"),i(m.F.enqueue({type:"state-management-updated-all",message:(0,d.t)("proto.state_management.visual_bell_update_all_message")}))}}}))},p=()=>{E.az.trackDefinedEvent("prototype.state_management_noodle_reverted",{num_interactions:r.length}),n({stateManagementVersion:0})},_=1===a?o.createElement(nI.$n,{variant:"link",recordingKey:oE.Pt(t,"revert-state-management-version"),onClick:p,htmlAttributes:{"data-testid":"revert-state-management-button"}},(0,d.tx)("proto.state_management.revert_controls")):o.createElement(nI.$n,{variant:"secondary",recordingKey:oE.Pt(t,"update-state-management-version"),onClick:u},(0,d.tx)("proto.state_management.update_controls")),g=c?nI.IK:nI.$n,y=1===a?o.createElement(g,{variant:"secondary",onClick:p,recordingKey:oE.Pt(t,"revert-state-management-version"),htmlAttributes:{"data-testid":"revert-state-management-button"}},(0,d.tx)("proto.state_management.revert_controls")):o.createElement(g,{variant:"primary",onClick:u,recordingKey:oE.Pt(t,"update-state-management-version")},(0,d.tx)("proto.state_management.update_controls")),f=1===a?(0,d.tx)("proto.state_management.new_controls"):(0,d.tx)("proto.state_management.old_controls"),v=o.createElement(X.N,{trusted:!0,newTab:!0,href:"https://help.figma.com/hc/articles/14397859494295"},s?(0,d.tx)("proto.state_management.controls_help_link_new"):(0,d.tx)("proto.state_management.controls_help_link")),h=o.createElement("div",{className:"prototype_state_management_version_panel--versionControls--siAOf"},o.createElement(ow.JU,{className:"prototype_state_management_version_panel--label--vvYMX"},f,v),o.createElement("div",{className:"prototype_state_management_version_panel--buttonContainer--rJZ-y"},_)),N=o.createElement("div",{className:"prototype_state_management_version_panel--containerUI3--V5tpG"},o.createElement(lR.J,null,f),o.createElement(lR.J,null,v),y),b=o.createElement("div",{className:"prototype_state_management_version_panel--containerUI3TwoCol--AAp8u"},o.createElement("span",{className:"prototype_state_management_version_panel--labelWrapperUI3--37g5A"},o.createElement(lR.J,null,f)),o.createElement("span",{className:"prototype_state_management_version_panel--helpLinkWrapperUI3--BttuC"},v),y);return o.createElement(rx.k,{name:"prototype_state_management_version_panel"},o.createElement(ow.Zk,{className:s?"prototype_state_management_version_panel--panelUI3--8-Db5":void 0},s?c?N:b:h))}let iA="created_noodle";function iI(e){let{shouldHideTitle:t=!1,category:n,newActionIndexPath:a}=e,l=(0,oC.YT)()===oC.Oz.TWO_COL,{detailProps:r,detailPropsMultipleActions:i,interactionsOnSelectedNodesAndComponents:s,updateSelectionProperties:c,selectedInteractions:d}=(0,r2.Ay)(e.category);(0,g.h)(()=>{if(void 0!==oS.sn.get(iA)){let e=oS.sn.stop(iA);(0,E.sx)(iA,{elapsedMs:e,numConnectors:d.length},{forwardToDatadog:!0})}});let{showPanel:m,transition:u}=(0,oC.n6)(r,i,d),{interactionType:p="NONE",interactionMaintained:_=!1,interactionDuration:y=.3,keyTrigger:f=ip,transitionTimeout:v=.8,mediaHitTime:h=0}=i.interactionEvent,N=(0,oC.iC)(d),b=o.createElement(ib,{interactionType:p,timeout:v,mediaHitTime:h,maintained:_,interactionDuration:y,keyTrigger:f,recordingKey:oE.Pt(e,oC.Qe),shouldHideTitle:t,interactionsOnSelectedNodes:s,category:n,stateManagementVersion:N,autoOpenVariablePicker:e.autoOpenVariablePicker,newActionIndexPath:a,resetNewActionIndexPath:e.resetNewActionIndexPath,onNewActionAdded:e.onNewActionAdded,onSelect:e.onSelect,selectedActionIndex:e.selectedActionIndex,expandedRows:e.expandedRows,setExpandedRows:e.setExpandedRows,deleteButtonPressed:e.deleteButtonPressed,autoOpenExpressionBuilder:e.autoOpenExpressionBuilder,setAutoOpenExpressionBuilder:e.setAutoOpenExpressionBuilder});return o.createElement("div",null,b,!l&&m&&o.createElement(iT,{transition:u,recordingKey:oE.Pt(e,"stateManagementVersionPanel"),updateSelectionProperties:c,stateManagementVersion:N,selectedInteractions:d}))}var iS=n(437973),iC=n(689147);function iO(e,t,n){let[a,o,l]=e.path,r=t[a].conditionalActions;if((0,oN.hS)(r)){let e=r?.[o].actions?.length??0;if(l>=e){if(0===e){n([a],!0);return}n([a,o,l-1],!0);return}}}function iP(e,t,n){let a=e.path[0]>=t.length,o=0===e.path.length;if(a){n([t.length-1],!0);return}if(o){n([0],!0);return}}var iw=n(182032),ix=n(277687);let ik=()=>{i.glU.setSelectedInteractions([]),(0,s.kc)().prototype_ai_magic_link_show_suggestion_toast&&ov.Y5.showMagicLinkSuggestedVisualBell("create_node_transition"),ov.Y5.deselectProperty()},iD=(0,nm.jz)("197px"),iM=(0,nm.c8)("50%");function iR(e){var t;return e&&a?.height<369?a=t={...a,height:369}:a??={width:440,height:e?369:320,leftWidthPct:45}}let iL=o.memo(function(){let e=(0,l.d4)(iB),t=(0,r2.HS)(),{selectedInteractions:n}=(0,r2.Ay)(t),a=n.length>0,[r,i]=o.useState(!1),s=oE.v_(oC.dJ,"keydown",t=>"Shift"!==t.key?oE.aH:(i(!0),e&&a)?void 0:oE.aH),c=oE.v_(oC.dJ,"keyup",t=>"Shift"!==t.key?oE.aH:(i(!1),e&&a)?void 0:oE.aH);if(o.useEffect(()=>(document.addEventListener("keydown",s),document.addEventListener("keyup",c),()=>{document.removeEventListener("keydown",s),document.removeEventListener("keyup",c)}),[s,c]),!e||!a)return null;let d=n.some(e=>e.actions?.some(e=>"CONDITIONAL"===e.connectionType));return o.createElement(iV,{category:t,containsConditional:d,pressingShiftKey:r,initialX:e.initialX,initialY:e.initialY,shouldPin:e.shouldPin,setPressingShiftKey:i})}),iV=o.memo(function({category:e,containsConditional:t,pressingShiftKey:n,initialX:r,initialY:s,shouldPin:c,setPressingShiftKey:m}){let u=(0,l.wA)(),[p,_]=o.useState(!1),[,E]=(0,y.useAtom)(iC.x),g=(0,o.useRef)(null),[f,v]=o.useState(!1),h=c||p,N=(0,e$.GS)(),b=(0,oC.YT)(),T=b===oC.Oz.SINGLE_COL,A=b===oC.Oz.TWO_COL,[I,C]=o.useState(new l8.Op(N?[0]:[])),{selectedInteractions:O,differentLengthActions:P,interactionsOnSelectedNodesAndComponents:w,mergedActions:x,detailProps:k,detailPropsMultipleActions:D,updateSelectionProperties:M}=(0,r2.Ay)(e);var R=I.path.length>0?I:new l8.Op([0]);let L=R.isConditional(),V=(e,t)=>R=new l8.Op(e);N&&R.path[0]>=x.length&&!L?iP(I,x,V):N&&L&&iO(I,x,V);let U=o.useCallback((e,t)=>{t?C(new l8.Op(e)):C(new l8.Op([]))},[]);o.useEffect(()=>{if(0===x.length){(0,og.us)("the interactions panel should always have actions if rendered");let e=JSON.parse(JSON.stringify(O));for(let t of e)if(t&&t.actions?.length===0){let e={connectionType:"NONE"};t.actions=[e]}let t=w.map(t=>e.find(e=>op.aI(e.id,t.id))??t);ov.Y5.updateSelectionProperties({prototypeInteractions:t})}if(!N)return;let e=I.isConditional();if(e){if(e){iO(I,x,U);return}}else{iP(I,x,U);return}},[x,I,N,U,O,w]);let{shouldShowAdvancedPrototypingPaywall:K,showAdvancedPrototypinglMultipleActionsModal:B}=(0,oC.zt)(),{showPanel:F,transition:z}=(0,oC.n6)(k,D,O),$=(0,oC.iC)(O);var G=[];A?x.forEach((e,t)=>{"CONDITIONAL"===e.connectionType&&G.push(new l8.Op([t]))}):x.length<4&&x.forEach((e,t)=>{G.push(new l8.Op([t]))});let[W,H]=o.useState(G),Y=o.useRef(null),X=n&&!h&&!f,j=(0,nm.jz)(iw.prototypeInteractionModalWidth),J=(0,nm.jz)(iw.prototypeInteractionModalExpandedWidth),q=iR(F).width,Z=t?J:j;A&&(Z=q);let[Q,ee]=o.useState(c),et=(0,S._X)({subscribeToUpdates_expensive:!c}),en=o.useCallback(()=>{p||(u((0,ob._P)({name:"prototype_interaction_details_modal_dragged"})),_(!0))},[u,p,_]),ea=o.useMemo(()=>{let e=new tY.Mi(r,s);if(c)return A?new tY.Mi(e.x-(q-j),e.y):t?new tY.Mi(e.x-(J-j),e.y):e;{let t=(0,S.$g)(et,e);return new tY.Mi(t.x-Z/2,t.y+30)}},[Z,r,s,t,c,et,A,J,j,q]);o.useEffect(()=>{if(!n)return;let e=e=>{!e.shiftKey&&n&&m(!1)};return document.addEventListener("mousemove",e),()=>{document.removeEventListener("mousemove",e)}},[n,m]),o.useEffect(()=>{E(X)},[E,X]),o.useEffect(()=>{ee(c)},[c]),o.useEffect(()=>()=>{u((0,ob._P)({name:"prototype_interaction_details_modal_closed"}))},[u]);let eo=o.useRef(null),[el,er]=o.useState(!1);o.useEffect(()=>{el&&(er(!1),eo.current?.scrollToBottom())},[el,er,eo]);let[ei,es]=o.useState(new l8.Op([])),ec=(0,eg.q5)(),ed=o.useCallback((e,t)=>{let n=e.event.clipboardData||window.clipboardData;switch(t){case oT.zy.COPY:case oT.zy.CUT:{let a=JSON.parse(JSON.stringify(O)),o=(0,iS.l)(a),l=oh.fG(ec?.key||null,{prototypeInteractions:o});if(oh.C4(n,l,""),t===oT.zy.CUT){let e=[];for(let t of O){let{sourceNodeID:n,id:a}=t;n&&a&&e.push(o_.d({nodeID:n,interactionID:a}))}ou.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(e)),ov.Y5.deselectProperty()}e.accept()}}},[ec?.key,O]),em=o.useRef(!1),[eu,ep]=o.useState(!1),{firstVariableSetMode:e_,firstVariableSetID:ey}=lN(),ef=(0,eE.p8)("currentPage"),ev=o.useCallback((e,t,n,a)=>{u((0,ob._P)({name:"Prototype delete action",params:{action:e,source:"panel",connector_id:t,page_id:n,actionInConditionalAction:a}}))},[u]),eh=o.useCallback(e=>{if(w&&O){var t=!1,n=!1;if(K)B();else{for(let l=0;l<O?.length;l++){let r=O[l],i=[];if(r&&r.actions){var a=0,o=[];for(let l=0;l<r.actions.length;l++){let s=r.actions[l];if(l!==e)void 0!==W.find(e=>e.equals([l]))&&o.push(new l8.Op([a])),i.push(s),a++;else{let e=r.id?r.id:op.Hr;ev(s.connectionType?s.connectionType:"NONE",(0,op.dI)(e),ef),l===r.actions.length-1&&(t=!0),2===r.actions.length&&(n=!0)}H(o)}O[l].actions=i}}let l=w.map(e=>O.find(t=>t.id===e.id)??e);ov.Y5.updateSelectionProperties({prototypeInteractions:l}),n&&N&&H([new l8.Op([0])]),t&&A&&C(new l8.Op([e-1]))}}},[w,O,K,B,W,ef,ev,A,N]),eN=o.useCallback(e=>{if(!w||!O||!e.path.length||void 0===e.path[0])return;let[t,n,a]=e.path,o=e.isConditional();if(K)B();else if(o){let e=!1,o=!1,l=O.map(l=>{let r=l.actions;if(!r)return l;let i=r.map((r,i)=>{if(i!==t||"CONDITIONAL"!==r.connectionType)return r;let s=r.conditionalActions;if(!s)return r;let c=s.map((t,r)=>{if(r!==n)return t;let i=t.actions;if(!i)return t;let s=i[a];s&&ev(s.connectionType?s.connectionType:"NONE",(0,op.dI)(l.id??op.Hr),ef,!0);let c=i.filter((e,t)=>t!==a);return e=a===i.length-1,o=0===c.length,{...t,actions:c}});return{...r,conditionalActions:c}});return{...l,actions:i}}),r=w.map(e=>l.find(t=>t.id===e.id)??e);ov.Y5.updateSelectionProperties({prototypeInteractions:r}),o?C(new l8.Op([t])):!o&&e&&C(new l8.Op([t,n,a-1]))}else eh(t);document.activeElement?.blur()},[w,O,K,B,eh,ef,ev]),eb=o.createElement(oy.P,{className:A?"prototype_interaction_edit_modal--ui3TwoColScrollContainer--IWuQ4":ig,useBottomPinning:!A,ref:eo,allowScrollAndZoomOver:!0,"data-not-draggable":!0},o.createElement(iI,{shouldHideTitle:!0,recordingKey:A?oE.Pt("leftCol",oC.dJ):oC.dJ,category:e,autoOpenVariablePicker:em,newActionIndexPath:ei,resetNewActionIndexPath:()=>{es(new l8.Op([]))},onNewActionAdded:e=>{es(e)},selectedActionIndex:I,onSelect:U,expandedRows:W,setExpandedRows:H,deleteButtonPressed:eh,autoOpenExpressionBuilder:eu,setAutoOpenExpressionBuilder:ep})),eT=1===O.length,eA=O[0],eI=eA.actions&&eA.actions.length<2,eS=eA.actions&&1===eA.actions.length&&eA.actions[0],eC=!eS||"NONE"===eS.connectionType,eO=eT&&eI&&eC;var eP=op.Hr;let ew=o.createElement(l9,{skipPaywall:eO,addButtonPressed:e=>{if(!O)return;if(("CONDITIONAL"===e.connectionType||"SET_VARIABLE"===e.connectionType||"SET_VARIABLE_MODE"===e.connectionType)&&K){B();return}"SET_VARIABLE_MODE"===e.connectionType&&(e.targetVariableSetID=ey,e.targetVariableModeID=e_),"SET_VARIABLE"===e.connectionType&&em&&(em.current=!0),N&&"CONDITIONAL"===e.connectionType&&ep(!0);let t=!1;var n=null,a=N&&!P&&!eO&&O[0].actions&&1===O[0].actions.length;if(P||eO)for(var o=0;o<O.length;o++){let t=O[o];t.actions=[e];let n=t.id,a=t.sourceNodeID;(0,oC.uU)(t.stateManagementVersion)&&n&&a&&rD.zZ.recordInteractionUpgraded(n,a),t.stateManagementVersion=1}else for(var o=0;o<O.length;o++){let a=O[o];if(a.actions){if((0,oC.uU)(a.stateManagementVersion)&&(a.id&&a.sourceNodeID&&rD.zZ.recordInteractionUpgraded(a.id,a.sourceNodeID),a.actions?.forEach(e=>{e.transitionResetScrollPosition=!e.transitionPreserveScroll})),A){if(I.isConditional()){let n=I.path[0],o=I.path[1],l=I.path[2],r=a.actions?.[n],i=r.conditionalActions?.[o].actions?.length??0;n===a.actions.length-1&&l===i-1&&(t=!0),r.conditionalActions?.[o].actions?.splice(l+1,0,e)}else{let n=I.path[0]+1;n===a.actions.length&&(t=!0),a.actions?.splice(n,0,e)}}else a.actions?.push(e);eP=a.id?a.id:op.Hr}else a.actions=[e],eP=a.id?a.id:op.Hr;if(a.stateManagementVersion=1,A){let e=[...I.path];e[e.length-1]+=1,n=new l8.Op([...e])}else n=new l8.Op([a.actions.length-1])}let l=w.map(e=>O.find(t=>t.id===e.id)??e);if(ov.Y5.updateSelectionProperties({prototypeInteractions:l}),a||A){var r=[];l[0].actions?.forEach((e,t)=>{"CONDITIONAL"===e.connectionType&&r.push(new l8.Op([t]))}),H(r)}er&&(!A||t)&&er(!0),es&&es(n),u((0,ob._P)({name:"Prototype add action",params:{action:e.connectionType?e.connectionType:"NONE",source:"panel",connector_id:(0,op.dI)(eP),page_id:ef}}))},renderButton:!0,recordingKey:oC.dJ,isNestedInConditional:A&&I.isConditional()}),ex=O.some(e=>void 0!==e.actions&&e.actions?.length>1),ek=!I.isConditional()&&!ex,eD=o.createElement(eZ.K,{onClick:()=>eN(I),"aria-label":(0,d.t)("proto.prototype_panel.delete"),disabled:ek,recordingKey:oE.Pt(oC.dJ,"actionDeleteButton"),htmlAttributes:{"data-tooltip":(0,d.t)("proto.prototype_panel.delete"),"data-tooltip-type":as.Ib.TEXT}},o.createElement(of.U,{svg:r7.A},o.createElement(om.O,null))),eM=o.createElement("div",{className:"prototype_interaction_edit_modal--ui3FooterContainer--oYsXM"},ew," ",eD),eR=o.createElement(o0.c.Provider,{value:o0.P.LEFT},o.createElement("div",{className:A?"prototype_interaction_edit_modal--ui3InteractionsPanelContentLeftResizable--16pLu":"prototype_interaction_edit_modal--ui3InteractionsPanelContentLeft--UYWSG",ref:Y,style:A?{width:`${iR(F).leftWidthPct}%`}:void 0},o.createElement(iE,{category:e,recordingKey:oC.dJ,headerButtons:o.createElement(o.Fragment,null)}),o.createElement("div",{className:ih}),eb,o.createElement("div",{className:ih}),o.createElement(o.Fragment,null,eM))),eL=x.length>0?o.createElement(o0.c.Provider,{value:o0.P.RIGHT},o.createElement(oy.P,{allowScrollAndZoomOver:!0,"data-not-draggable":!0,className:A?"prototype_interaction_edit_modal--ui3ScrollContainerRight--LJr-n":void 0},o.createElement(iU,{selectedActionIndex:R,handleExpandUI3:(e,t)=>{!t&&x.length>1?H(W.filter(t=>!t.equals(e))):W.find(t=>t.equals(e))||H([...W,new l8.Op(e)])},autoOpenVariablePicker:em,autoOpenExpressionBuilder:eu,setAutoOpenExpressionBuilder:ep}))):null,eV=o.useRef(iD),[,eU]=(0,od.i)({disabled:!A,onDragStart(){Y.current&&(eV.current=Y.current.getBoundingClientRect().width)},onDrag(e){if(Y.current&&eV.current){let t=iR(F),n=eV.current+e.delta.x,o=n/t.width*100;n<iD?o=iD/t.width*100:o>iM&&(o=iM),Y.current.style.width=`${o}%`,a={...t,leftWidthPct:o}}}}),eK=A?o.createElement("div",{className:"prototype_interaction_edit_modal--ui3TwoColPanelContainer--e8MK8"},o.createElement("div",{className:"prototype_interaction_edit_modal--ui3TwoColInnerContainer--ZvJj2"},eR,o.createElement("div",{className:"prototype_interaction_edit_modal--dividerVertical--Noi1C"},o.createElement("div",{...eU({className:"prototype_interaction_edit_modal--verticalResizeHandle--xkc8V"})})),eL),F&&o.createElement(iT,{transition:z,recordingKey:oE.Pt(oC.dJ,"stateManagementVersionPanel"),updateSelectionProperties:M,stateManagementVersion:$,selectedInteractions:O})):eb;return o.createElement(oI.ht.Provider,{value:o.useMemo(()=>({autoCloseOnScroll:!h}),[h])},o.createElement(oA.vL,{name:"Prototype Draggable modal",className:"prototype_interaction_edit_modal--prototypeDraggableModal--njJ6A",handleClipboard:ed},o.createElement(rA.vx,{ref:g,dataTestId:"in-context-prototype-interaction-edit-modal",title:t=>o.createElement("div",{className:"prototype_interaction_edit_modal--onboardingRow--UlvE0"},o.createElement(iK,{category:e,recordingKey:oC.dJ,createActionTrigger:ew,closeButton:t})),containerClassName:e1()({[ig]:!A,[iy]:A,[iv]:T,"prototype_interaction_edit_modal--abovePropertiesPanel--hFejC":Q,"prototype_interaction_edit_modal--belowPropertiesPanel--f1Jfl":!Q,"prototype_interaction_edit_modal--modalExpandedWidth--IDl6k":t&&!N,"prototype_interaction_edit_modal--modalWidth--cCH7B":!t&&!N,"prototype_interaction_edit_modal--hideModal--RSp-R":X}),contentContainerClassName:e1()({[ig]:!A,[iy]:A,[iv]:T}),headerClassName:"prototype_interaction_edit_modal--multilineInteractionDetailsHeader--OE8Wr",allowWheelPassthrough:!0,initialPosition:ea,headerSize:"small",onClose:ik,recordingKey:"interactionDetailsModal",arrowPosition:c?void 0:rA.F_.TOP,arrowRelativeX:c?void 0:Z/2,onDragStart:()=>{ee(!0),en()},canRenderBelowViewport:!0,allowAutoExpanding:!0,dragHeaderOnly:!0,onFocus:()=>v(!0),allowResizeHeight:A,allowResizeWidth:A,fullFrame:A,minWidth:A?440:void 0,minHeight:A?F?369:320:void 0,maxWidth:A?800:void 0,maxHeight:A?800:void 0,initialHeight:A?iR(F).height-rA.uF:void 0,initialWidth:A?iR(F).width:void 0,onResize:A?e=>{a={...iR(F),height:e.height,width:e.width}}:void 0},N?eK:eb)))});function iU({selectedActionIndex:e,autoOpenVariablePicker:t,handleExpandUI3:n,autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:l}){let r=(0,r2.HS)(),{selectedInteractions:i,mergedActions:s,makeUpdateSelectionPropertiesForActionIndex:c,makeUpdateMultipleDestinationNodesForActionIndex:d,detailPropsMultipleActions:m}=(0,r2.Ay)(r),u=e.path[0],p=d(u),_=c(u),E=(0,oC.iC)(i),g=m.interactionEvent.interactionType??"NONE";if(e.isConditional()){let n=e.path[1],r=e.path[2],c=s[u],d=((0,oN.hS)(c.conditionalActions)&&c.conditionalActions?c.conditionalActions:[])[n],m=d?.actions?.[r];return m?o.createElement("div",{className:iN},o.createElement(r6,{key:r,updateMultipleDestinationNodes:p.appendActionIndex(n).appendActionIndex(r),action:m,recordingKey:oE.Pt(oC.dJ,oC.Qe,oC.eG,u),updateSelectionProperties:_.appendActionIndex(n).appendActionIndex(r),onDeleteAction:et.lQ,interactionType:g,actionIndexPath:e.path,numActions:s.length,isNestedInConditional:!0,stateManagementVersion:E,selectedInteractions:i,onDrop:et.lQ,onSelect:et.lQ,onExpand:et.lQ,selectedActionIndex:e,expandedRows:[e],autoOpenVariablePicker:t,autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:l,isNarrowPanel:!0})):null}return o.createElement("div",{className:iN},o.createElement(r6,{key:u,updateMultipleDestinationNodes:p,action:s[u],recordingKey:oE.Pt(oC.dJ,oC.Qe,oC.eG,u),updateSelectionProperties:_,onDeleteAction:et.lQ,interactionType:g,actionIndexPath:[u],numActions:s.length,isNestedInConditional:!1,stateManagementVersion:E,selectedInteractions:i,onDrop:et.lQ,onSelect:et.lQ,onExpand:n,selectedActionIndex:e,autoOpenVariablePicker:t,expandedRows:[e],autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:l,isNarrowPanel:!0}))}function iK({category:e,recordingKey:t,closeButton:n,createActionTrigger:a}){let r=(0,l.wA)(),{selectedInteractions:c}=(0,r2.Ay)(e),m=(0,oC.YT)(),u=m===oC.Oz.TWO_COL,p=m===oC.Oz.SINGLE_COL,_=(()=>{if(1!==c.length)return 0;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id};return i.X3B.getMatchingInteractions(o_.d(t)).length})(),E=(0,s.kc)().prototype_hide_matching_noodles&&1===c.length&&_>1&&o.createElement(eZ.K,{actionOnPointerDown:!0,onClick:()=>{if(1!==c.length)return;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id},n=i.X3B.getMatchingInteractions(o_.d(t));i.glU.selectInteractionsAndSourceNodes(n);let a=(0,d.t)("proto.interaction_details.visual_bell.selected_n_matching_interactions",{total_num_interactions:n.length});ov.Y5.showVisualBellWithUndo("selected-matching-noodles",a,!1),r((0,ob._P)({name:"prototype_select_matching_interactions",params:{num_connectors:n.length}}))},"aria-label":(0,d.t)("proto.interaction_details.select_n_matching_interactions",{total_num_interactions:_}),htmlAttributes:{tabIndex:-1,onMouseEnter:()=>{if(1!==c.length)return;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id},n=i.X3B.getMatchingInteractions(o_.d(t));i.glU.hoverInteractions(n)},onMouseLeave:()=>i.glU.hoverInteractions([]),"data-tooltip":(0,d.t)("proto.interaction_details.select_n_matching_interactions",{total_num_interactions:_}),"data-tooltip-type":as.Ib.TEXT}},o.createElement(of.U,{svg:ix.A},o.createElement(an.A,null))),g=o.createElement(iE,{category:e,recordingKey:t,headerButtons:o.createElement(o.Fragment,null,E,a,n)}),y=o.createElement("div",{className:"prototype_interaction_edit_modal--ui3ExpandedModalHeader--Ka7aM"},(0,d.tx)("proto.interaction_details.header"),o.createElement("div",{className:"prototype_interaction_edit_modal--ui3ExpandedModalHeaderButtons--UqykU"},E,n)),f=o.createElement(o.Fragment,null,(0,d.tx)("proto.interaction_details.header"),o.createElement("div",{className:"prototype_interaction_edit_modal--ui3CollapsedModalHeaderButtons--7yPuD"},E,a,n));return u?y:p?f:g}let iB=e=>e.pickerShown?.id===tj.o$?e.pickerShown:null;var iF=n(833566),iz=n(516106),i$=n(572749),iG=n(552825),iW=n(597459),iH=n(387987),iY=n(774270),iX=n(803472),ij=n(150197),iJ=n(796235),iq=n(218401),iZ=n(86815);let iQ=o.memo(({shouldShowDragAndDropBorder:e})=>{let t=(0,eE.p8)("isReadOnly"),n=(0,l.d4)(e=>e.progressBarState),a=(0,eE.p8)("loadingEmbeds"),p=(0,eM.ut)(i.Ez5?.uiState().showCanvasSearch,!1),_=(0,eR.Lk)(),E=(0,o.useRef)(null),g=(0,l.d4)(e=>e.userFlags),y=!!(0,s.kc)().internal_only_debug_tools||!!g.has_cursor_bot_onboarding_v2,f=(0,l.d4)(e=>e.openFile),v=f?f.key:"",h=(0,l.d4)(e=>e.universalInsertModal),N=(0,l.wA)();(0,eC.Gb)(v),(0,eD.W)(),(0,iz.K)();let b=(0,ex.BI)(),T=(0,eS.l7)(),{fpl_accessible_areas_for_design:A,fpl_a11y_accessible_areas_fullscreen_shortcuts:I}=(0,s.kc)(),S=o.createElement(eV.e,{condition:!!(I&&A),wrapper:e=>o.createElement(eL.m,{role:"region","aria-label":(0,d.t)("fullscreen_actions.left_sidebar_label")},e)},T?o.createElement(c.tH,{boundaryKey:"DevModeLeftPanel",fallback:c.H4.NONE_I_KNOW_WHAT_IM_DOING,sentryTags:{area:r.eBU.DEVELOPER_TOOLS}},o.createElement(u.O,null)):o.createElement(a5.m,null));return o.createElement(aQ,null,o.createElement(eO.ED,null),o.createElement(a1.sk,null,n.mode!==i.Oin.OFF&&o.createElement("div",{className:iZ._q}),o.createElement(no.pO,{initialFilterState:{currentPage:!1}},a.map(e=>o.createElement(aX._,{key:`loading-embed-${e}`,nodeId:e})),o.createElement(a2.qn,null),o.createElement(ij.u,null),p&&o.createElement(a6.n,null),(0,s.kc)().ce_al_experiments_on&&o.createElement(a6.n,null),o.createElement(aY.GR,null),o.createElement(aY.bu,null),o.createElement(i$.J,null),o.createElement(a2.XI,{commentsDetailContainerRef:E}),o.createElement(iq.Z,null),(0,s.kc)().cursor_bot&&y&&o.createElement(a7.S,null),o.createElement(a8.X,null),o.createElement(aW.J,null),o.createElement(a4.Nz,null),o.createElement("div",{ref:E}),!(0,ew.T)()&&S,!t&&o.createElement(iL,null),o.createElement(aH.G,null,T?null:o.createElement(o.Fragment,null,o.createElement(i0,null),!!b?.shouldOptimizeForIpadApp&&o.createElement(iY.K,null),!!b?.shouldOptimizeForIpadApp&&o.createElement(iX.t,null))),e&&o.createElement(a4.X5,null),(0,s.kc)().aip_flower_garden&&o.createElement(aF,null)),o.createElement(eU.A,{isFigjamEditor:!1,isDesignEditor:!0,isSlidesEditor:!1,openFile:f}),o.createElement(iF.l,{defaultViewTabsAvailable:!0,defaultViewAssetsTabVisible:!0}),h.showing&&o.createElement(c.tH,{boundaryKey:"FdBrowseResourceModal",onError:()=>{N(m.F.enqueue({message:"Unable to open inserts menu",type:"react-error"}))},fallback:c.H4.NONE_I_KNOW_WHAT_IM_DOING},o.createElement(iW.k,null))),_&&o.createElement(a3.K,{className:iZ.PA},o.createElement(iH.s,null)))}),i0=o.memo(function(){let e=(0,eE.p8)("topLevelMode"),t=(0,eE.ax)(),n=(0,eE.dH)();return(0,ek.z)({topLevelMode:i.lyf.PREVIEW,eventName:"Preview Mode Selection Changed",teamFilesOnly:!0}),o.useEffect(()=>{t&&e===i.lyf.PREVIEW&&n!==i.NLJ.COMMENTS&&(0,eP.NT)(i.FAf.INSPECT)},[t,e,n]),o.createElement(o.Fragment,null,o.createElement(a0.E,null),o.createElement(i1,null))}),i1=o.memo(function(){let e=(0,s.kc)().switch_gen1_nux_overlay;return o.createElement(o.Fragment,null,o.createElement(eK.p,null,o.createElement(eB.L,null)),o.createElement(eK.p,{featureFlag:"starting_points_modal"},o.createElement(tg,null)),o.createElement(eK.p,null,o.createElement(eI,null)),o.createElement(eK.p,null,o.createElement(iG.e,null)),e&&o.createElement(eK.p,null,o.createElement(eF.$l,null)),o.createElement(eK.p,null,o.createElement(V,null)),o.createElement(eK.p,null,o.createElement(H,null)),o.createElement(eK.p,null,o.createElement(U.A,null)),o.createElement(eK.p,null,o.createElement(tU,null)),o.createElement(eK.p,null,o.createElement(tG,null)),o.createElement(eK.p,{featureFlag:"mobile_prompt_sidebar_modal"},o.createElement(os,null)),o.createElement(eK.p,null,o.createElement(Y.S,null)),o.createElement(eK.p,null,o.createElement(na,null)),o.createElement(eK.p,{featureFlag:"cmty_visual_assets_nux"},o.createElement(tw,null)))});function i2(){let[e,t]=(0,o.useState)(!1);return o.createElement(aj.c,{loadedCommentsProvider:!1},o.createElement(iJ.v,{setShouldShowDragAndDropBorder:t,isDragTarget:!1},o.createElement(iQ,{shouldShowDragAndDropBorder:e})))}},902441:(e,t,n)=>{n.d(t,{f:()=>E});var a=n(411855),o=n(563192),l=n(612724),r=n(918091),i=n(693565),s=n(125682),c=n(929717),d=n(909107),m=n(261734),u=n(306777),p=n(403520),_=n(501191);function E({resolvedTypes:e,recordingKey:t}){let{showing:n,toggle:r,hide:m}=(0,s.BK)("expression-builder-create-variable"),u=a.useRef(null),E=o.rf(o.Pt(t,"createVariableDropdown"),"click",a.useCallback(()=>{1===e.length?h(e[0]):r()},[e,r])),[y,f]=a.useState(!1),v=a.useRef(null),h=e=>{let t=u.current?.getBoundingClientRect();t&&(v.current={initialPosition:new l.Mi(t.left,t.top),resolvedType:e},f(!0))},N=()=>{f(!1)};return a.createElement(a.Fragment,null,a.createElement("button",{ref:u,className:p.ZS,onClick:E},a.createElement(i.B,{svg:_.A})),y&&(y&&v.current?a.createElement(d.U,{initialPosition:v.current.initialPosition,initialWidth:d.i,resolvedType:v.current.resolvedType,onCreateVariable:N,onClose:N}):null),n&&u.current&&a.createElement(c.Cf,{arrowOffsetFromRectLeft:14,leanPadding:0,lean:"right",targetRect:u.current.getBoundingClientRect()},e.map(e=>a.createElement(g,{key:e,resolvedType:e,onClose:m,showCreationModal:h,recordingKey:t}))))}function g({resolvedType:e,onClose:t,showCreationModal:n,recordingKey:l}){let i=(0,u.F)(e),s=o.rf(o.Pt(l,"createVariableOption",i.name),"click",a.useCallback(()=>{n(e),t()},[t,e,n]));return a.createElement(r.c$,{className:p.Fs,onClick:s},a.createElement(m.i,{type:e,showTooltip:!1}),i.name)}}}]);

//# debugId=c1371615-1e86-599b-a2bb-9dfba2ef1499

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/1176c482f07d2b2a35742b3bb4cadcc6d63f6b91/fullscreen_design-5edaed75881e017a.min.js.map